2025-12-01 09:25:11,114 - INFO - æ™ºèƒ½åˆ·æ–°è°ƒåº¦å™¨åˆå§‹åŒ–å®Œæˆ
2025-12-01 09:25:11,114 - INFO - ETLè„šæœ¬: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº\etl_dataclean_mes_batch_report.py
2025-12-01 09:25:11,114 - INFO - æ—¥å¿—ç›®å½•: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\06_æ—¥å¿—æ–‡ä»¶
2025-12-01 09:25:11,115 - INFO - âš¡ æ‰‹åŠ¨è§¦å‘ç«‹å³åˆ·æ–°
2025-12-01 09:25:11,115 - INFO - ==================================================
2025-12-01 09:25:11,119 - INFO - å¼€å§‹æ‰§è¡Œæ¯æ—¥å¢é‡ETLåˆ·æ–°
2025-12-01 09:25:11,119 - INFO - ==================================================
2025-12-01 09:25:11,120 - INFO - æ‰§è¡Œå‘½ä»¤: C:\Users\huangk14\AppData\Local\Programs\Python\Python312\python.exe C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº\etl_dataclean_mes_batch_report.py --refresh-mode incremental
2025-12-01 09:25:18,029 - WARNING - ETLè­¦å‘Š:
usage: etl_dataclean_mes_batch_report.py [-h] [--mode {incremental,full}]
                                         [--unattended]
etl_dataclean_mes_batch_report.py: error: unrecognized arguments: --refresh-mode incremental

2025-12-01 09:25:18,036 - ERROR - âŒ ETLæ‰§è¡Œå¤±è´¥: Command '['C:\\Users\\huangk14\\AppData\\Local\\Programs\\Python\\Python312\\python.exe', 'C:\\Users\\huangk14\\OneDrive - Medtronic PLC\\Huangkai Files\\B1_Project\\250418_MDDAP_project\\10-SAæŒ‡æ ‡\\13-SAæ•°æ®æ¸…æ´—\\07_å·¥å…·è„šæœ¬\\..\\01_æ ¸å¿ƒETLç¨‹åº\\etl_dataclean_mes_batch_report.py', '--refresh-mode', 'incremental']' returned non-zero exit status 2.
2025-12-01 09:25:18,041 - INFO - å¤±è´¥æŠ¥å‘Šå·²ä¿å­˜: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\06_æ—¥å¿—æ–‡ä»¶\etl_failure_20251201_092511.json
2025-12-01 09:25:18,043 - INFO - æ‰§è¡Œå®Œæˆï¼Œè€—æ—¶: 6.92ç§’
2025-12-01 09:25:31,970 - INFO - æ™ºèƒ½åˆ·æ–°è°ƒåº¦å™¨åˆå§‹åŒ–å®Œæˆ
2025-12-01 09:25:31,971 - INFO - ETLè„šæœ¬: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº\etl_dataclean_mes_batch_report.py
2025-12-01 09:25:31,972 - INFO - æ—¥å¿—ç›®å½•: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\06_æ—¥å¿—æ–‡ä»¶
2025-12-01 09:25:31,974 - INFO - âš¡ æ‰‹åŠ¨è§¦å‘ç«‹å³åˆ·æ–°
2025-12-01 09:25:31,974 - INFO - ==================================================
2025-12-01 09:25:31,975 - INFO - å¼€å§‹æ‰§è¡Œæ¯æ—¥å¢é‡ETLåˆ·æ–°
2025-12-01 09:25:31,975 - INFO - ==================================================
2025-12-01 09:25:31,976 - INFO - æ‰§è¡Œå‘½ä»¤: C:\Users\huangk14\AppData\Local\Programs\Python\Python312\python.exe C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº\etl_dataclean_mes_batch_report.py --mode incremental
2025-12-01 09:30:59,804 - INFO - âœ… ETLå¢é‡åˆ·æ–°æ‰§è¡ŒæˆåŠŸ
2025-12-01 09:30:59,808 - INFO - æˆåŠŸæŠ¥å‘Šå·²ä¿å­˜: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\06_æ—¥å¿—æ–‡ä»¶\etl_success_20251201_092531.json
2025-12-01 09:30:59,822 - INFO - æ‰§è¡Œå®Œæˆï¼Œè€—æ—¶: 327.85ç§’
2025-12-01 10:50:03,255 - INFO - æ™ºèƒ½åˆ·æ–°è°ƒåº¦å™¨åˆå§‹åŒ–å®Œæˆ
2025-12-01 10:50:03,257 - INFO - ETLç›®å½•: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº
2025-12-01 10:50:03,258 - INFO - æ—¥å¿—ç›®å½•: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\06_æ—¥å¿—æ–‡ä»¶
2025-12-01 10:50:03,258 - INFO - æ•°æ®æºå¤„ç†é¡ºåº: æ—¥å† â†’ SAP â†’ SFC â†’ MES
2025-12-01 10:50:03,259 - INFO - âš¡ æ‰‹åŠ¨è§¦å‘ç«‹å³åˆ·æ–°
2025-12-01 10:50:03,259 - INFO - ============================================================
2025-12-01 10:50:03,259 - INFO - å¼€å§‹æŒ‰ä¾èµ–é¡ºåºæ‰§è¡Œ4ä¸ªæ•°æ®æºETLåˆ·æ–°
2025-12-01 10:50:03,259 - INFO - å¤„ç†é¡ºåº: æ—¥å† â†’ SAP â†’ SFC â†’ MES
2025-12-01 10:50:03,260 - INFO - ============================================================
2025-12-01 10:50:03,260 - INFO - 
ğŸ”„ æ­¥éª¤ CALENDAR: æ—¥å†æ•°æ®å¤„ç†
2025-12-01 10:50:03,261 - INFO - æè¿°: åŠ è½½å·¥å‚æ—¥å†æ•°æ®
2025-12-01 10:50:03,261 - INFO - ğŸ“… æ—¥å†æ•°æ®: é€šè¿‡é…ç½®æ–‡ä»¶åŠ è½½ï¼Œæ— éœ€ç‹¬ç«‹ETLè„šæœ¬
2025-12-01 10:50:03,261 - INFO - âœ… æ—¥å†æ•°æ®å¤„ç† å¤„ç†æˆåŠŸï¼Œè€—æ—¶ 0.00ç§’
2025-12-01 10:50:03,262 - INFO - 
ğŸ”„ æ­¥éª¤ SAP: SAPå·¥è‰ºæ•°æ®å¤„ç†
2025-12-01 10:50:03,262 - INFO - æè¿°: å¤„ç†SAPæ ‡å‡†å·¥è‰ºæ—¶é—´æ•°æ®
2025-12-01 10:50:03,262 - INFO - æ‰§è¡Œå‘½ä»¤: C:\Users\huangk14\AppData\Local\Programs\Python\Python312\python.exe C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº\etl_dataclean_sap_routing.py --mode incremental
2025-12-01 10:51:06,543 - INFO - ETLè¾“å‡º:
2025-12-01 10:50:05,979 - INFO - Ä¼: SAP_Routing_latest.parquet
2025-12-01 10:50:05,981 - INFO - ================================================================================
2025-12-01 10:50:05,983 - INFO - Ê¼×ªÍºÏ²×¼Ê±
2025-12-01 10:50:05,983 - INFO - ================================================================================
2025-12-01 10:50:05,983 - INFO - È¡ 1303 ExcelÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\General - CZ OPSÃ¿Õ²Ç¼\1303 RoutingÓ¹Æ·åµ¥.xlsx
2025-12-01 10:50:09,947 - INFO -  1303 RoutingÈ¡É¹ 38293 
2025-12-01 10:50:10,194 - INFO -  1303 Ó¹åµ¥È¡É¹ 3699 
2025-12-01 10:50:10,195 - INFO - È¡ 9997 ExcelÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\General - CZ OPSÃ¿Õ²Ç¼\9997 RoutingÓ¹Æ·åµ¥.xlsx
2025-12-01 10:50:45,041 - INFO -  9997 RoutingÈ¡É¹ 291118 
2025-12-01 10:50:47,520 - INFO -  9997 Ó¹åµ¥È¡É¹ 23223 
2025-12-01 10:50:47,618 - INFO - Ğ¹RoutingİºÏ²É£ 329411 
2025-12-01 10:50:47,618 - INFO - Ğ¹Ó¹åµ¥İºÏ²É£ 26922 
2025-12-01 10:50:51,414 - INFO - RoutingÉ£ 329411 
2025-12-01 10:50:52,454 - INFO - Ï²É£Ï² 332430 
2025-12-01 10:50:52,457 - INFO - Æ¥äµ½OEE: 3647 
2025-12-01 10:50:52,459 - INFO - Æ¥äµ½Ê±: 2521 
2025-12-01 10:50:56,686 - INFO - Ñ±ParquetÄ¼: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - Äµ/General/POWER BI Ô´ V2/30-MES/publish\SAP_Routing_latest.parquet, : 332430
2025-12-01 10:50:56,963 - INFO - Ï´(332430)ExcelÄ¼Ö»Ç°10000
2025-12-01 10:51:06,063 - INFO - Ñ±ExcelÖ¤Ä¼: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - Äµ/General/POWER BI Ô´ V2/30-MES/publish\excel\SAP_Routing_latest.xlsx, : 10000
2025-12-01 10:51:06,091 - INFO - Ñ±Ï²Ä±×¼Ê±ParquetÄ¼: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - Äµ/General/POWER BI Ô´ V2/30-MES/publish\SAP_Routing_latest.parquet, : 332430
2025-12-01 10:51:06,173 - INFO - ================================================================================
2025-12-01 10:51:06,173 - INFO - ×ªÍºÏ²É£
2025-12-01 10:51:06,173 - INFO - ================================================================================

2025-12-01 10:51:06,544 - WARNING - ETLè­¦å‘Š:
C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\numpy\lib\nanfunctions.py:1215: RuntimeWarning: Mean of empty slice
  return np.nanmean(a, axis, out=out, keepdims=keepdims)
C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\numpy\lib\nanfunctions.py:1215: RuntimeWarning: Mean of empty slice
  return np.nanmean(a, axis, out=out, keepdims=keepdims)
C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\numpy\lib\nanfunctions.py:1215: RuntimeWarning: Mean of empty slice
  return np.nanmean(a, axis, out=out, keepdims=keepdims)

2025-12-01 10:51:06,545 - INFO - âœ… SAPå·¥è‰ºæ•°æ®å¤„ç† å¤„ç†æˆåŠŸï¼Œè€—æ—¶ 63.28ç§’
2025-12-01 10:51:06,546 - INFO - 
ğŸ”„ æ­¥éª¤ SFC: SFCæ‰¹æ¬¡æ•°æ®å¤„ç†
2025-12-01 10:51:06,546 - INFO - æè¿°: å¤„ç†SFCè½¦é—´ä½œä¸šæ§åˆ¶æ•°æ®
2025-12-01 10:51:06,551 - INFO - æ‰§è¡Œå‘½ä»¤: C:\Users\huangk14\AppData\Local\Programs\Python\Python312\python.exe C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº\etl_dataclean_sfc_batch_report.py --mode incremental
2025-12-01 10:54:16,720 - INFO - ETLè¾“å‡º:
2025-12-01 10:51:08,346 - INFO - ============================================================
2025-12-01 10:51:08,347 - INFO - Ã»Ñ¡: Ë¢
2025-12-01 10:51:08,347 - INFO - ============================================================
2025-12-01 10:51:08,489 - INFO - Ä£Ê½Ö» 100 SFCÄ¼Òµ 489 
2025-12-01 10:51:08,519 - INFO - Ñ´Ä¼: 95 Ê£: 5 
2025-12-01 10:51:08,520 - INFO - Òµ 5 SFCÄ¼
2025-12-01 10:51:08,854 - INFO - Ø³Ê¼Ê·: 76213 
2025-12-01 10:51:08,855 - INFO - È¡SFCÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251130200001.xlsx
2025-12-01 10:51:15,247 - INFO - È¡SFCÄ¼É¹: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251130200001.xlsx,  13907 
2025-12-01 10:51:17,608 - INFO - Ä¼ LC-20251130200001.xlsx:  13907 Ğ£Ñ´ 11786 Ğ£ 2121 
2025-12-01 10:51:18,207 - INFO - ×´Ì¬É£Ä¼ LC-20251130200001.xlsxÂ¼Â¼ 13901 Ü¼Â¼ 78334 
2025-12-01 10:51:18,214 - INFO - Ê¹Í¨ÒµÂµÄ±×¼Ê±: SAP_Routing_latest.parquet
2025-12-01 10:51:18,420 - INFO - È¡Ï²Ä±×¼Ê±: 332430 
2025-12-01 10:51:18,686 - INFO - Ò»CFNÆ¥ó£¬» 266 Â¼Î´Æ¥ä£¬Ê¹Material NumberÆ¥
2025-12-01 10:51:18,937 - INFO - Ú¶Material NumberÆ¥É¹: 4 Â¼
2025-12-01 10:51:18,940 - INFO - Ï²×¼Ê±: 2342 
2025-12-01 10:51:18,940 - INFO - Æ¥äµ½×¼Ê±: 2078 
2025-12-01 10:51:18,940 - INFO - Æ¥äµ½EH_machine(s): 2078 
2025-12-01 10:51:18,941 - INFO - Æ¥äµ½EH_labor(s): 2078 
2025-12-01 10:51:18,941 - INFO - Æ¥äµ½OEE: 2342 
2025-12-01 10:51:18,941 - INFO - Æ¥äµ½Setup Time (h): 236 
2025-12-01 10:51:18,960 - INFO - Ê¼ PreviousBatchEndTimeĞ§machineÂ¼ 1551 Ü¼ 2342 
2025-12-01 10:51:18,984 - INFO -  PreviousBatchEndTime É£Ü¼ 2342 É¹ 1543 Ğ§machineÂ¼ 1543 
2025-12-01 10:51:19,886 - INFO - Ê·SFC: 76213 
2025-12-01 10:51:20,054 - INFO - İºÏ²É£Ê· 76213  +  2342  = Ï² 78334 
2025-12-01 10:51:21,317 - INFO - Ñ±ParquetÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\SFC_batch_report_latest.parquet, : 78334
2025-12-01 10:52:33,897 - INFO - Ñ±ExcelÖ¤Ä¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\excel\SFC_batch_report_latest.xlsx, : 78334
2025-12-01 10:52:33,904 - INFO - Ä¼É²ÑºÏ²Ê·: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251130200001.xlsx
2025-12-01 10:52:33,904 - INFO - È¡SFCÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251129200001.xlsx
2025-12-01 10:52:38,685 - INFO - È¡SFCÄ¼É¹: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251129200001.xlsx,  14475 
2025-12-01 10:52:39,582 - INFO - Ä¼ LC-20251129200001.xlsx:  14475 Ğ£Ñ´ 14475 Ğ£ 0 
2025-12-01 10:52:40,249 - INFO - ×´Ì¬É£Ä¼ LC-20251129200001.xlsxÂ¼Â¼ 14468 Ü¼Â¼ 78334 
2025-12-01 10:52:40,254 - INFO - Ä¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251129200001.xlsx
2025-12-01 10:52:40,254 - INFO - È¡SFCÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251128200001.xlsx
2025-12-01 10:52:45,458 - INFO - È¡SFCÄ¼É¹: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251128200001.xlsx,  14832 
2025-12-01 10:52:46,356 - INFO - Ä¼ LC-20251128200001.xlsx:  14832 Ğ£Ñ´ 14832 Ğ£ 0 
2025-12-01 10:52:47,094 - INFO - ×´Ì¬É£Ä¼ LC-20251128200001.xlsxÂ¼Â¼ 14825 Ü¼Â¼ 78334 
2025-12-01 10:52:47,098 - INFO - Ä¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251128200001.xlsx
2025-12-01 10:52:47,099 - INFO - È¡SFCÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251127200001.xlsx
2025-12-01 10:52:52,141 - INFO - È¡SFCÄ¼É¹: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251127200001.xlsx,  14816 
2025-12-01 10:52:53,248 - INFO - Ä¼ LC-20251127200001.xlsx:  14816 Ğ£Ñ´ 14816 Ğ£ 0 
2025-12-01 10:52:53,841 - INFO - ×´Ì¬É£Ä¼ LC-20251127200001.xlsxÂ¼Â¼ 14809 Ü¼Â¼ 78334 
2025-12-01 10:52:53,846 - INFO - Ä¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251127200001.xlsx
2025-12-01 10:52:53,846 - INFO - È¡SFCÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251126200001.xlsx
2025-12-01 10:52:58,462 - INFO - È¡SFCÄ¼É¹: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251126200001.xlsx,  14868 
2025-12-01 10:52:59,379 - INFO - Ä¼ LC-20251126200001.xlsx:  14868 Ğ£Ñ´ 14868 Ğ£ 0 
2025-12-01 10:53:00,018 - INFO - ×´Ì¬É£Ä¼ LC-20251126200001.xlsxÂ¼Â¼ 14861 Ü¼Â¼ 78334 
2025-12-01 10:53:00,022 - INFO - Ä¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251126200001.xlsx
2025-12-01 10:53:00,022 - INFO - Ä¼É£: 78334
2025-12-01 10:53:00,035 - INFO - ĞºÏ²Í³Ò» PreviousBatchEndTime
2025-12-01 10:53:00,074 - INFO - Ê¼ PreviousBatchEndTimeĞ§machineÂ¼ 49973 Ü¼ 78334 
2025-12-01 10:53:00,317 - INFO -  PreviousBatchEndTime É£Ü¼ 78334 É¹ 49643 Ğ§machineÂ¼ 49643 
2025-12-01 10:53:00,324 - INFO - ×´Ì¬Ñ¸
2025-12-01 10:53:01,404 - INFO - Ñ±ParquetÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\SFC_batch_report_latest.parquet, : 78334
2025-12-01 10:54:14,721 - INFO - Ñ±ExcelÖ¤Ä¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\excel\SFC_batch_report_latest.xlsx, : 78334
2025-12-01 10:54:14,737 - INFO - SFCÑ±: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\SFC_batch_report_latest.parquet
2025-12-01 10:54:14,738 - INFO - É£Ê±: 186.39

2025-12-01 10:54:16,723 - INFO - âœ… SFCæ‰¹æ¬¡æ•°æ®å¤„ç† å¤„ç†æˆåŠŸï¼Œè€—æ—¶ 190.18ç§’
2025-12-01 10:54:16,724 - INFO - 
ğŸ”„ æ­¥éª¤ MES: MESæ‰¹æ¬¡æ•°æ®å¤„ç†
2025-12-01 10:54:16,724 - INFO - æè¿°: å¤„ç†MESåˆ¶é€ æ‰§è¡Œç³»ç»Ÿæ•°æ®
2025-12-01 10:54:16,725 - INFO - æ‰§è¡Œå‘½ä»¤: C:\Users\huangk14\AppData\Local\Programs\Python\Python312\python.exe C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº\etl_dataclean_mes_batch_report.py --mode incremental
2025-12-01 11:00:30,311 - INFO - ETLè¾“å‡º:
2025-12-01 10:54:18,015 - INFO - ============================================================
2025-12-01 10:54:18,016 - INFO - Ã»Ñ¡: Ë¢
2025-12-01 10:54:18,017 - INFO - ============================================================
2025-12-01 10:54:18,017 - INFO - Ê¹Ã¶à¹¤Ô´Ã£ 2 
2025-12-01 10:54:18,017 - INFO - Ê¼È¡à¹¤...
2025-12-01 10:54:18,018 - INFO - Ê¼È¡ 2 ...
2025-12-01 10:54:18,018 - INFO - Ú¶È¡ 1-CZM ...
2025-12-01 10:55:59,348 - INFO - Ú¶È¡ 2-CKH ...
2025-12-01 10:57:55,466 - INFO - : {'CKH': 126486, 'CZM': 121973}
2025-12-01 10:57:55,514 - INFO - İ° 2 
2025-12-01 10:57:55,530 - INFO - à¹¤Ö¤Í¨: 248459 Â¼
2025-12-01 10:57:55,810 - INFO - à¹¤ÕªÒª: Ü¼ 248459 Â¼ 2 
2025-12-01 10:57:55,812 - INFO -   CZM (1-CZM): 121973 Â¼
2025-12-01 10:57:55,812 - INFO -   CKH (2-CKH): 126486 Â¼
2025-12-01 10:58:08,277 - INFO - È¥É£Æ³ 40 Ø¸Â¼Ö¶: ['BatchNumber', 'Operation', 'machine', 'factory_source']Ö¶: TrackOutTime
2025-12-01 10:58:08,278 - INFO - È¥Ç°: 166429 Ğ£È¥Øº: 166389 
2025-12-01 10:58:08,326 - INFO - Ö´
2025-12-01 10:58:16,182 - INFO - Ë£ 166389 Ğ£Ñ´ 0 Ğ£ 166389 
2025-12-01 10:58:18,217 - INFO - È¡SFC: 78334 
2025-12-01 10:58:18,557 - INFO - Ï²SFC: 168580 Ğ£Æ¥äµ½Checkin_SFC: 64305 
2025-12-01 10:58:18,586 - INFO - Ê¹Ã±×¼Ê±: SAP_Routing_latest.parquet
2025-12-01 10:58:18,807 - INFO - È¡Ï²Ä±×¼Ê±: 332430 
2025-12-01 10:58:20,428 - INFO - Ò»Material NumberÆ¥ó£¬» 278 Â¼Î´Æ¥ä£¬Ê¹CFNÆ¥
2025-12-01 10:58:20,819 - INFO - Ï²×¼Ê±: 171597 Ğ£Æ¥É¹: 171319 
2025-12-01 10:58:20,820 - INFO - Æ¥äµ½EH_machine(s): 171319 
2025-12-01 10:58:20,822 - INFO - Æ¥äµ½EH_labor(s): 171319 
2025-12-01 10:58:20,824 - INFO - Æ¥äµ½OEE: 171597 
2025-12-01 10:58:21,207 - INFO - É¹: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\Õ±.csv, 1095Â¼
2025-12-01 10:58:21,352 - INFO - Ê¼ PreviousBatchEndTimeĞ§machineÂ¼ 171597 Ü¼ 171597 
2025-12-01 10:58:22,405 - INFO -  PreviousBatchEndTime É£Ü¼ 171597 É¹ 171597 Ğ§machineÂ¼ 171597 
2025-12-01 11:00:18,842 - INFO - MESÖ¶É¸Ñ¡É£ 33 Ö¶
2025-12-01 11:00:19,028 - INFO - Ê·: 166389 
2025-12-01 11:00:19,854 - INFO - İºÏ²É£Ê· 166389  +  171597  = Ï² 166389 
2025-12-01 11:00:19,881 - INFO - ĞºÏ²Í³Ò» PreviousBatchEndTime
2025-12-01 11:00:19,928 - INFO - Ê¼ PreviousBatchEndTimeĞ§machineÂ¼ 166389 Ü¼ 166389 
2025-12-01 11:00:20,712 - INFO -  PreviousBatchEndTime É£Ü¼ 166389 É¹ 166389 Ğ§machineÂ¼ 166389 
2025-12-01 11:00:20,896 - INFO - ×ª TrackOutDate Îªdatetime
2025-12-01 11:00:22,798 - INFO - Ñ±ParquetÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\MES_batch_report_latest.parquet, : 166389
2025-12-01 11:00:22,894 - INFO - Ï´(166389)ExcelÄ¼Ö»Ç°2000
2025-12-01 11:00:26,199 - INFO - Ñ±ExcelÖ¤Ä¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\excel\MES_batch_report_latest.xlsx, : 2000
2025-12-01 11:00:29,288 - INFO - ETL×´Ì¬Ñ¸: Ü¼Â¼ 166389,  0 
2025-12-01 11:00:29,324 - INFO - Ñ±æµ½latestÄ¼×´Ì¬
2025-12-01 11:00:29,324 - INFO - É£Ê±: 371.31

2025-12-01 11:00:30,315 - WARNING - ETLè­¦å‘Š:
--- Logging error ---
Traceback (most recent call last):
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1163, in emit
    stream.write(msg + self.terminator)
UnicodeEncodeError: 'gbk' codec can't encode character '\u2705' in position 33: illegal multibyte sequence
Call stack:
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\07_ß½Å±\..\01_ETL\etl_dataclean_mes_batch_report.py", line 1879, in <module>
    mes_result_df = process_all_data(cfg, force_full_refresh=force_full_refresh)
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\07_ß½Å±\..\01_ETL\etl_dataclean_mes_batch_report.py", line 1529, in process_all_data
    mes_df = read_multi_factory_mes_data(cfg)
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\01_ETL\etl_utils.py", line 443, in read_multi_factory_mes_data
    logging.info(f"\u2705 {factory_name}: É¹È¡ {len(df)} ")
Message: '\u2705 1-CZM: É¹È¡ 121973 '
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1163, in emit
    stream.write(msg + self.terminator)
UnicodeEncodeError: 'gbk' codec can't encode character '\u2705' in position 33: illegal multibyte sequence
Call stack:
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\07_ß½Å±\..\01_ETL\etl_dataclean_mes_batch_report.py", line 1879, in <module>
    mes_result_df = process_all_data(cfg, force_full_refresh=force_full_refresh)
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\07_ß½Å±\..\01_ETL\etl_dataclean_mes_batch_report.py", line 1529, in process_all_data
    mes_df = read_multi_factory_mes_data(cfg)
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\01_ETL\etl_utils.py", line 443, in read_multi_factory_mes_data
    logging.info(f"\u2705 {factory_name}: É¹È¡ {len(df)} ")
Message: '\u2705 2-CKH: É¹È¡ 126486 '
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1163, in emit
    stream.write(msg + self.terminator)
UnicodeEncodeError: 'gbk' codec can't encode character '\u2705' in position 33: illegal multibyte sequence
Call stack:
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\07_ß½Å±\..\01_ETL\etl_dataclean_mes_batch_report.py", line 1879, in <module>
    mes_result_df = process_all_data(cfg, force_full_refresh=force_full_refresh)
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\07_ß½Å±\..\01_ETL\etl_dataclean_mes_batch_report.py", line 1529, in process_all_data
    mes_df = read_multi_factory_mes_data(cfg)
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\01_ETL\etl_utils.py", line 455, in read_multi_factory_mes_data
    logging.info(f"\u2705 à¹¤İºÏ²: Ü¼ {len(combined_df)} ")
Message: '\u2705 à¹¤İºÏ²: Ü¼ 248459 '
Arguments: ()

2025-12-01 11:00:30,316 - INFO - âœ… MESæ‰¹æ¬¡æ•°æ®å¤„ç† å¤„ç†æˆåŠŸï¼Œè€—æ—¶ 373.59ç§’
2025-12-01 11:00:30,325 - INFO - ğŸ‰ æ‰€æœ‰æ•°æ®æºETLå¤„ç†å®Œæˆï¼
2025-12-01 11:00:30,341 - INFO - é¡ºåºæ‰§è¡ŒæŠ¥å‘Šå·²ä¿å­˜: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\06_æ—¥å¿—æ–‡ä»¶\etl_sequential_20251201_105003.json
2025-12-01 11:00:30,346 - INFO - æ‰§è¡Œå®Œæˆï¼Œæ€»è€—æ—¶: 627.09ç§’
2025-12-02 09:09:35,575 - INFO - æ™ºèƒ½åˆ·æ–°è°ƒåº¦å™¨åˆå§‹åŒ–å®Œæˆ
2025-12-02 09:09:35,582 - INFO - ETLç›®å½•: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº
2025-12-02 09:09:35,585 - INFO - æ—¥å¿—ç›®å½•: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\06_æ—¥å¿—æ–‡ä»¶
2025-12-02 09:09:35,586 - INFO - æ•°æ®æºå¤„ç†é¡ºåº: æ—¥å† â†’ SAP â†’ SFC â†’ MES
2025-12-02 09:09:35,599 - INFO - æ™ºèƒ½åˆ·æ–°è°ƒåº¦å™¨åˆå§‹åŒ–å®Œæˆ
2025-12-02 09:09:35,601 - INFO - ETLç›®å½•: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº
2025-12-02 09:09:35,602 - INFO - æ—¥å¿—ç›®å½•: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\06_æ—¥å¿—æ–‡ä»¶
2025-12-02 09:09:35,605 - INFO - æ•°æ®æºå¤„ç†é¡ºåº: æ—¥å† â†’ SAP â†’ SFC â†’ MES
2025-12-02 09:09:40,927 - INFO - æ™ºèƒ½åˆ·æ–°è°ƒåº¦å™¨åˆå§‹åŒ–å®Œæˆ
2025-12-02 09:09:40,929 - INFO - ETLç›®å½•: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº
2025-12-02 09:09:40,930 - INFO - æ—¥å¿—ç›®å½•: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\06_æ—¥å¿—æ–‡ä»¶
2025-12-02 09:09:40,931 - INFO - æ•°æ®æºå¤„ç†é¡ºåº: æ—¥å† â†’ SAP â†’ SFC â†’ MES
2025-12-02 09:09:40,933 - INFO - âš¡ æ‰‹åŠ¨è§¦å‘ç«‹å³åˆ·æ–°
2025-12-02 09:09:40,934 - INFO - ============================================================
2025-12-02 09:09:40,935 - INFO - å¼€å§‹æŒ‰ä¾èµ–é¡ºåºæ‰§è¡Œ4ä¸ªæ•°æ®æºETLåˆ·æ–°
2025-12-02 09:09:40,935 - INFO - å¤„ç†é¡ºåº: æ—¥å† â†’ SAP â†’ SFC â†’ MES
2025-12-02 09:09:40,937 - INFO - ============================================================
2025-12-02 09:09:40,940 - INFO - 
ğŸ”„ æ­¥éª¤ CALENDAR: æ—¥å†æ•°æ®å¤„ç†
2025-12-02 09:09:40,940 - INFO - æè¿°: åŠ è½½å·¥å‚æ—¥å†æ•°æ®
2025-12-02 09:09:40,940 - INFO - ğŸ“… æ—¥å†æ•°æ®: é€šè¿‡é…ç½®æ–‡ä»¶åŠ è½½ï¼Œæ— éœ€ç‹¬ç«‹ETLè„šæœ¬
2025-12-02 09:09:40,941 - INFO - âœ… æ—¥å†æ•°æ®å¤„ç† å¤„ç†æˆåŠŸï¼Œè€—æ—¶ 0.00ç§’
2025-12-02 09:09:40,942 - INFO - 
ğŸ”„ æ­¥éª¤ SAP: SAPå·¥è‰ºæ•°æ®å¤„ç†
2025-12-02 09:09:40,942 - INFO - æè¿°: å¤„ç†SAPæ ‡å‡†å·¥è‰ºæ—¶é—´æ•°æ®
2025-12-02 09:09:40,943 - INFO - æ‰§è¡Œå‘½ä»¤: C:\Users\huangk14\AppData\Local\Programs\Python\Python312\python.exe C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº\etl_dataclean_sap_routing.py --mode incremental
2025-12-02 09:11:49,600 - INFO - ETLè¾“å‡º:
2025-12-02 09:09:45,957 - INFO - Ä¼: SAP_Routing_latest.parquet
2025-12-02 09:09:45,963 - INFO - ================================================================================
2025-12-02 09:09:45,964 - INFO - Ê¼×ªÍºÏ²×¼Ê±
2025-12-02 09:09:45,966 - INFO - ================================================================================
2025-12-02 09:09:45,968 - INFO - È¡ 1303 ExcelÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\General - CZ OPSÃ¿Õ²Ç¼\1303 RoutingÓ¹Æ·åµ¥.xlsx
2025-12-02 09:09:55,546 - INFO -  1303 RoutingÈ¡É¹ 38293 
2025-12-02 09:09:56,089 - INFO -  1303 Ó¹åµ¥È¡É¹ 3699 
2025-12-02 09:09:56,090 - INFO - È¡ 9997 ExcelÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\General - CZ OPSÃ¿Õ²Ç¼\9997 RoutingÓ¹Æ·åµ¥.xlsx
2025-12-02 09:11:23,686 - INFO -  9997 RoutingÈ¡É¹ 291118 
2025-12-02 09:11:29,968 - INFO -  9997 Ó¹åµ¥È¡É¹ 23223 
2025-12-02 09:11:30,932 - INFO - Ğ¹RoutingİºÏ²É£ 329411 
2025-12-02 09:11:30,934 - INFO - Ğ¹Ó¹åµ¥İºÏ²É£ 26922 
2025-12-02 09:11:35,637 - INFO - RoutingÉ£ 329411 
2025-12-02 09:11:36,948 - INFO - Ï²É£Ï² 332430 
2025-12-02 09:11:36,951 - INFO - Æ¥äµ½OEE: 3647 
2025-12-02 09:11:36,954 - INFO - Æ¥äµ½Ê±: 2521 
2025-12-02 09:11:39,820 - INFO - Ñ±ParquetÄ¼: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - Äµ/General/POWER BI Ô´ V2/30-MES/publish\SAP_Routing_latest.parquet, : 332430
2025-12-02 09:11:40,067 - INFO - Ï´(332430)ExcelÄ¼Ö»Ç°10000
2025-12-02 09:11:48,809 - INFO - Ñ±ExcelÖ¤Ä¼: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - Äµ/General/POWER BI Ô´ V2/30-MES/publish\excel\SAP_Routing_latest.xlsx, : 10000
2025-12-02 09:11:48,836 - INFO - Ñ±Ï²Ä±×¼Ê±ParquetÄ¼: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - Äµ/General/POWER BI Ô´ V2/30-MES/publish\SAP_Routing_latest.parquet, : 332430
2025-12-02 09:11:48,960 - INFO - ================================================================================
2025-12-02 09:11:48,963 - INFO - ×ªÍºÏ²É£
2025-12-02 09:11:48,964 - INFO - ================================================================================

2025-12-02 09:11:49,603 - WARNING - ETLè­¦å‘Š:
C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\numpy\lib\nanfunctions.py:1215: RuntimeWarning: Mean of empty slice
  return np.nanmean(a, axis, out=out, keepdims=keepdims)
C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\numpy\lib\nanfunctions.py:1215: RuntimeWarning: Mean of empty slice
  return np.nanmean(a, axis, out=out, keepdims=keepdims)
C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\numpy\lib\nanfunctions.py:1215: RuntimeWarning: Mean of empty slice
  return np.nanmean(a, axis, out=out, keepdims=keepdims)

2025-12-02 09:11:49,604 - INFO - âœ… SAPå·¥è‰ºæ•°æ®å¤„ç† å¤„ç†æˆåŠŸï¼Œè€—æ—¶ 128.66ç§’
2025-12-02 09:11:49,604 - INFO - 
ğŸ”„ æ­¥éª¤ SFC: SFCæ‰¹æ¬¡æ•°æ®å¤„ç†
2025-12-02 09:11:49,605 - INFO - æè¿°: å¤„ç†SFCè½¦é—´ä½œä¸šæ§åˆ¶æ•°æ®
2025-12-02 09:11:49,605 - INFO - æ‰§è¡Œå‘½ä»¤: C:\Users\huangk14\AppData\Local\Programs\Python\Python312\python.exe C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº\etl_dataclean_sfc_batch_report.py --mode incremental
2025-12-02 09:15:02,538 - INFO - ETLè¾“å‡º:
2025-12-02 09:11:53,795 - INFO - ============================================================
2025-12-02 09:11:53,798 - INFO - Ã»Ñ¡: Ë¢
2025-12-02 09:11:53,799 - INFO - ============================================================
2025-12-02 09:11:54,060 - INFO - Ä£Ê½Ö» 100 SFCÄ¼Òµ 490 
2025-12-02 09:11:54,155 - INFO - Ñ´Ä¼: 99 Ê£: 1 
2025-12-02 09:11:54,156 - INFO - Òµ 1 SFCÄ¼
2025-12-02 09:11:54,990 - INFO - Ø³Ê¼Ê·: 78334 
2025-12-02 09:11:54,990 - INFO - È¡SFCÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251201200001.xlsx
2025-12-02 09:12:04,918 - INFO - È¡SFCÄ¼É¹: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251201200001.xlsx,  14064 
2025-12-02 09:12:07,440 - INFO - Ä¼ LC-20251201200001.xlsx:  14064 Ğ£Ñ´ 13648 Ğ£ 416 
2025-12-02 09:12:08,022 - INFO - ×´Ì¬É£Ä¼ LC-20251201200001.xlsxÂ¼Â¼ 14058 Ü¼Â¼ 78750 
2025-12-02 09:12:08,030 - INFO - Ê¹Í¨ÒµÂµÄ±×¼Ê±: SAP_Routing_latest.parquet
2025-12-02 09:12:08,277 - INFO - È¡Ï²Ä±×¼Ê±: 332430 
2025-12-02 09:12:08,535 - INFO - Ò»CFNÆ¥ó£¬» 83 Â¼Î´Æ¥ä£¬Ê¹Material NumberÆ¥
2025-12-02 09:12:08,805 - INFO - Ú¶Material NumberÆ¥É¹: 2 Â¼
2025-12-02 09:12:08,814 - INFO - Ï²×¼Ê±: 451 
2025-12-02 09:12:08,815 - INFO - Æ¥äµ½×¼Ê±: 368 
2025-12-02 09:12:08,817 - INFO - Æ¥äµ½EH_machine(s): 368 
2025-12-02 09:12:08,818 - INFO - Æ¥äµ½EH_labor(s): 368 
2025-12-02 09:12:08,818 - INFO - Æ¥äµ½OEE: 451 
2025-12-02 09:12:08,819 - INFO - Æ¥äµ½Setup Time (h): 40 
2025-12-02 09:12:08,839 - INFO - Ê¼ PreviousBatchEndTimeĞ§machineÂ¼ 257 Ü¼ 451 
2025-12-02 09:12:08,883 - INFO -  PreviousBatchEndTime É£Ü¼ 451 É¹ 250 Ğ§machineÂ¼ 250 
2025-12-02 09:12:09,154 - INFO - Ê·SFC: 78334 
2025-12-02 09:12:09,326 - INFO - İºÏ²É£Ê· 78334  +  451  = Ï² 78750 
2025-12-02 09:12:10,868 - INFO - Ñ±ParquetÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\SFC_batch_report_latest.parquet, : 78750
2025-12-02 09:13:40,330 - INFO - Ñ±ExcelÖ¤Ä¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\excel\SFC_batch_report_latest.xlsx, : 78750
2025-12-02 09:13:40,347 - INFO - Ä¼É²ÑºÏ²Ê·: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\70-SFC\Î±Ü±\LC-20251201200001.xlsx
2025-12-02 09:13:40,348 - INFO - Ä¼É£: 78750
2025-12-02 09:13:40,365 - INFO - ĞºÏ²Í³Ò» PreviousBatchEndTime
2025-12-02 09:13:40,445 - INFO - Ê¼ PreviousBatchEndTimeĞ§machineÂ¼ 50201 Ü¼ 78750 
2025-12-02 09:13:41,065 - INFO -  PreviousBatchEndTime É£Ü¼ 78750 É¹ 49871 Ğ§machineÂ¼ 49871 
2025-12-02 09:13:41,077 - INFO - ×´Ì¬Ñ¸
2025-12-02 09:13:43,771 - INFO - Ñ±ParquetÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\SFC_batch_report_latest.parquet, : 78750
2025-12-02 09:14:59,888 - INFO - Ñ±ExcelÖ¤Ä¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\excel\SFC_batch_report_latest.xlsx, : 78750
2025-12-02 09:14:59,900 - INFO - SFCÑ±: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\SFC_batch_report_latest.parquet
2025-12-02 09:14:59,903 - INFO - É£Ê±: 186.10

2025-12-02 09:15:02,541 - INFO - âœ… SFCæ‰¹æ¬¡æ•°æ®å¤„ç† å¤„ç†æˆåŠŸï¼Œè€—æ—¶ 192.94ç§’
2025-12-02 09:15:02,543 - INFO - 
ğŸ”„ æ­¥éª¤ MES: MESæ‰¹æ¬¡æ•°æ®å¤„ç†
2025-12-02 09:15:02,544 - INFO - æè¿°: å¤„ç†MESåˆ¶é€ æ‰§è¡Œç³»ç»Ÿæ•°æ®
2025-12-02 09:15:02,546 - INFO - æ‰§è¡Œå‘½ä»¤: C:\Users\huangk14\AppData\Local\Programs\Python\Python312\python.exe C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº\etl_dataclean_mes_batch_report.py --mode incremental
2025-12-02 09:26:30,642 - INFO - ETLè¾“å‡º:
2025-12-02 09:15:07,348 - INFO - ============================================================
2025-12-02 09:15:07,350 - INFO - Ã»Ñ¡: Ë¢
2025-12-02 09:15:07,351 - INFO - ============================================================
2025-12-02 09:15:07,351 - INFO - Ê¹Ã¶à¹¤Ô´Ã£ 2 
2025-12-02 09:15:07,351 - INFO - Ê¼È¡à¹¤...
2025-12-02 09:15:07,353 - INFO - Ê¼È¡ 2 ...
2025-12-02 09:15:07,353 - INFO - Ú¶È¡ 1-CZM ...
2025-12-02 09:18:16,708 - INFO - Ú¶È¡ 2-CKH ...
2025-12-02 09:21:25,907 - INFO - : {'CKH': 126486, 'CZM': 121973}
2025-12-02 09:21:25,985 - INFO - İ° 2 
2025-12-02 09:21:26,011 - INFO - à¹¤Ö¤Í¨: 248459 Â¼
2025-12-02 09:21:26,397 - INFO - à¹¤ÕªÒª: Ü¼ 248459 Â¼ 2 
2025-12-02 09:21:26,399 - INFO -   CZM (1-CZM): 121973 Â¼
2025-12-02 09:21:26,400 - INFO -   CKH (2-CKH): 126486 Â¼
2025-12-02 09:21:54,269 - INFO - È¥É£Æ³ 40 Ø¸Â¼Ö¶: ['BatchNumber', 'Operation', 'machine', 'factory_source']Ö¶: TrackOutTime
2025-12-02 09:21:54,270 - INFO - È¥Ç°: 166429 Ğ£È¥Øº: 166389 
2025-12-02 09:21:54,383 - INFO - Ö´
2025-12-02 09:22:11,800 - INFO - Ë£ 166389 Ğ£Ñ´ 0 Ğ£ 166389 
2025-12-02 09:22:12,594 - INFO - È¡SFC: 78750 
2025-12-02 09:22:13,176 - INFO - Ï²SFC: 168580 Ğ£Æ¥äµ½Checkin_SFC: 64320 
2025-12-02 09:22:13,234 - INFO - Ê¹Ã±×¼Ê±: SAP_Routing_latest.parquet
2025-12-02 09:22:13,732 - INFO - È¡Ï²Ä±×¼Ê±: 332430 
2025-12-02 09:22:17,053 - INFO - Ò»Material NumberÆ¥ó£¬» 278 Â¼Î´Æ¥ä£¬Ê¹CFNÆ¥
2025-12-02 09:22:17,985 - INFO - Ï²×¼Ê±: 171597 Ğ£Æ¥É¹: 171319 
2025-12-02 09:22:17,989 - INFO - Æ¥äµ½EH_machine(s): 171319 
2025-12-02 09:22:17,992 - INFO - Æ¥äµ½EH_labor(s): 171319 
2025-12-02 09:22:17,995 - INFO - Æ¥äµ½OEE: 171597 
2025-12-02 09:22:18,527 - INFO - É¹: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\Õ±.csv, 1095Â¼
2025-12-02 09:22:18,743 - INFO - Ê¼ PreviousBatchEndTimeĞ§machineÂ¼ 171597 Ü¼ 171597 
2025-12-02 09:22:20,689 - INFO -  PreviousBatchEndTime É£Ü¼ 171597 É¹ 171597 Ğ§machineÂ¼ 171597 
2025-12-02 09:26:08,630 - INFO - MESÖ¶É¸Ñ¡É£ 33 Ö¶
2025-12-02 09:26:09,091 - INFO - Ê·: 166389 
2025-12-02 09:26:10,808 - INFO - İºÏ²É£Ê· 166389  +  171597  = Ï² 166389 
2025-12-02 09:26:10,868 - INFO - ĞºÏ²Í³Ò» PreviousBatchEndTime
2025-12-02 09:26:10,969 - INFO - Ê¼ PreviousBatchEndTimeĞ§machineÂ¼ 166389 Ü¼ 166389 
2025-12-02 09:26:12,702 - INFO -  PreviousBatchEndTime É£Ü¼ 166389 É¹ 166389 Ğ§machineÂ¼ 166389 
2025-12-02 09:26:13,082 - INFO - ×ª TrackOutDate Îªdatetime
2025-12-02 09:26:16,741 - INFO - Ñ±ParquetÄ¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\MES_batch_report_latest.parquet, : 166389
2025-12-02 09:26:16,930 - INFO - Ï´(166389)ExcelÄ¼Ö»Ç°2000
2025-12-02 09:26:23,208 - INFO - Ñ±ExcelÖ¤Ä¼: C:\Users\huangk14\OneDrive - Medtronic PLC\CZ Production - Äµ\General\POWER BI Ô´ V2\30-MES\publish\excel\MES_batch_report_latest.xlsx, : 2000
2025-12-02 09:26:28,850 - INFO - ETL×´Ì¬Ñ¸: Ü¼Â¼ 166389,  0 
2025-12-02 09:26:29,022 - INFO - Ñ±æµ½latestÄ¼×´Ì¬
2025-12-02 09:26:29,022 - INFO - É£Ê±: 681.67

2025-12-02 09:26:30,648 - WARNING - ETLè­¦å‘Š:
--- Logging error ---
Traceback (most recent call last):
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1163, in emit
    stream.write(msg + self.terminator)
UnicodeEncodeError: 'gbk' codec can't encode character '\u2705' in position 33: illegal multibyte sequence
Call stack:
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\07_ß½Å±\..\01_ETL\etl_dataclean_mes_batch_report.py", line 1879, in <module>
    mes_result_df = process_all_data(cfg, force_full_refresh=force_full_refresh)
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\07_ß½Å±\..\01_ETL\etl_dataclean_mes_batch_report.py", line 1529, in process_all_data
    mes_df = read_multi_factory_mes_data(cfg)
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\01_ETL\etl_utils.py", line 443, in read_multi_factory_mes_data
    logging.info(f"\u2705 {factory_name}: É¹È¡ {len(df)} ")
Message: '\u2705 1-CZM: É¹È¡ 121973 '
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1163, in emit
    stream.write(msg + self.terminator)
UnicodeEncodeError: 'gbk' codec can't encode character '\u2705' in position 33: illegal multibyte sequence
Call stack:
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\07_ß½Å±\..\01_ETL\etl_dataclean_mes_batch_report.py", line 1879, in <module>
    mes_result_df = process_all_data(cfg, force_full_refresh=force_full_refresh)
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\07_ß½Å±\..\01_ETL\etl_dataclean_mes_batch_report.py", line 1529, in process_all_data
    mes_df = read_multi_factory_mes_data(cfg)
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\01_ETL\etl_utils.py", line 443, in read_multi_factory_mes_data
    logging.info(f"\u2705 {factory_name}: É¹È¡ {len(df)} ")
Message: '\u2705 2-CKH: É¹È¡ 126486 '
Arguments: ()
--- Logging error ---
Traceback (most recent call last):
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\logging\__init__.py", line 1163, in emit
    stream.write(msg + self.terminator)
UnicodeEncodeError: 'gbk' codec can't encode character '\u2705' in position 33: illegal multibyte sequence
Call stack:
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\07_ß½Å±\..\01_ETL\etl_dataclean_mes_batch_report.py", line 1879, in <module>
    mes_result_df = process_all_data(cfg, force_full_refresh=force_full_refresh)
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\07_ß½Å±\..\01_ETL\etl_dataclean_mes_batch_report.py", line 1529, in process_all_data
    mes_df = read_multi_factory_mes_data(cfg)
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAÖ¸\13-SAÏ´\01_ETL\etl_utils.py", line 455, in read_multi_factory_mes_data
    logging.info(f"\u2705 à¹¤İºÏ²: Ü¼ {len(combined_df)} ")
Message: '\u2705 à¹¤İºÏ²: Ü¼ 248459 '
Arguments: ()

2025-12-02 09:26:30,653 - INFO - âœ… MESæ‰¹æ¬¡æ•°æ®å¤„ç† å¤„ç†æˆåŠŸï¼Œè€—æ—¶ 688.11ç§’
2025-12-02 09:26:30,715 - INFO - ğŸ‰ æ‰€æœ‰æ•°æ®æºETLå¤„ç†å®Œæˆï¼
2025-12-02 09:26:30,750 - INFO - é¡ºåºæ‰§è¡ŒæŠ¥å‘Šå·²ä¿å­˜: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\06_æ—¥å¿—æ–‡ä»¶\etl_sequential_20251202_090940.json
2025-12-02 09:26:30,761 - INFO - æ‰§è¡Œå®Œæˆï¼Œæ€»è€—æ—¶: 1009.82ç§’
2025-12-02 09:36:57,782 - INFO - æ™ºèƒ½åˆ·æ–°è°ƒåº¦å™¨åˆå§‹åŒ–å®Œæˆ
2025-12-02 09:36:57,784 - INFO - ETLç›®å½•: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº
2025-12-02 09:36:57,784 - INFO - æ—¥å¿—ç›®å½•: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\06_æ—¥å¿—æ–‡ä»¶
2025-12-02 09:36:57,786 - INFO - æ•°æ®æºå¤„ç†é¡ºåº: æ—¥å† â†’ SAP â†’ SFC â†’ MES
2025-12-02 09:36:57,805 - INFO - æ™ºèƒ½åˆ·æ–°è°ƒåº¦å™¨åˆå§‹åŒ–å®Œæˆ
2025-12-02 09:36:57,806 - INFO - ETLç›®å½•: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\01_æ ¸å¿ƒETLç¨‹åº
2025-12-02 09:36:57,811 - INFO - æ—¥å¿—ç›®å½•: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SAæŒ‡æ ‡\13-SAæ•°æ®æ¸…æ´—\07_å·¥å…·è„šæœ¬\..\06_æ—¥å¿—æ–‡ä»¶
2025-12-02 09:36:57,812 - INFO - æ•°æ®æºå¤„ç†é¡ºåº: æ—¥å† â†’ SAP â†’ SFC â†’ MES
