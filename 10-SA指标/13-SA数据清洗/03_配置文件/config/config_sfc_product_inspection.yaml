# SFC产品检验记录数据清洗配置文件

# 数据源配置
source:
  product_inspection_path: "C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx"

# 输出配置
output:
  base_dir: "C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish"
  file_name: "SFC_Product_Inspection_latest.parquet"
  excel_file: "SFC_Product_Inspection_latest.xlsx"

# 字段映射配置
field_mapping:
  # 中文到英文字段映射
  "批次号": "BatchNumber"
  "产品序号": "SerialNumber"
  "工序编号": "Operation"
  "工序名称": "OperationDescription"
  "班组": "Team"
  "机床设备": "Machine"
  "检验结果": "InspectionResult"
  "合格数": "PassQuantity"
  "不合格数": "FailQuantity"
  "报工/关闭人": "Employee"
  "报表日期": "ReportDate"
  "file_mod_time": "FileModTime"
  "source_file": "SourceFile"

# 数据类型定义
types:
  # 主要字段类型
  BatchNumber: string
  SerialNumber: float
  Operation: string
  OperationDescription: string
  Team: string
  Machine: string
  InspectionResult: string
  PassQuantity: int
  FailQuantity: int
  Employee: string
  ReportDate: datetime
  FileModTime: datetime
  SourceFile: string

# 增量处理配置
incremental:
  enabled: true
  key_fields: ["BatchNumber", "SerialNumber", "Operation", "OperationDescription"]
  state_file: "state/sfc_product_inspection_state.json"

# 数据处理配置
processing:
  required_fields:
    - "批次号"
    - "产品序号" 
    - "检验结果"
    - "班组"
    - "合格数"
    - "不合格数"
    - "报工/关闭人"
  
  # 数据质量阈值
  quality_thresholds:
    max_missing_rate: 5.0  # 最大缺失率(%)
    min_pass_rate: 0.0     # 最小合格率
    max_pass_rate: 100.0   # 最大合格率

# 指标计算配置
metrics:
  # 产品级指标
  product_metrics:
    - "PassRate"
    - "TotalInspectionCount"
  
  # 班组级指标
  team_metrics:
    - "TeamPassRate"
    - "TeamRanking"
  
  # 时间字段
  time_fields:
    - "ProcessingTime"

# 日志配置
logging:
  level: "INFO"
  log_file: "sfc_product_inspection.log"
  log_dir: "../06_日志文件"

# 测试配置
test:
  enabled: true
  max_files: 20
  sample_size: 1000
