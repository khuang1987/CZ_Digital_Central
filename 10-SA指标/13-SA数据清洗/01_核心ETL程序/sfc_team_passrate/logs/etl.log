2025-12-01 12:03:35,811 - INFO - ============================================================
2025-12-01 12:03:35,812 - INFO - 开始处理SFC班组合格率数据
2025-12-01 12:03:35,813 - INFO - ============================================================
2025-12-01 12:03:35,814 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-01 12:03:35,854 - INFO - 找到 282 个班组合格率数据文件
2025-12-01 12:03:35,855 - INFO - 读取文件: IGPR-20250115080001.xlsx
2025-12-01 12:03:41,217 - INFO - 读取文件: IGPR-20250116080001.xlsx
2025-12-01 12:03:45,480 - INFO - 读取文件: IGPR-20250117080001.xlsx
2025-12-01 12:03:49,518 - INFO - 读取文件: IGPR-20250118080001.xlsx
2025-12-01 12:03:53,757 - INFO - 读取文件: IGPR-20250119080001.xlsx
2025-12-01 12:03:55,824 - INFO - 读取文件: IGPR-20250120080001.xlsx
2025-12-01 12:03:59,320 - INFO - 读取文件: IGPR-20250121080001.xlsx
2025-12-01 12:04:03,874 - INFO - 读取文件: IGPR-20250122080001.xlsx
2025-12-01 12:04:08,082 - INFO - 读取文件: IGPR-20250125080001.xlsx
2025-12-01 12:04:12,977 - INFO - 读取文件: IGPR-20250206080001.xlsx
2025-12-01 12:04:15,264 - INFO - 读取文件: IGPR-20250207080001.xlsx
2025-12-01 12:04:21,533 - INFO - 读取文件: IGPR-20250208080001.xlsx
2025-12-01 12:04:25,026 - INFO - 读取文件: IGPR-20250209080001.xlsx
2025-12-01 12:04:38,170 - INFO - 读取文件: IGPR-20250210080001.xlsx
2025-12-01 12:04:41,939 - INFO - 读取文件: IGPR-20250211080001.xlsx
2025-12-01 12:04:47,118 - INFO - 读取文件: IGPR-20250212080001.xlsx
2025-12-01 12:04:52,042 - INFO - 读取文件: IGPR-20250213080001.xlsx
2025-12-01 12:04:57,303 - INFO - 读取文件: IGPR-20250214080001.xlsx
2025-12-01 12:05:02,867 - INFO - 读取文件: IGPR-20250215080001.xlsx
2025-12-01 12:05:09,052 - INFO - 读取文件: IGPR-20250216080001.xlsx
2025-12-01 12:05:14,468 - INFO - 读取文件: IGPR-20250217080001.xlsx
2025-12-01 12:05:19,051 - INFO - 读取文件: IGPR-20250218080001.xlsx
2025-12-01 12:05:24,096 - INFO - 读取文件: IGPR-20250219080001.xlsx
2025-12-01 12:06:54,377 - INFO - ============================================================
2025-12-01 12:06:54,384 - INFO - 开始处理SFC班组合格率数据
2025-12-01 12:06:54,385 - INFO - ============================================================
2025-12-01 12:06:54,386 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-01 12:06:54,401 - INFO - 🧪 测试模式：仅读取前 20 个文件
2025-12-01 12:06:54,403 - INFO - 找到 20 个班组合格率数据文件
2025-12-01 12:06:54,404 - INFO - 读取文件: IGPR-20250115080001.xlsx
2025-12-01 12:06:58,664 - INFO - 读取文件: IGPR-20250116080001.xlsx
2025-12-01 12:06:59,976 - INFO - 读取文件: IGPR-20250117080001.xlsx
2025-12-01 12:07:01,220 - INFO - 读取文件: IGPR-20250118080001.xlsx
2025-12-01 12:07:05,031 - INFO - 读取文件: IGPR-20250119080001.xlsx
2025-12-01 12:07:05,669 - INFO - 读取文件: IGPR-20250120080001.xlsx
2025-12-01 12:07:06,098 - INFO - 读取文件: IGPR-20250121080001.xlsx
2025-12-01 12:07:08,363 - INFO - 读取文件: IGPR-20250122080001.xlsx
2025-12-01 12:07:10,740 - INFO - 读取文件: IGPR-20250125080001.xlsx
2025-12-01 12:07:12,026 - INFO - 读取文件: IGPR-20250206080001.xlsx
2025-12-01 12:07:12,630 - INFO - 读取文件: IGPR-20250207080001.xlsx
2025-12-01 12:07:14,870 - INFO - 读取文件: IGPR-20250208080001.xlsx
2025-12-01 12:07:17,482 - INFO - 读取文件: IGPR-20250209080001.xlsx
2025-12-01 12:07:19,671 - INFO - 读取文件: IGPR-20250210080001.xlsx
2025-12-01 12:07:21,718 - INFO - 读取文件: IGPR-20250211080001.xlsx
2025-12-01 12:07:22,868 - INFO - 读取文件: IGPR-20250212080001.xlsx
2025-12-01 12:07:25,379 - INFO - 读取文件: IGPR-20250213080001.xlsx
2025-12-01 12:07:27,696 - INFO - 读取文件: IGPR-20250214080001.xlsx
2025-12-01 12:07:30,603 - INFO - 读取文件: IGPR-20250215080001.xlsx
2025-12-01 12:07:33,104 - INFO - 读取文件: IGPR-20250216080001.xlsx
2025-12-01 12:07:35,650 - INFO - 合并后班组合格率数据行数: 245305
2025-12-01 12:07:35,657 - INFO - 开始验证班组合格率数据完整性...
2025-12-01 12:07:35,689 - INFO - 班组合格率数据验证通过: 245305 行记录
2025-12-01 12:07:35,690 - INFO - 开始清洗班组合格率数据...
2025-12-01 12:07:35,902 - INFO - 已用工序编号填充 3291 个缺失的机床设备
2025-12-01 12:07:35,940 - INFO - 已填充 7611 个缺失的产品序号
2025-12-01 12:07:36,030 - WARNING - 发现 7611 个异常检验结果
2025-12-01 12:07:36,430 - INFO - 班组合格率数据清洗完成: 245305 → 245305 行
2025-12-01 12:07:36,430 - INFO - 开始计算班组合格率指标...
2025-12-01 12:07:36,487 - INFO - 已计算产品合格率
2025-12-01 12:07:36,657 - INFO - 已计算班组统计指标
2025-12-01 12:07:36,675 - INFO - 班组合格率指标计算完成
2025-12-01 12:07:36,676 - INFO - 最终数据统计:
2025-12-01 12:07:36,677 - INFO -   总记录数: 245305
2025-12-01 12:07:36,690 - INFO -   班组数: 8
2025-12-01 12:07:36,707 - INFO -   批次数: 2101
2025-12-01 12:07:36,709 - INFO -   平均合格率: 98.82%
2025-12-01 12:07:38,281 - INFO - 已保存Parquet文件: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\SFC_Team_PassRate_latest.parquet, 行数: 245305
2025-12-01 12:07:38,352 - INFO - 数据量较大(245305行)，Excel文件只保存前10000行
2025-12-01 12:07:41,991 - INFO - 已保存Excel验证文件: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 10000
2025-12-01 12:07:42,013 - INFO - 班组合格率数据已保存: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\SFC_Team_PassRate_latest.parquet
2025-12-01 12:07:42,384 - INFO - 班组合格率Excel验证文件已保存: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-01 12:07:42,384 - INFO - SFC班组合格率数据处理完成
2025-12-01 12:08:46,528 - INFO - ============================================================
2025-12-01 12:08:46,528 - INFO - 开始处理SFC班组合格率数据
2025-12-01 12:08:46,529 - INFO - ============================================================
2025-12-01 12:08:46,529 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-01 12:08:46,540 - INFO - 找到 282 个班组合格率数据文件，按修改时间排序
2025-12-01 12:08:46,540 - INFO - 🧪 测试模式：仅读取前 20 个最新文件
2025-12-01 12:08:46,541 - INFO -   1. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-01 12:08:46,542 - INFO -   2. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-01 12:08:46,543 - INFO -   3. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-01 12:08:46,543 - INFO -   4. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-01 12:08:46,545 - INFO -   5. IGPR-20251201080001.xlsx (修改时间: 2025-12-01 08:15:17)
2025-12-01 12:08:46,545 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-01 12:09:22,887 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-01 12:09:32,024 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-01 12:09:35,244 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-01 12:09:39,127 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-01 12:09:40,108 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-01 12:09:45,627 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-01 12:09:50,499 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-01 12:09:59,019 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-01 12:10:06,649 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-01 12:10:12,382 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-01 12:10:15,716 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-01 12:10:18,636 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-01 12:10:33,781 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-01 12:10:43,130 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-01 12:10:48,887 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-01 12:10:58,309 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-01 12:11:08,344 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-01 12:11:11,588 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-01 12:11:14,794 - INFO - 读取文件: IGPR-20251117080001.xlsx
2025-12-01 12:11:19,020 - INFO - 合并后班组合格率数据行数: 310660
2025-12-01 12:11:19,035 - INFO - 开始验证班组合格率数据完整性...
2025-12-01 12:11:19,074 - INFO - 班组合格率数据验证通过: 310660 行记录
2025-12-01 12:11:19,075 - INFO - 开始清洗班组合格率数据...
2025-12-01 12:11:19,154 - INFO - 已用工序编号填充 3505 个缺失的机床设备
2025-12-01 12:11:19,176 - INFO - 已填充 7483 个缺失的产品序号
2025-12-01 12:11:19,434 - WARNING - 发现 7483 个异常检验结果
2025-12-01 12:11:19,666 - INFO - 业务键去重: 基于批次号+产品序号移除 90546 条重复记录
2025-12-01 12:11:19,960 - INFO - 总去重统计: 移除 90546 条重复记录
2025-12-01 12:11:19,961 - INFO - 班组合格率数据清洗完成: 310660 → 220114 行
2025-12-01 12:11:19,962 - INFO - 开始计算班组合格率指标...
2025-12-01 12:11:19,990 - INFO - 已计算产品合格率
2025-12-01 12:11:20,080 - INFO - 已计算班组统计指标
2025-12-01 12:11:20,085 - INFO - 班组合格率指标计算完成
2025-12-01 12:11:20,086 - INFO - 最终数据统计:
2025-12-01 12:11:20,087 - INFO -   总记录数: 220114
2025-12-01 12:11:20,100 - INFO -   班组数: 8
2025-12-01 12:11:20,113 - INFO -   批次数: 1789
2025-12-01 12:11:20,115 - INFO -   平均合格率: 98.09%
2025-12-01 12:11:21,217 - INFO - 已保存Parquet文件: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\SFC_Team_PassRate_latest.parquet, 行数: 220114
2025-12-01 12:11:21,333 - INFO - 数据量较大(220114行)，Excel文件只保存前10000行
2025-12-01 12:11:26,524 - INFO - 已保存Excel验证文件: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 10000
2025-12-01 12:11:26,536 - INFO - 班组合格率数据已保存: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\SFC_Team_PassRate_latest.parquet
2025-12-01 12:11:27,070 - INFO - 班组合格率Excel验证文件已保存: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-01 12:11:27,071 - INFO - SFC班组合格率数据处理完成
2025-12-01 13:07:12,806 - INFO - ============================================================
2025-12-01 13:07:12,823 - INFO - 开始处理SFC班组合格率数据
2025-12-01 13:07:12,824 - INFO - ============================================================
2025-12-01 13:07:12,825 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-01 13:07:12,836 - INFO - 找到 282 个班组合格率数据文件，按修改时间排序
2025-12-01 13:07:12,836 - INFO - 🧪 测试模式：仅读取前 20 个最新文件
2025-12-01 13:07:12,837 - INFO -   1. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-01 13:07:12,837 - INFO -   2. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-01 13:07:12,837 - INFO -   3. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-01 13:07:12,838 - INFO -   4. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-01 13:07:12,838 - INFO -   5. IGPR-20251201080001.xlsx (修改时间: 2025-12-01 08:15:17)
2025-12-01 13:07:12,838 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-01 13:07:19,650 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-01 13:07:23,599 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-01 13:07:24,518 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-01 13:07:25,775 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-01 13:07:25,776 - WARNING - Excel文件被占用，等待后重试: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251201080001.xlsx
2025-12-01 13:07:25,776 - INFO - 重试读取Excel文件 (第2次): C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251201080001.xlsx
2025-12-01 13:07:27,778 - WARNING - Excel文件被占用，等待后重试: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251201080001.xlsx
2025-12-01 13:07:30,778 - INFO - 重试读取Excel文件 (第3次): C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251201080001.xlsx
2025-12-01 13:07:34,779 - ERROR - Excel文件被其他程序占用: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251201080001.xlsx
2025-12-01 13:07:34,780 - ERROR - 请关闭正在使用该文件的程序（如Excel）
2025-12-01 13:07:34,781 - WARNING - 读取文件失败 C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251201080001.xlsx: 文件被占用，请关闭Excel或其他程序: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251201080001.xlsx
2025-12-01 13:07:34,781 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-01 13:07:38,394 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-01 13:07:42,137 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-01 13:07:46,643 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-01 13:07:50,402 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-01 13:07:53,498 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-01 13:07:55,452 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-01 13:07:57,375 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-01 13:08:00,774 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-01 13:08:05,492 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-01 13:08:09,095 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-01 13:08:12,871 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-01 13:08:18,337 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-01 13:08:22,475 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-01 13:08:25,560 - INFO - 读取文件: IGPR-20251117080001.xlsx
2025-12-01 13:08:28,511 - INFO - 合并后班组合格率数据行数: 305948
2025-12-01 13:08:28,537 - INFO - 开始验证班组合格率数据完整性...
2025-12-01 13:08:28,646 - INFO - 班组合格率数据验证通过: 305948 行记录
2025-12-01 13:08:28,648 - INFO - 开始清洗班组合格率数据...
2025-12-01 13:08:28,798 - INFO - 已用工序编号填充 3492 个缺失的机床设备
2025-12-01 13:08:28,862 - INFO - 已填充 7461 个缺失的产品序号
2025-12-01 13:08:29,183 - WARNING - 发现 7461 个异常检验结果
2025-12-01 13:08:29,438 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 55724 条重复记录
2025-12-01 13:08:29,995 - INFO - 总去重统计: 移除 55724 条重复记录
2025-12-01 13:08:29,996 - INFO - 班组合格率数据清洗完成: 305948 → 250224 行
2025-12-01 13:08:29,996 - INFO - 开始计算班组合格率指标...
2025-12-01 13:08:30,049 - INFO - 已计算产品合格率
2025-12-01 13:08:30,237 - INFO - 已计算班组统计指标
2025-12-01 13:08:30,242 - INFO - 班组合格率指标计算完成
2025-12-01 13:08:30,242 - INFO - 最终数据统计:
2025-12-01 13:08:30,243 - INFO -   总记录数: 250224
2025-12-01 13:08:30,260 - INFO -   班组数: 8
2025-12-01 13:08:30,278 - INFO -   批次数: 1786
2025-12-01 13:08:30,279 - INFO -   平均合格率: 98.19%
2025-12-01 13:08:32,165 - INFO - 已保存Parquet文件: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\SFC_Team_PassRate_latest.parquet, 行数: 250224
2025-12-01 13:08:32,304 - INFO - 数据量较大(250224行)，Excel文件只保存前10000行
2025-12-01 13:08:38,419 - INFO - 已保存Excel验证文件: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 10000
2025-12-01 13:08:38,461 - INFO - 班组合格率数据已保存: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\SFC_Team_PassRate_latest.parquet
2025-12-01 13:08:39,134 - INFO - 班组合格率Excel验证文件已保存: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-01 13:08:39,135 - INFO - SFC班组合格率数据处理完成
2025-12-01 13:15:59,314 - INFO - ============================================================
2025-12-01 13:15:59,315 - INFO - 开始处理SFC班组合格率数据
2025-12-01 13:15:59,316 - INFO - ============================================================
2025-12-01 13:15:59,316 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-01 13:15:59,331 - INFO - 找到 282 个班组合格率数据文件，按修改时间排序
2025-12-01 13:15:59,332 - INFO - 🧪 测试模式：仅读取前 120 个最新文件
2025-12-01 13:15:59,333 - INFO -   1. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-01 13:15:59,334 - INFO -   2. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-01 13:15:59,334 - INFO -   3. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-01 13:15:59,335 - INFO -   4. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-01 13:15:59,335 - INFO -   5. IGPR-20251201080001.xlsx (修改时间: 2025-12-01 08:15:17)
2025-12-01 13:15:59,336 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-01 13:16:04,969 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-01 13:16:08,054 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-01 13:16:09,046 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-01 13:16:10,261 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-01 13:16:11,091 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-01 13:16:13,749 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-01 13:16:16,159 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-01 13:16:19,701 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-01 13:16:23,141 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-01 13:16:26,009 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-01 13:16:28,485 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-01 13:16:30,625 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-01 13:16:33,383 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-01 13:16:36,895 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-01 13:16:40,246 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-01 13:16:43,058 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-01 13:16:48,550 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-01 13:16:52,480 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-01 13:16:54,810 - INFO - 读取文件: IGPR-20251117080001.xlsx
2025-12-01 13:16:57,214 - INFO - 读取文件: IGPR-20251113200001.xlsx
2025-12-01 13:17:06,656 - INFO - 读取文件: IGPR-20251112200001.xlsx
2025-12-01 13:17:09,392 - INFO - 读取文件: IGPR-20251111200001.xlsx
2025-12-01 13:17:14,892 - INFO - 读取文件: IGPR-20251110200001.xlsx
2025-12-01 13:17:20,438 - INFO - 读取文件: IGPR-20251107200001.xlsx
2025-12-01 13:17:27,882 - INFO - 读取文件: IGPR-20251108200001.xlsx
2025-12-01 13:17:35,185 - INFO - 读取文件: IGPR-20251109200001.xlsx
2025-12-01 13:17:40,914 - INFO - 读取文件: IGPR-20251106200001.xlsx
2025-12-01 13:17:49,447 - INFO - 读取文件: IGPR-20251105200001.xlsx
2025-12-01 13:17:56,981 - INFO - 读取文件: IGPR-20251104200001.xlsx
2025-12-01 13:18:07,614 - INFO - 读取文件: IGPR-20251103200001.xlsx
2025-12-01 13:18:12,767 - INFO - 读取文件: IGPR-20251031200001.xlsx
2025-12-01 13:18:20,730 - INFO - 读取文件: IGPR-20251101200001.xlsx
2025-12-01 13:18:26,701 - INFO - 读取文件: IGPR-20251102200001.xlsx
2025-12-01 13:18:31,288 - INFO - 读取文件: IGPR-20251031080001.xlsx
2025-12-01 13:18:36,559 - INFO - 读取文件: IGPR-20251029200001.xlsx
2025-12-01 13:18:43,352 - INFO - 读取文件: IGPR-20251028200001.xlsx
2025-12-01 13:18:56,575 - INFO - 读取文件: IGPR-20251027200001.xlsx
2025-12-01 13:19:02,024 - INFO - 读取文件: IGPR-20251024200001.xlsx
2025-12-01 13:19:10,764 - INFO - 读取文件: IGPR-20251025200001.xlsx
2025-12-01 13:19:16,755 - INFO - 读取文件: IGPR-20251026200001.xlsx
2025-12-01 13:19:21,264 - INFO - 读取文件: IGPR-20251023080001.xlsx
2025-12-01 13:19:26,191 - INFO - 读取文件: IGPR-20251023200001.xlsx
2025-12-01 13:19:33,714 - INFO - 读取文件: IGPR-20251021200001.xlsx
2025-12-01 13:19:35,879 - INFO - 读取文件: IGPR-20251020200001.xlsx
2025-12-01 13:19:38,096 - INFO - 读取文件: IGPR-20251018080001.xlsx
2025-12-01 13:19:41,002 - INFO - 读取文件: IGPR-20251019080001.xlsx
2025-12-01 13:19:42,284 - INFO - 读取文件: IGPR-20251020080001.xlsx
2025-12-01 13:19:44,096 - INFO - 读取文件: IGPR-20251017080001.xlsx
2025-12-01 13:19:46,651 - INFO - 读取文件: IGPR-20251016080001.xlsx
2025-12-01 13:19:48,927 - INFO - 读取文件: IGPR-20251014080001.xlsx
2025-12-01 13:19:52,799 - INFO - 读取文件: IGPR-20251015080001.xlsx
2025-12-01 13:19:54,803 - INFO - 读取文件: IGPR-20251009080001.xlsx
2025-12-01 13:19:55,733 - INFO - 读取文件: IGPR-20251001080001.xlsx
2025-12-01 13:19:57,991 - INFO - 读取文件: IGPR-20251007080001.xlsx
2025-12-01 13:19:58,014 - INFO - 读取文件: IGPR-20251008080001.xlsx
2025-12-01 13:19:58,529 - INFO - 读取文件: IGPR-20250930080001.xlsx
2025-12-01 13:20:01,071 - INFO - 读取文件: IGPR-20250929080001.xlsx
2025-12-01 13:20:03,304 - INFO - 读取文件: IGPR-20250927080001.xlsx
2025-12-01 13:20:05,871 - INFO - 读取文件: IGPR-20250928080001.xlsx
2025-12-01 13:20:07,248 - INFO - 读取文件: IGPR-20250926080001.xlsx
2025-12-01 13:20:09,645 - INFO - 读取文件: IGPR-20250925080001.xlsx
2025-12-01 13:20:11,492 - INFO - 读取文件: IGPR-20250924080001.xlsx
2025-12-01 13:20:13,102 - INFO - 读取文件: IGPR-20250923080001.xlsx
2025-12-01 13:20:14,747 - INFO - 读取文件: IGPR-20250920080001.xlsx
2025-12-01 13:20:16,763 - INFO - 读取文件: IGPR-20250921080001.xlsx
2025-12-01 13:20:17,214 - INFO - 读取文件: IGPR-20250922080001.xlsx
2025-12-01 13:20:17,362 - INFO - 读取文件: IGPR-20250919080001.xlsx
2025-12-01 13:20:19,614 - INFO - 读取文件: IGPR-20250918080001.xlsx
2025-12-01 13:20:21,660 - INFO - 读取文件: IGPR-20250917080001.xlsx
2025-12-01 13:20:23,798 - INFO - 读取文件: IGPR-20250916080001.xlsx
2025-12-01 13:20:25,192 - INFO - 读取文件: IGPR-20250913080001.xlsx
2025-12-01 13:20:27,047 - INFO - 读取文件: IGPR-20250914080001.xlsx
2025-12-01 13:20:27,359 - INFO - 读取文件: IGPR-20250915080001.xlsx
2025-12-01 13:20:27,622 - INFO - 读取文件: IGPR-20250912080001.xlsx
2025-12-01 13:20:29,088 - INFO - 读取文件: IGPR-20250911080001.xlsx
2025-12-01 13:20:30,833 - INFO - 读取文件: IGPR-20250910080001.xlsx
2025-12-01 13:20:32,729 - INFO - 读取文件: IGPR-20250908080001.xlsx
2025-12-01 13:20:32,986 - INFO - 读取文件: IGPR-20250909080001.xlsx
2025-12-01 13:20:34,467 - INFO - 读取文件: IGPR-20250906080001.xlsx
2025-12-01 13:20:37,537 - INFO - 读取文件: IGPR-20250905080001.xlsx
2025-12-01 13:20:42,729 - INFO - 读取文件: IGPR-20250904080001.xlsx
2025-12-01 13:20:53,966 - INFO - 读取文件: IGPR-20250903080001.xlsx
2025-12-01 13:20:58,513 - INFO - 读取文件: IGPR-20250902080001.xlsx
2025-12-01 13:21:03,388 - INFO - 读取文件: IGPR-20250829080001.xlsx
2025-12-01 13:21:08,447 - INFO - 读取文件: IGPR-20250830080001.xlsx
2025-12-01 13:21:12,927 - INFO - 读取文件: IGPR-20250831080001.xlsx
2025-12-01 13:21:13,587 - INFO - 读取文件: IGPR-20250901080001.xlsx
2025-12-01 13:21:14,317 - INFO - 读取文件: IGPR-20250827080001.xlsx
2025-12-01 13:21:19,031 - INFO - 读取文件: IGPR-20250828080001.xlsx
2025-12-01 13:21:24,218 - INFO - 读取文件: IGPR-20250826080001.xlsx
2025-12-01 13:21:29,076 - INFO - 读取文件: IGPR-20250823080001.xlsx
2025-12-01 13:21:33,857 - INFO - 读取文件: IGPR-20250824080001.xlsx
2025-12-01 13:21:34,891 - INFO - 读取文件: IGPR-20250825080001.xlsx
2025-12-01 13:21:36,000 - INFO - 读取文件: IGPR-20250822080001.xlsx
2025-12-01 13:21:41,112 - INFO - 读取文件: IGPR-20250821080001.xlsx
2025-12-01 13:21:46,250 - INFO - 读取文件: IGPR-20250820080001.xlsx
2025-12-01 13:21:50,439 - INFO - 读取文件: IGPR-20250819080001.xlsx
2025-12-01 13:21:53,955 - INFO - 读取文件: IGPR-20250815080001.xlsx
2025-12-01 13:21:58,770 - INFO - 读取文件: IGPR-20250816080001.xlsx
2025-12-01 13:22:05,325 - INFO - 读取文件: IGPR-20250817080001.xlsx
2025-12-01 13:22:06,543 - INFO - 读取文件: IGPR-20250818080001.xlsx
2025-12-01 13:22:08,798 - INFO - 读取文件: IGPR-20250814080001.xlsx
2025-12-01 13:22:13,794 - INFO - 读取文件: IGPR-20250813080001.xlsx
2025-12-01 13:22:18,028 - INFO - 读取文件: IGPR-20250812080001.xlsx
2025-12-01 13:22:21,949 - INFO - 读取文件: IGPR-20250810080001.xlsx
2025-12-01 13:22:22,654 - INFO - 读取文件: IGPR-20250811080001.xlsx
2025-12-01 13:22:23,371 - INFO - 读取文件: IGPR-20250809080001.xlsx
2025-12-01 13:22:27,760 - INFO - 读取文件: IGPR-20250808080001.xlsx
2025-12-01 13:22:30,654 - INFO - 读取文件: IGPR-20250807080001.xlsx
2025-12-01 13:22:34,982 - INFO - 读取文件: IGPR-20250806080001.xlsx
2025-12-01 13:22:46,209 - INFO - 读取文件: IGPR-20250805080001.xlsx
2025-12-01 13:22:50,760 - INFO - 读取文件: IGPR-20250802080001.xlsx
2025-12-01 13:22:57,696 - INFO - 读取文件: IGPR-20250804080001.xlsx
2025-12-01 13:22:58,810 - INFO - 读取文件: IGPR-20250801080001.xlsx
2025-12-01 13:23:04,916 - INFO - 读取文件: IGPR-20250731080001.xlsx
2025-12-01 13:23:07,496 - INFO - 读取文件: IGPR-20250730080001.xlsx
2025-12-01 13:23:10,931 - INFO - 读取文件: IGPR-20250725080001.xlsx
2025-12-01 13:23:14,400 - INFO - 读取文件: IGPR-20250726080001.xlsx
2025-12-01 13:23:17,473 - INFO - 读取文件: IGPR-20250727080001.xlsx
2025-12-01 13:23:21,425 - INFO - 合并后班组合格率数据行数: 1628547
2025-12-01 13:23:21,497 - INFO - 开始验证班组合格率数据完整性...
2025-12-01 13:23:21,692 - INFO - 班组合格率数据验证通过: 1628547 行记录
2025-12-01 13:23:21,693 - INFO - 开始清洗班组合格率数据...
2025-12-01 13:23:22,150 - INFO - 已用工序编号填充 22795 个缺失的机床设备
2025-12-01 13:23:22,223 - INFO - 已填充 48158 个缺失的产品序号
2025-12-01 13:23:22,807 - WARNING - 发现 48158 个异常检验结果
2025-12-01 13:23:23,951 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 301864 条重复记录
2025-12-01 13:23:25,696 - INFO - 总去重统计: 移除 301864 条重复记录
2025-12-01 13:23:25,696 - INFO - 班组合格率数据清洗完成: 1628547 → 1326683 行
2025-12-01 13:23:25,697 - INFO - 开始计算班组合格率指标...
2025-12-01 13:23:25,856 - INFO - 已计算产品合格率
2025-12-01 13:23:26,440 - INFO - 已计算班组统计指标
2025-12-01 13:23:26,458 - INFO - 班组合格率指标计算完成
2025-12-01 13:23:26,458 - INFO - 最终数据统计:
2025-12-01 13:23:26,458 - INFO -   总记录数: 1326683
2025-12-01 13:23:26,517 - INFO -   班组数: 8
2025-12-01 13:23:26,585 - INFO -   批次数: 7825
2025-12-01 13:23:26,593 - INFO -   平均合格率: 97.75%
2025-12-01 13:23:32,704 - INFO - 已保存Parquet文件: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\SFC_Team_PassRate_latest.parquet, 行数: 1326683
2025-12-01 13:23:33,183 - INFO - 数据量较大(1326683行)，Excel文件只保存前10000行
2025-12-01 13:23:40,218 - INFO - 已保存Excel验证文件: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 10000
2025-12-01 13:23:40,316 - INFO - 班组合格率数据已保存: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\SFC_Team_PassRate_latest.parquet
2025-12-01 13:23:40,770 - INFO - 班组合格率Excel验证文件已保存: C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-01 13:23:40,771 - INFO - SFC班组合格率数据处理完成
2025-12-01 14:46:41,297 - INFO - ============================================================
2025-12-01 14:46:41,298 - INFO - 开始处理SFC班组合格率数据
2025-12-01 14:46:41,299 - INFO - ============================================================
2025-12-01 14:46:41,299 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-01 14:46:41,360 - INFO - 找到 282 个班组合格率数据文件，按修改时间排序
2025-12-01 14:46:41,362 - INFO - 🧪 测试模式：仅读取前 120 个最新文件
2025-12-01 14:46:41,362 - INFO -   1. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-01 14:46:41,363 - INFO -   2. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-01 14:46:41,363 - INFO -   3. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-01 14:46:41,364 - INFO -   4. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-01 14:46:41,365 - INFO -   5. IGPR-20251201080001.xlsx (修改时间: 2025-12-01 08:15:17)
2025-12-01 14:46:41,365 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-01 14:46:46,062 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-01 14:46:48,973 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-01 14:46:49,677 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-01 14:46:50,719 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-01 14:46:51,259 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-01 14:46:53,573 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-01 14:46:56,274 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-01 14:46:58,887 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-01 14:47:01,726 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-01 14:47:04,191 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-01 14:47:05,987 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-01 14:47:07,610 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-01 14:47:10,223 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-01 14:47:13,100 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-01 14:47:15,652 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-01 14:47:18,515 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-01 14:47:22,988 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-01 14:47:25,459 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-01 14:47:27,025 - INFO - 读取文件: IGPR-20251117080001.xlsx
2025-12-01 14:47:28,788 - INFO - 读取文件: IGPR-20251113200001.xlsx
2025-12-01 14:47:33,039 - INFO - 读取文件: IGPR-20251112200001.xlsx
2025-12-01 14:47:35,012 - INFO - 读取文件: IGPR-20251111200001.xlsx
2025-12-01 14:47:39,338 - INFO - 读取文件: IGPR-20251110200001.xlsx
2025-12-01 14:47:42,106 - INFO - 读取文件: IGPR-20251107200001.xlsx
2025-12-01 14:47:45,822 - INFO - 读取文件: IGPR-20251108200001.xlsx
2025-12-01 14:47:49,254 - INFO - 读取文件: IGPR-20251109200001.xlsx
2025-12-01 14:47:51,552 - INFO - 读取文件: IGPR-20251106200001.xlsx
2025-12-01 14:47:55,138 - INFO - 读取文件: IGPR-20251105200001.xlsx
2025-12-01 14:47:59,981 - INFO - 读取文件: IGPR-20251104200001.xlsx
2025-12-01 14:48:04,148 - INFO - 读取文件: IGPR-20251103200001.xlsx
2025-12-01 14:48:07,174 - INFO - 读取文件: IGPR-20251031200001.xlsx
2025-12-01 14:48:11,191 - INFO - 读取文件: IGPR-20251101200001.xlsx
2025-12-01 14:48:14,471 - INFO - 读取文件: IGPR-20251102200001.xlsx
2025-12-01 14:48:16,816 - INFO - 读取文件: IGPR-20251031080001.xlsx
2025-12-01 14:48:19,431 - INFO - 读取文件: IGPR-20251029200001.xlsx
2025-12-01 14:48:23,540 - INFO - 读取文件: IGPR-20251028200001.xlsx
2025-12-01 14:48:27,178 - INFO - 读取文件: IGPR-20251027200001.xlsx
2025-12-01 14:48:29,634 - INFO - 读取文件: IGPR-20251024200001.xlsx
2025-12-01 14:48:33,196 - INFO - 读取文件: IGPR-20251025200001.xlsx
2025-12-01 14:48:35,839 - INFO - 读取文件: IGPR-20251026200001.xlsx
2025-12-01 14:48:37,907 - INFO - 读取文件: IGPR-20251023080001.xlsx
2025-12-01 14:48:40,530 - INFO - 读取文件: IGPR-20251023200001.xlsx
2025-12-01 14:48:44,085 - INFO - 读取文件: IGPR-20251021200001.xlsx
2025-12-01 14:48:45,196 - INFO - 读取文件: IGPR-20251020200001.xlsx
2025-12-01 14:48:46,222 - INFO - 读取文件: IGPR-20251018080001.xlsx
2025-12-01 14:48:47,466 - INFO - 读取文件: IGPR-20251019080001.xlsx
2025-12-01 14:48:48,220 - INFO - 读取文件: IGPR-20251020080001.xlsx
2025-12-01 14:48:48,835 - INFO - 读取文件: IGPR-20251017080001.xlsx
2025-12-01 14:48:50,105 - INFO - 读取文件: IGPR-20251016080001.xlsx
2025-12-01 14:48:51,201 - INFO - 读取文件: IGPR-20251014080001.xlsx
2025-12-01 14:48:53,077 - INFO - 读取文件: IGPR-20251015080001.xlsx
2025-12-01 14:48:54,133 - INFO - 读取文件: IGPR-20251009080001.xlsx
2025-12-01 14:48:54,752 - INFO - 读取文件: IGPR-20251001080001.xlsx
2025-12-01 14:48:56,353 - INFO - 读取文件: IGPR-20251007080001.xlsx
2025-12-01 14:48:56,365 - INFO - 读取文件: IGPR-20251008080001.xlsx
2025-12-01 14:48:56,554 - INFO - 读取文件: IGPR-20250930080001.xlsx
2025-12-01 14:48:58,204 - INFO - 读取文件: IGPR-20250929080001.xlsx
2025-12-01 14:48:59,500 - INFO - 读取文件: IGPR-20250927080001.xlsx
2025-12-01 14:49:01,269 - INFO - 读取文件: IGPR-20250928080001.xlsx
2025-12-01 14:49:02,377 - INFO - 读取文件: IGPR-20250926080001.xlsx
2025-12-01 14:49:03,902 - INFO - 读取文件: IGPR-20250925080001.xlsx
2025-12-01 14:49:05,549 - INFO - 读取文件: IGPR-20250924080001.xlsx
2025-12-01 14:49:07,136 - INFO - 读取文件: IGPR-20250923080001.xlsx
2025-12-01 14:49:09,128 - INFO - 读取文件: IGPR-20250920080001.xlsx
2025-12-01 14:49:10,690 - INFO - 读取文件: IGPR-20250921080001.xlsx
2025-12-01 14:49:11,118 - INFO - 读取文件: IGPR-20250922080001.xlsx
2025-12-01 14:49:11,210 - INFO - 读取文件: IGPR-20250919080001.xlsx
2025-12-01 14:49:13,161 - INFO - 读取文件: IGPR-20250918080001.xlsx
2025-12-01 14:49:14,910 - INFO - 读取文件: IGPR-20250917080001.xlsx
2025-12-01 14:49:16,552 - INFO - 读取文件: IGPR-20250916080001.xlsx
2025-12-01 14:49:17,864 - INFO - 读取文件: IGPR-20250913080001.xlsx
2025-12-01 14:49:19,510 - INFO - 读取文件: IGPR-20250914080001.xlsx
2025-12-01 14:49:19,612 - INFO - 读取文件: IGPR-20250915080001.xlsx
2025-12-01 14:49:19,791 - INFO - 读取文件: IGPR-20250912080001.xlsx
2025-12-01 14:49:21,132 - INFO - 读取文件: IGPR-20250911080001.xlsx
2025-12-01 14:49:22,607 - INFO - 读取文件: IGPR-20250910080001.xlsx
2025-12-01 14:49:24,323 - INFO - 读取文件: IGPR-20250908080001.xlsx
2025-12-01 14:49:24,481 - INFO - 读取文件: IGPR-20250909080001.xlsx
2025-12-01 14:49:25,838 - INFO - 读取文件: IGPR-20250906080001.xlsx
2025-12-01 14:49:28,481 - INFO - 读取文件: IGPR-20250905080001.xlsx
2025-12-01 14:49:30,915 - INFO - 读取文件: IGPR-20250904080001.xlsx
2025-12-01 14:49:33,065 - INFO - 读取文件: IGPR-20250903080001.xlsx
2025-12-01 14:49:35,688 - INFO - 读取文件: IGPR-20250902080001.xlsx
2025-12-01 14:49:37,681 - INFO - 读取文件: IGPR-20250829080001.xlsx
2025-12-01 14:49:40,019 - INFO - 读取文件: IGPR-20250830080001.xlsx
2025-12-01 14:49:41,967 - INFO - 读取文件: IGPR-20250831080001.xlsx
2025-12-01 14:49:42,206 - INFO - 读取文件: IGPR-20250901080001.xlsx
2025-12-01 14:49:42,424 - INFO - 读取文件: IGPR-20250827080001.xlsx
2025-12-01 14:49:44,979 - INFO - 读取文件: IGPR-20250828080001.xlsx
2025-12-01 14:49:47,390 - INFO - 读取文件: IGPR-20250826080001.xlsx
2025-12-01 14:49:49,625 - INFO - 读取文件: IGPR-20250823080001.xlsx
2025-12-01 14:49:52,164 - INFO - 读取文件: IGPR-20250824080001.xlsx
2025-12-01 14:49:52,519 - INFO - 读取文件: IGPR-20250825080001.xlsx
2025-12-01 14:49:52,808 - INFO - 读取文件: IGPR-20250822080001.xlsx
2025-12-01 14:49:56,471 - INFO - 读取文件: IGPR-20250821080001.xlsx
2025-12-01 14:49:59,512 - INFO - 读取文件: IGPR-20250820080001.xlsx
2025-12-01 14:50:03,044 - INFO - 读取文件: IGPR-20250819080001.xlsx
2025-12-01 14:50:05,925 - INFO - 读取文件: IGPR-20250815080001.xlsx
2025-12-01 14:50:09,310 - INFO - 读取文件: IGPR-20250816080001.xlsx
2025-12-01 14:50:12,699 - INFO - 读取文件: IGPR-20250817080001.xlsx
2025-12-01 14:50:13,060 - INFO - 读取文件: IGPR-20250818080001.xlsx
2025-12-01 14:50:13,485 - INFO - 读取文件: IGPR-20250814080001.xlsx
2025-12-01 14:50:17,110 - INFO - 读取文件: IGPR-20250813080001.xlsx
2025-12-01 14:50:20,765 - INFO - 读取文件: IGPR-20250812080001.xlsx
2025-12-01 14:50:24,085 - INFO - 读取文件: IGPR-20250810080001.xlsx
2025-12-01 14:50:24,361 - INFO - 读取文件: IGPR-20250811080001.xlsx
2025-12-01 14:50:24,657 - INFO - 读取文件: IGPR-20250809080001.xlsx
2025-12-01 14:50:28,345 - INFO - 读取文件: IGPR-20250808080001.xlsx
2025-12-01 14:50:31,682 - INFO - 读取文件: IGPR-20250807080001.xlsx
2025-12-01 14:50:34,731 - INFO - 读取文件: IGPR-20250806080001.xlsx
2025-12-01 14:50:37,848 - INFO - 读取文件: IGPR-20250805080001.xlsx
2025-12-01 14:50:41,584 - INFO - 读取文件: IGPR-20250802080001.xlsx
2025-12-01 14:50:45,066 - INFO - 读取文件: IGPR-20250804080001.xlsx
2025-12-01 14:50:45,411 - INFO - 读取文件: IGPR-20250801080001.xlsx
2025-12-01 14:50:49,126 - INFO - 读取文件: IGPR-20250731080001.xlsx
2025-12-01 14:50:50,689 - INFO - 读取文件: IGPR-20250730080001.xlsx
2025-12-01 14:50:54,398 - INFO - 读取文件: IGPR-20250725080001.xlsx
2025-12-01 14:50:57,714 - INFO - 读取文件: IGPR-20250726080001.xlsx
2025-12-01 14:51:01,605 - INFO - 读取文件: IGPR-20250727080001.xlsx
2025-12-01 14:51:06,172 - INFO - 合并后班组合格率数据行数: 1628547
2025-12-01 14:51:06,244 - INFO - 开始验证班组合格率数据完整性...
2025-12-01 14:51:06,414 - INFO - 班组合格率数据验证通过: 1628547 行记录
2025-12-01 14:51:06,414 - INFO - 开始清洗班组合格率数据...
2025-12-01 14:51:06,881 - INFO - 已用工序编号填充 22795 个缺失的机床设备
2025-12-01 14:51:06,954 - INFO - 已填充 48158 个缺失的产品序号
2025-12-01 14:51:07,717 - WARNING - 发现 48158 个异常检验结果
2025-12-01 14:51:08,908 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 301864 条重复记录
2025-12-01 14:51:10,608 - INFO - 总去重统计: 移除 301864 条重复记录
2025-12-01 14:51:10,608 - INFO - 班组合格率数据清洗完成: 1628547 → 1326683 行
2025-12-01 14:51:10,723 - INFO - 开始按业务维度分组聚合数据...
2025-12-01 14:51:10,723 - INFO - 检测到批次级统计数据，直接聚合...
2025-12-01 14:51:10,782 - ERROR - 班组合格率数据处理失败: "Column(s) ['处理时间'] do not exist"
2025-12-01 14:51:10,783 - ERROR - ETL处理失败: "Column(s) ['处理时间'] do not exist"
Traceback (most recent call last):
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\etl_dataclean_sfc_team_passrate.py", line 401, in main
    result_df = process_team_passrate_data(config, force_full_refresh=(args.mode == 'full'))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\etl_dataclean_sfc_team_passrate.py", line 358, in process_team_passrate_data
    aggregated_df = aggregate_team_passrate_data(cleaned_df, config)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\etl_dataclean_sfc_team_passrate.py", line 248, in aggregate_team_passrate_data
    aggregated = result.groupby(group_fields).agg(
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\groupby\generic.py", line 1432, in aggregate
    result = op.agg()
             ^^^^^^^^
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\apply.py", line 190, in agg
    return self.agg_dict_like()
           ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\apply.py", line 423, in agg_dict_like
    return self.agg_or_apply_dict_like(op_name="agg")
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\apply.py", line 1608, in agg_or_apply_dict_like
    result_index, result_data = self.compute_dict_like(
                                ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\apply.py", line 462, in compute_dict_like
    func = self.normalize_dictlike_arg(op_name, selected_obj, func)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\apply.py", line 663, in normalize_dictlike_arg
    raise KeyError(f"Column(s) {list(cols)} do not exist")
KeyError: "Column(s) ['处理时间'] do not exist"
2025-12-01 14:54:48,715 - INFO - ============================================================
2025-12-01 14:54:48,718 - INFO - 开始处理SFC班组合格率数据
2025-12-01 14:54:48,719 - INFO - ============================================================
2025-12-01 14:54:48,721 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-01 14:54:48,737 - INFO - 找到 282 个班组合格率数据文件，按修改时间排序
2025-12-01 14:54:48,737 - INFO - 🧪 测试模式：仅读取前 120 个最新文件
2025-12-01 14:54:48,737 - INFO -   1. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-01 14:54:48,738 - INFO -   2. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-01 14:54:48,738 - INFO -   3. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-01 14:54:48,740 - INFO -   4. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-01 14:54:48,741 - INFO -   5. IGPR-20251201080001.xlsx (修改时间: 2025-12-01 08:15:17)
2025-12-01 14:54:48,741 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-01 14:54:52,583 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-01 14:54:55,335 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-01 14:54:56,227 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-01 14:54:57,364 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-01 14:54:58,295 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-01 14:55:00,828 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-01 14:55:03,896 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-01 14:55:06,623 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-01 14:55:09,305 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-01 14:55:11,688 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-01 14:55:13,633 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-01 14:55:15,297 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-01 14:55:18,006 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-01 14:55:21,018 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-01 14:55:23,882 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-01 14:55:26,763 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-01 14:55:30,354 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-01 14:55:32,838 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-01 14:55:34,550 - INFO - 读取文件: IGPR-20251117080001.xlsx
2025-12-01 14:55:36,039 - INFO - 读取文件: IGPR-20251113200001.xlsx
2025-12-01 14:55:40,254 - INFO - 读取文件: IGPR-20251112200001.xlsx
2025-12-01 14:55:42,220 - INFO - 读取文件: IGPR-20251111200001.xlsx
2025-12-01 14:55:46,812 - INFO - 读取文件: IGPR-20251110200001.xlsx
2025-12-01 14:55:50,208 - INFO - 读取文件: IGPR-20251107200001.xlsx
2025-12-01 14:55:57,336 - INFO - 读取文件: IGPR-20251108200001.xlsx
2025-12-01 14:56:05,277 - INFO - 读取文件: IGPR-20251109200001.xlsx
2025-12-01 14:56:09,787 - INFO - 读取文件: IGPR-20251106200001.xlsx
2025-12-01 14:56:16,833 - INFO - 读取文件: IGPR-20251105200001.xlsx
2025-12-01 14:56:26,773 - INFO - 读取文件: IGPR-20251104200001.xlsx
2025-12-01 14:56:36,488 - INFO - 读取文件: IGPR-20251103200001.xlsx
2025-12-01 14:56:41,936 - INFO - 读取文件: IGPR-20251031200001.xlsx
2025-12-01 14:56:49,854 - INFO - 读取文件: IGPR-20251101200001.xlsx
2025-12-01 14:56:56,288 - INFO - 读取文件: IGPR-20251102200001.xlsx
2025-12-01 14:57:00,746 - INFO - 读取文件: IGPR-20251031080001.xlsx
2025-12-01 14:57:05,801 - INFO - 读取文件: IGPR-20251029200001.xlsx
2025-12-01 14:57:14,573 - INFO - 读取文件: IGPR-20251028200001.xlsx
2025-12-01 14:57:22,301 - INFO - 读取文件: IGPR-20251027200001.xlsx
2025-12-01 14:57:28,460 - INFO - 读取文件: IGPR-20251024200001.xlsx
2025-12-01 14:57:35,643 - INFO - 读取文件: IGPR-20251025200001.xlsx
2025-12-01 14:57:40,530 - INFO - 读取文件: IGPR-20251026200001.xlsx
2025-12-01 14:57:43,635 - INFO - 读取文件: IGPR-20251023080001.xlsx
2025-12-01 14:57:48,297 - INFO - 读取文件: IGPR-20251023200001.xlsx
2025-12-01 14:57:53,795 - INFO - 读取文件: IGPR-20251021200001.xlsx
2025-12-01 14:57:55,093 - INFO - 读取文件: IGPR-20251020200001.xlsx
2025-12-01 14:57:56,197 - INFO - 读取文件: IGPR-20251018080001.xlsx
2025-12-01 14:57:57,866 - INFO - 读取文件: IGPR-20251019080001.xlsx
2025-12-01 14:57:58,430 - INFO - 读取文件: IGPR-20251020080001.xlsx
2025-12-01 14:57:58,964 - INFO - 读取文件: IGPR-20251017080001.xlsx
2025-12-01 14:58:00,159 - INFO - 读取文件: IGPR-20251016080001.xlsx
2025-12-01 14:58:01,606 - INFO - 读取文件: IGPR-20251014080001.xlsx
2025-12-01 14:58:04,099 - INFO - 读取文件: IGPR-20251015080001.xlsx
2025-12-01 14:58:05,495 - INFO - 读取文件: IGPR-20251009080001.xlsx
2025-12-01 14:58:06,326 - INFO - 读取文件: IGPR-20251001080001.xlsx
2025-12-01 14:58:07,654 - INFO - 读取文件: IGPR-20251007080001.xlsx
2025-12-01 14:58:07,670 - INFO - 读取文件: IGPR-20251008080001.xlsx
2025-12-01 14:58:07,861 - INFO - 读取文件: IGPR-20250930080001.xlsx
2025-12-01 14:58:09,255 - INFO - 读取文件: IGPR-20250929080001.xlsx
2025-12-01 14:58:10,592 - INFO - 读取文件: IGPR-20250927080001.xlsx
2025-12-01 14:58:12,025 - INFO - 读取文件: IGPR-20250928080001.xlsx
2025-12-01 14:58:12,701 - INFO - 读取文件: IGPR-20250926080001.xlsx
2025-12-01 14:58:14,203 - INFO - 读取文件: IGPR-20250925080001.xlsx
2025-12-01 14:58:15,420 - INFO - 读取文件: IGPR-20250924080001.xlsx
2025-12-01 14:58:16,969 - INFO - 读取文件: IGPR-20250923080001.xlsx
2025-12-01 14:58:18,517 - INFO - 读取文件: IGPR-20250920080001.xlsx
2025-12-01 14:58:20,031 - INFO - 读取文件: IGPR-20250921080001.xlsx
2025-12-01 14:58:20,535 - INFO - 读取文件: IGPR-20250922080001.xlsx
2025-12-01 14:58:20,627 - INFO - 读取文件: IGPR-20250919080001.xlsx
2025-12-01 14:58:22,308 - INFO - 读取文件: IGPR-20250918080001.xlsx
2025-12-01 14:58:24,024 - INFO - 读取文件: IGPR-20250917080001.xlsx
2025-12-01 14:58:25,755 - INFO - 读取文件: IGPR-20250916080001.xlsx
2025-12-01 14:58:27,038 - INFO - 读取文件: IGPR-20250913080001.xlsx
2025-12-01 14:58:28,508 - INFO - 读取文件: IGPR-20250914080001.xlsx
2025-12-01 14:58:28,633 - INFO - 读取文件: IGPR-20250915080001.xlsx
2025-12-01 14:58:28,803 - INFO - 读取文件: IGPR-20250912080001.xlsx
2025-12-01 14:58:30,327 - INFO - 读取文件: IGPR-20250911080001.xlsx
2025-12-01 14:58:31,731 - INFO - 读取文件: IGPR-20250910080001.xlsx
2025-12-01 14:58:33,415 - INFO - 读取文件: IGPR-20250908080001.xlsx
2025-12-01 14:58:33,710 - INFO - 读取文件: IGPR-20250909080001.xlsx
2025-12-01 14:58:35,859 - INFO - 读取文件: IGPR-20250906080001.xlsx
2025-12-01 14:58:39,614 - INFO - 读取文件: IGPR-20250905080001.xlsx
2025-12-01 14:58:43,417 - INFO - 读取文件: IGPR-20250904080001.xlsx
2025-12-01 14:58:47,052 - INFO - 读取文件: IGPR-20250903080001.xlsx
2025-12-01 14:58:50,759 - INFO - 读取文件: IGPR-20250902080001.xlsx
2025-12-01 14:58:54,328 - INFO - 读取文件: IGPR-20250829080001.xlsx
2025-12-01 14:58:57,849 - INFO - 读取文件: IGPR-20250830080001.xlsx
2025-12-01 14:59:01,489 - INFO - 读取文件: IGPR-20250831080001.xlsx
2025-12-01 14:59:02,114 - INFO - 读取文件: IGPR-20250901080001.xlsx
2025-12-01 14:59:02,496 - INFO - 读取文件: IGPR-20250827080001.xlsx
2025-12-01 14:59:07,196 - INFO - 读取文件: IGPR-20250828080001.xlsx
2025-12-01 14:59:10,937 - INFO - 读取文件: IGPR-20250826080001.xlsx
2025-12-01 14:59:14,259 - INFO - 读取文件: IGPR-20250823080001.xlsx
2025-12-01 14:59:18,685 - INFO - 读取文件: IGPR-20250824080001.xlsx
2025-12-01 14:59:19,309 - INFO - 读取文件: IGPR-20250825080001.xlsx
2025-12-01 14:59:19,848 - INFO - 读取文件: IGPR-20250822080001.xlsx
2025-12-01 14:59:25,187 - INFO - 读取文件: IGPR-20250821080001.xlsx
2025-12-01 14:59:29,211 - INFO - 读取文件: IGPR-20250820080001.xlsx
2025-12-01 14:59:33,619 - INFO - 读取文件: IGPR-20250819080001.xlsx
2025-12-01 14:59:36,571 - INFO - 读取文件: IGPR-20250815080001.xlsx
2025-12-01 14:59:39,816 - INFO - 读取文件: IGPR-20250816080001.xlsx
2025-12-01 14:59:43,326 - INFO - 读取文件: IGPR-20250817080001.xlsx
2025-12-01 14:59:43,610 - INFO - 读取文件: IGPR-20250818080001.xlsx
2025-12-01 14:59:43,930 - INFO - 读取文件: IGPR-20250814080001.xlsx
2025-12-01 14:59:47,658 - INFO - 读取文件: IGPR-20250813080001.xlsx
2025-12-01 14:59:51,184 - INFO - 读取文件: IGPR-20250812080001.xlsx
2025-12-01 14:59:54,910 - INFO - 读取文件: IGPR-20250810080001.xlsx
2025-12-01 14:59:55,299 - INFO - 读取文件: IGPR-20250811080001.xlsx
2025-12-01 14:59:55,729 - INFO - 读取文件: IGPR-20250809080001.xlsx
2025-12-01 14:59:59,493 - INFO - 读取文件: IGPR-20250808080001.xlsx
2025-12-01 15:00:02,785 - INFO - 读取文件: IGPR-20250807080001.xlsx
2025-12-01 15:00:06,455 - INFO - 读取文件: IGPR-20250806080001.xlsx
2025-12-01 15:00:09,729 - INFO - 读取文件: IGPR-20250805080001.xlsx
2025-12-01 15:00:13,580 - INFO - 读取文件: IGPR-20250802080001.xlsx
2025-12-01 15:00:17,105 - INFO - 读取文件: IGPR-20250804080001.xlsx
2025-12-01 15:00:17,369 - INFO - 读取文件: IGPR-20250801080001.xlsx
2025-12-01 15:00:20,734 - INFO - 读取文件: IGPR-20250731080001.xlsx
2025-12-01 15:00:22,354 - INFO - 读取文件: IGPR-20250730080001.xlsx
2025-12-01 15:00:26,263 - INFO - 读取文件: IGPR-20250725080001.xlsx
2025-12-01 15:00:29,543 - INFO - 读取文件: IGPR-20250726080001.xlsx
2025-12-01 15:00:34,392 - INFO - 读取文件: IGPR-20250727080001.xlsx
2025-12-01 15:00:39,217 - INFO - 合并后班组合格率数据行数: 1628547
2025-12-01 15:00:39,322 - INFO - 开始验证班组合格率数据完整性...
2025-12-01 15:00:39,592 - INFO - 班组合格率数据验证通过: 1628547 行记录
2025-12-01 15:00:39,594 - INFO - 开始清洗班组合格率数据...
2025-12-01 15:00:40,277 - INFO - 已用工序编号填充 22795 个缺失的机床设备
2025-12-01 15:00:40,377 - INFO - 已填充 48158 个缺失的产品序号
2025-12-01 15:00:41,074 - WARNING - 发现 48158 个异常检验结果
2025-12-01 15:00:42,296 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 301864 条重复记录
2025-12-01 15:00:44,442 - INFO - 总去重统计: 移除 301864 条重复记录
2025-12-01 15:00:44,444 - INFO - 班组合格率数据清洗完成: 1628547 → 1326683 行
2025-12-01 15:00:44,584 - INFO - 开始按业务维度分组聚合数据...
2025-12-01 15:00:44,584 - INFO - 检测到批次级统计数据，直接聚合...
2025-12-01 15:01:08,036 - INFO - 聚合完成: 1326683 → 51207 条记录
2025-12-01 15:01:08,037 - INFO - 平均合格率: 99.46%
2025-12-01 15:01:08,130 - INFO - 开始计算班组合格率指标...
2025-12-01 15:01:08,142 - INFO - 已计算产品合格率
2025-12-01 15:01:08,225 - INFO - 已计算班组统计指标
2025-12-01 15:01:08,230 - INFO - 班组合格率指标计算完成
2025-12-01 15:01:08,231 - INFO - 最终数据统计:
2025-12-01 15:01:08,232 - INFO -   总记录数: 51207
2025-12-01 15:01:08,236 - INFO -   班组数: 8
2025-12-01 15:01:08,240 - INFO -   批次数: 7825
2025-12-01 15:01:08,241 - INFO -   平均合格率: 99.46%
2025-12-01 15:01:09,170 - INFO - 已保存Parquet文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet, 行数: 51207
2025-12-01 15:01:09,182 - INFO - 数据量较大(51207行)，Excel文件只保存前10000行
2025-12-01 15:01:14,036 - INFO - 已保存Excel验证文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 10000
2025-12-01 15:01:14,039 - INFO - 班组合格率数据已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet
2025-12-01 15:01:14,489 - INFO - 班组合格率Excel验证文件已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-01 15:01:14,490 - INFO - SFC班组合格率数据处理完成
2025-12-01 15:11:32,125 - INFO - ============================================================
2025-12-01 15:11:32,127 - INFO - 开始处理SFC班组合格率数据
2025-12-01 15:11:32,132 - INFO - ============================================================
2025-12-01 15:11:32,133 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-01 15:11:32,248 - INFO - 找到 282 个班组合格率数据文件，按修改时间排序
2025-12-01 15:11:32,249 - INFO - 🧪 测试模式：仅读取前 120 个最新文件
2025-12-01 15:11:32,249 - INFO -   1. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-01 15:11:32,251 - INFO -   2. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-01 15:11:32,257 - INFO -   3. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-01 15:11:32,258 - INFO -   4. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-01 15:11:32,260 - INFO -   5. IGPR-20251201080001.xlsx (修改时间: 2025-12-01 08:15:17)
2025-12-01 15:11:32,262 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-01 15:11:39,110 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-01 15:11:44,898 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-01 15:11:46,327 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-01 15:11:48,738 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-01 15:11:50,273 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-01 15:11:53,113 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-01 15:11:55,357 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-01 15:11:58,063 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-01 15:12:00,898 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-01 15:12:03,714 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-01 15:12:05,218 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-01 15:12:06,507 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-01 15:12:08,775 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-01 15:12:11,638 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-01 15:12:13,767 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-01 15:12:16,181 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-01 15:12:20,001 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-01 15:12:22,328 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-01 15:12:23,622 - INFO - 读取文件: IGPR-20251117080001.xlsx
2025-12-01 15:12:25,010 - INFO - 读取文件: IGPR-20251113200001.xlsx
2025-12-01 15:12:28,549 - INFO - 读取文件: IGPR-20251112200001.xlsx
2025-12-01 15:12:30,280 - INFO - 读取文件: IGPR-20251111200001.xlsx
2025-12-01 15:12:34,557 - INFO - 读取文件: IGPR-20251110200001.xlsx
2025-12-01 15:12:37,641 - INFO - 读取文件: IGPR-20251107200001.xlsx
2025-12-01 15:12:41,064 - INFO - 读取文件: IGPR-20251108200001.xlsx
2025-12-01 15:12:44,116 - INFO - 读取文件: IGPR-20251109200001.xlsx
2025-12-01 15:12:46,180 - INFO - 读取文件: IGPR-20251106200001.xlsx
2025-12-01 15:12:49,311 - INFO - 读取文件: IGPR-20251105200001.xlsx
2025-12-01 15:12:53,027 - INFO - 读取文件: IGPR-20251104200001.xlsx
2025-12-01 15:12:56,014 - INFO - 读取文件: IGPR-20251103200001.xlsx
2025-12-01 15:12:58,594 - INFO - 读取文件: IGPR-20251031200001.xlsx
2025-12-01 15:13:02,939 - INFO - 读取文件: IGPR-20251101200001.xlsx
2025-12-01 15:13:06,664 - INFO - 读取文件: IGPR-20251102200001.xlsx
2025-12-01 15:13:08,581 - INFO - 读取文件: IGPR-20251031080001.xlsx
2025-12-01 15:13:11,332 - INFO - 读取文件: IGPR-20251029200001.xlsx
2025-12-01 15:13:14,726 - INFO - 读取文件: IGPR-20251028200001.xlsx
2025-12-01 15:13:17,924 - INFO - 读取文件: IGPR-20251027200001.xlsx
2025-12-01 15:13:20,134 - INFO - 读取文件: IGPR-20251024200001.xlsx
2025-12-01 15:13:23,250 - INFO - 读取文件: IGPR-20251025200001.xlsx
2025-12-01 15:13:25,746 - INFO - 读取文件: IGPR-20251026200001.xlsx
2025-12-01 15:13:27,251 - INFO - 读取文件: IGPR-20251023080001.xlsx
2025-12-01 15:13:29,372 - INFO - 读取文件: IGPR-20251023200001.xlsx
2025-12-01 15:13:32,581 - INFO - 读取文件: IGPR-20251021200001.xlsx
2025-12-01 15:13:33,524 - INFO - 读取文件: IGPR-20251020200001.xlsx
2025-12-01 15:13:34,301 - INFO - 读取文件: IGPR-20251018080001.xlsx
2025-12-01 15:13:35,476 - INFO - 读取文件: IGPR-20251019080001.xlsx
2025-12-01 15:13:35,998 - INFO - 读取文件: IGPR-20251020080001.xlsx
2025-12-01 15:13:36,533 - INFO - 读取文件: IGPR-20251017080001.xlsx
2025-12-01 15:13:38,172 - INFO - 读取文件: IGPR-20251016080001.xlsx
2025-12-01 15:13:39,232 - INFO - 读取文件: IGPR-20251014080001.xlsx
2025-12-01 15:13:41,100 - INFO - 读取文件: IGPR-20251015080001.xlsx
2025-12-01 15:13:42,106 - INFO - 读取文件: IGPR-20251009080001.xlsx
2025-12-01 15:13:42,641 - INFO - 读取文件: IGPR-20251001080001.xlsx
2025-12-01 15:13:43,767 - INFO - 读取文件: IGPR-20251007080001.xlsx
2025-12-01 15:13:43,780 - INFO - 读取文件: IGPR-20251008080001.xlsx
2025-12-01 15:13:43,957 - INFO - 读取文件: IGPR-20250930080001.xlsx
2025-12-01 15:13:45,127 - INFO - 读取文件: IGPR-20250929080001.xlsx
2025-12-01 15:13:46,296 - INFO - 读取文件: IGPR-20250927080001.xlsx
2025-12-01 15:13:47,523 - INFO - 读取文件: IGPR-20250928080001.xlsx
2025-12-01 15:13:48,213 - INFO - 读取文件: IGPR-20250926080001.xlsx
2025-12-01 15:13:49,695 - INFO - 读取文件: IGPR-20250925080001.xlsx
2025-12-01 15:13:51,186 - INFO - 读取文件: IGPR-20250924080001.xlsx
2025-12-01 15:13:52,364 - INFO - 读取文件: IGPR-20250923080001.xlsx
2025-12-01 15:13:53,635 - INFO - 读取文件: IGPR-20250920080001.xlsx
2025-12-01 15:13:55,037 - INFO - 读取文件: IGPR-20250921080001.xlsx
2025-12-01 15:13:55,392 - INFO - 读取文件: IGPR-20250922080001.xlsx
2025-12-01 15:13:55,497 - INFO - 读取文件: IGPR-20250919080001.xlsx
2025-12-01 15:13:56,896 - INFO - 读取文件: IGPR-20250918080001.xlsx
2025-12-01 15:13:58,511 - INFO - 读取文件: IGPR-20250917080001.xlsx
2025-12-01 15:13:59,821 - INFO - 读取文件: IGPR-20250916080001.xlsx
2025-12-01 15:14:01,113 - INFO - 读取文件: IGPR-20250913080001.xlsx
2025-12-01 15:14:02,836 - INFO - 读取文件: IGPR-20250914080001.xlsx
2025-12-01 15:14:02,962 - INFO - 读取文件: IGPR-20250915080001.xlsx
2025-12-01 15:14:03,165 - INFO - 读取文件: IGPR-20250912080001.xlsx
2025-12-01 15:14:04,416 - INFO - 读取文件: IGPR-20250911080001.xlsx
2025-12-01 15:14:05,662 - INFO - 读取文件: IGPR-20250910080001.xlsx
2025-12-01 15:14:06,955 - INFO - 读取文件: IGPR-20250908080001.xlsx
2025-12-01 15:14:07,065 - INFO - 读取文件: IGPR-20250909080001.xlsx
2025-12-01 15:14:08,128 - INFO - 读取文件: IGPR-20250906080001.xlsx
2025-12-01 15:14:10,087 - INFO - 读取文件: IGPR-20250905080001.xlsx
2025-12-01 15:14:12,060 - INFO - 读取文件: IGPR-20250904080001.xlsx
2025-12-01 15:14:13,739 - INFO - 读取文件: IGPR-20250903080001.xlsx
2025-12-01 15:14:15,507 - INFO - 读取文件: IGPR-20250902080001.xlsx
2025-12-01 15:14:17,280 - INFO - 读取文件: IGPR-20250829080001.xlsx
2025-12-01 15:14:19,286 - INFO - 读取文件: IGPR-20250830080001.xlsx
2025-12-01 15:14:21,020 - INFO - 读取文件: IGPR-20250831080001.xlsx
2025-12-01 15:14:21,236 - INFO - 读取文件: IGPR-20250901080001.xlsx
2025-12-01 15:14:21,422 - INFO - 读取文件: IGPR-20250827080001.xlsx
2025-12-01 15:14:23,462 - INFO - 读取文件: IGPR-20250828080001.xlsx
2025-12-01 15:14:25,313 - INFO - 读取文件: IGPR-20250826080001.xlsx
2025-12-01 15:14:27,441 - INFO - 读取文件: IGPR-20250823080001.xlsx
2025-12-01 15:14:29,431 - INFO - 读取文件: IGPR-20250824080001.xlsx
2025-12-01 15:14:29,644 - INFO - 读取文件: IGPR-20250825080001.xlsx
2025-12-01 15:14:29,781 - INFO - 读取文件: IGPR-20250822080001.xlsx
2025-12-01 15:14:32,111 - INFO - 读取文件: IGPR-20250821080001.xlsx
2025-12-01 15:14:34,011 - INFO - 读取文件: IGPR-20250820080001.xlsx
2025-12-01 15:14:35,786 - INFO - 读取文件: IGPR-20250819080001.xlsx
2025-12-01 15:14:37,657 - INFO - 读取文件: IGPR-20250815080001.xlsx
2025-12-01 15:14:39,598 - INFO - 读取文件: IGPR-20250816080001.xlsx
2025-12-01 15:14:41,881 - INFO - 读取文件: IGPR-20250817080001.xlsx
2025-12-01 15:14:42,080 - INFO - 读取文件: IGPR-20250818080001.xlsx
2025-12-01 15:14:42,360 - INFO - 读取文件: IGPR-20250814080001.xlsx
2025-12-01 15:14:44,515 - INFO - 读取文件: IGPR-20250813080001.xlsx
2025-12-01 15:14:46,642 - INFO - 读取文件: IGPR-20250812080001.xlsx
2025-12-01 15:14:48,358 - INFO - 读取文件: IGPR-20250810080001.xlsx
2025-12-01 15:14:48,511 - INFO - 读取文件: IGPR-20250811080001.xlsx
2025-12-01 15:14:48,681 - INFO - 读取文件: IGPR-20250809080001.xlsx
2025-12-01 15:14:50,515 - INFO - 读取文件: IGPR-20250808080001.xlsx
2025-12-01 15:14:52,204 - INFO - 读取文件: IGPR-20250807080001.xlsx
2025-12-01 15:14:54,262 - INFO - 读取文件: IGPR-20250806080001.xlsx
2025-12-01 15:14:56,188 - INFO - 读取文件: IGPR-20250805080001.xlsx
2025-12-01 15:14:58,560 - INFO - 读取文件: IGPR-20250802080001.xlsx
2025-12-01 15:15:00,640 - INFO - 读取文件: IGPR-20250804080001.xlsx
2025-12-01 15:15:00,950 - INFO - 读取文件: IGPR-20250801080001.xlsx
2025-12-01 15:15:03,652 - INFO - 读取文件: IGPR-20250731080001.xlsx
2025-12-01 15:15:04,987 - INFO - 读取文件: IGPR-20250730080001.xlsx
2025-12-01 15:15:07,199 - INFO - 读取文件: IGPR-20250725080001.xlsx
2025-12-01 15:15:09,133 - INFO - 读取文件: IGPR-20250726080001.xlsx
2025-12-01 15:15:11,107 - INFO - 读取文件: IGPR-20250727080001.xlsx
2025-12-01 15:15:13,417 - INFO - 合并后班组合格率数据行数: 1628547
2025-12-01 15:15:13,525 - INFO - 开始验证班组合格率数据完整性...
2025-12-01 15:15:13,642 - INFO - 班组合格率数据验证通过: 1628547 行记录
2025-12-01 15:15:13,642 - INFO - 开始清洗班组合格率数据...
2025-12-01 15:15:14,171 - INFO - 已用工序编号填充 22795 个缺失的机床设备
2025-12-01 15:15:14,304 - INFO - 已填充 48158 个缺失的产品序号
2025-12-01 15:15:14,704 - WARNING - 发现 48158 个异常检验结果
2025-12-01 15:15:15,517 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 301864 条重复记录
2025-12-01 15:15:16,943 - INFO - 总去重统计: 移除 301864 条重复记录
2025-12-01 15:15:16,945 - INFO - 班组合格率数据清洗完成: 1628547 → 1326683 行
2025-12-01 15:15:17,027 - INFO - 开始按业务维度分组聚合数据...
2025-12-01 15:15:17,028 - INFO - 检测到批次级统计数据，直接聚合...
2025-12-01 15:15:27,863 - INFO - 聚合完成: 1326683 → 51207 条记录
2025-12-01 15:15:27,864 - INFO - 平均合格率: 99.46%
2025-12-01 15:15:27,925 - INFO - 开始从SFC批次报工表获取工序加工时间...
2025-12-01 15:15:28,566 - INFO - 成功读取SFC批次报工表: 78334 条记录
2025-12-01 15:15:28,607 - INFO - SFC批次报工表去重后: 76127 条唯一记录
2025-12-01 15:15:28,620 - ERROR - 数据增强失败: Can only compare identically-labeled Series objects
2025-12-01 15:15:28,631 - INFO - 开始补充聚合数据的指标字段...
2025-12-01 15:15:28,649 - INFO - 聚合数据指标补充完成
2025-12-01 15:15:28,649 - INFO - 最终数据统计:
2025-12-01 15:15:28,650 - INFO -   总记录数: 51207
2025-12-01 15:15:28,658 - INFO -   班组数: 8
2025-12-01 15:15:28,664 - INFO -   批次数: 7825
2025-12-01 15:15:29,073 - INFO - 已保存Parquet文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet, 行数: 51207
2025-12-01 15:15:29,084 - INFO - 数据量较大(51207行)，Excel文件只保存前10000行
2025-12-01 15:15:31,501 - INFO - 已保存Excel验证文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 10000
2025-12-01 15:15:31,505 - INFO - 班组合格率数据已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet
2025-12-01 15:15:31,848 - INFO - 班组合格率Excel验证文件已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-01 15:15:31,848 - INFO - SFC班组合格率数据处理完成
2025-12-01 15:16:03,707 - INFO - ============================================================
2025-12-01 15:16:03,708 - INFO - 开始处理SFC班组合格率数据
2025-12-01 15:16:03,709 - INFO - ============================================================
2025-12-01 15:16:03,709 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-01 15:16:03,719 - INFO - 找到 282 个班组合格率数据文件，按修改时间排序
2025-12-01 15:16:03,720 - INFO - 🧪 测试模式：仅读取前 120 个最新文件
2025-12-01 15:16:03,721 - INFO -   1. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-01 15:16:03,721 - INFO -   2. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-01 15:16:03,722 - INFO -   3. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-01 15:16:03,723 - INFO -   4. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-01 15:16:03,723 - INFO -   5. IGPR-20251201080001.xlsx (修改时间: 2025-12-01 08:15:17)
2025-12-01 15:16:03,724 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-01 15:16:12,172 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-01 15:16:16,796 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-01 15:16:17,940 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-01 15:16:20,675 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-01 15:16:22,444 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-01 15:16:29,234 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-01 15:16:35,577 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-01 15:16:40,126 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-01 15:16:45,933 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-01 15:16:49,485 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-01 15:16:52,494 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-01 15:16:54,727 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-01 15:17:01,325 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-01 15:17:05,475 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-01 15:17:07,854 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-01 15:17:16,547 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-01 15:17:25,620 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-01 15:17:29,696 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-01 15:17:34,773 - INFO - 读取文件: IGPR-20251117080001.xlsx
2025-12-01 15:17:37,745 - INFO - 读取文件: IGPR-20251113200001.xlsx
2025-12-01 15:17:48,946 - INFO - 读取文件: IGPR-20251112200001.xlsx
2025-12-01 15:17:52,531 - INFO - 读取文件: IGPR-20251111200001.xlsx
2025-12-01 15:18:02,679 - INFO - 读取文件: IGPR-20251110200001.xlsx
2025-12-01 15:18:09,816 - INFO - 读取文件: IGPR-20251107200001.xlsx
2025-12-01 15:18:21,397 - INFO - 读取文件: IGPR-20251108200001.xlsx
2025-12-01 15:18:31,101 - INFO - 读取文件: IGPR-20251109200001.xlsx
2025-12-01 15:18:37,350 - INFO - 读取文件: IGPR-20251106200001.xlsx
2025-12-01 15:18:46,999 - INFO - 读取文件: IGPR-20251105200001.xlsx
2025-12-01 15:18:56,547 - INFO - 读取文件: IGPR-20251104200001.xlsx
2025-12-01 15:19:01,623 - INFO - 读取文件: IGPR-20251103200001.xlsx
2025-12-01 15:19:04,378 - INFO - 读取文件: IGPR-20251031200001.xlsx
2025-12-01 15:19:08,274 - INFO - 读取文件: IGPR-20251101200001.xlsx
2025-12-01 15:19:11,342 - INFO - 读取文件: IGPR-20251102200001.xlsx
2025-12-01 15:19:13,330 - INFO - 读取文件: IGPR-20251031080001.xlsx
2025-12-01 15:19:15,827 - INFO - 读取文件: IGPR-20251029200001.xlsx
2025-12-01 15:19:19,754 - INFO - 读取文件: IGPR-20251028200001.xlsx
2025-12-01 15:19:23,653 - INFO - 读取文件: IGPR-20251027200001.xlsx
2025-12-01 15:19:25,740 - INFO - 读取文件: IGPR-20251024200001.xlsx
2025-12-01 15:19:29,680 - INFO - 读取文件: IGPR-20251025200001.xlsx
2025-12-01 15:19:34,568 - INFO - 读取文件: IGPR-20251026200001.xlsx
2025-12-01 15:19:37,582 - INFO - 读取文件: IGPR-20251023080001.xlsx
2025-12-01 15:19:41,941 - INFO - 读取文件: IGPR-20251023200001.xlsx
2025-12-01 15:19:49,213 - INFO - 读取文件: IGPR-20251021200001.xlsx
2025-12-01 15:19:51,353 - INFO - 读取文件: IGPR-20251020200001.xlsx
2025-12-01 15:19:53,323 - INFO - 读取文件: IGPR-20251018080001.xlsx
2025-12-01 15:19:55,753 - INFO - 读取文件: IGPR-20251019080001.xlsx
2025-12-01 15:19:56,681 - INFO - 读取文件: IGPR-20251020080001.xlsx
2025-12-01 15:19:57,555 - INFO - 读取文件: IGPR-20251017080001.xlsx
2025-12-01 15:19:59,889 - INFO - 读取文件: IGPR-20251016080001.xlsx
2025-12-01 15:20:02,328 - INFO - 读取文件: IGPR-20251014080001.xlsx
2025-12-01 15:20:05,454 - INFO - 读取文件: IGPR-20251015080001.xlsx
2025-12-01 15:20:07,513 - INFO - 读取文件: IGPR-20251009080001.xlsx
2025-12-01 15:20:08,707 - INFO - 读取文件: IGPR-20251001080001.xlsx
2025-12-01 15:20:10,849 - INFO - 读取文件: IGPR-20251007080001.xlsx
2025-12-01 15:20:10,861 - INFO - 读取文件: IGPR-20251008080001.xlsx
2025-12-01 15:20:11,129 - INFO - 读取文件: IGPR-20250930080001.xlsx
2025-12-01 15:20:14,066 - INFO - 读取文件: IGPR-20250929080001.xlsx
2025-12-01 15:20:16,353 - INFO - 读取文件: IGPR-20250927080001.xlsx
2025-12-01 15:20:18,675 - INFO - 读取文件: IGPR-20250928080001.xlsx
2025-12-01 15:20:19,484 - INFO - 读取文件: IGPR-20250926080001.xlsx
2025-12-01 15:20:20,841 - INFO - 读取文件: IGPR-20250925080001.xlsx
2025-12-01 15:20:22,120 - INFO - 读取文件: IGPR-20250924080001.xlsx
2025-12-01 15:20:23,315 - INFO - 读取文件: IGPR-20250923080001.xlsx
2025-12-01 15:20:24,731 - INFO - 读取文件: IGPR-20250920080001.xlsx
2025-12-01 15:20:25,982 - INFO - 读取文件: IGPR-20250921080001.xlsx
2025-12-01 15:20:26,366 - INFO - 读取文件: IGPR-20250922080001.xlsx
2025-12-01 15:20:26,455 - INFO - 读取文件: IGPR-20250919080001.xlsx
2025-12-01 15:20:28,199 - INFO - 读取文件: IGPR-20250918080001.xlsx
2025-12-01 15:20:29,693 - INFO - 读取文件: IGPR-20250917080001.xlsx
2025-12-01 15:20:31,002 - INFO - 读取文件: IGPR-20250916080001.xlsx
2025-12-01 15:20:32,248 - INFO - 读取文件: IGPR-20250913080001.xlsx
2025-12-01 15:20:33,565 - INFO - 读取文件: IGPR-20250914080001.xlsx
2025-12-01 15:20:33,669 - INFO - 读取文件: IGPR-20250915080001.xlsx
2025-12-01 15:20:33,834 - INFO - 读取文件: IGPR-20250912080001.xlsx
2025-12-01 15:20:35,113 - INFO - 读取文件: IGPR-20250911080001.xlsx
2025-12-01 15:20:36,588 - INFO - 读取文件: IGPR-20250910080001.xlsx
2025-12-01 15:20:38,343 - INFO - 读取文件: IGPR-20250908080001.xlsx
2025-12-01 15:20:38,561 - INFO - 读取文件: IGPR-20250909080001.xlsx
2025-12-01 15:20:39,689 - INFO - 读取文件: IGPR-20250906080001.xlsx
2025-12-01 15:20:41,639 - INFO - 读取文件: IGPR-20250905080001.xlsx
2025-12-01 15:20:43,669 - INFO - 读取文件: IGPR-20250904080001.xlsx
2025-12-01 15:20:45,347 - INFO - 读取文件: IGPR-20250903080001.xlsx
2025-12-01 15:20:47,119 - INFO - 读取文件: IGPR-20250902080001.xlsx
2025-12-01 15:20:48,766 - INFO - 读取文件: IGPR-20250829080001.xlsx
2025-12-01 15:20:50,552 - INFO - 读取文件: IGPR-20250830080001.xlsx
2025-12-01 15:20:52,625 - INFO - 读取文件: IGPR-20250831080001.xlsx
2025-12-01 15:20:52,907 - INFO - 读取文件: IGPR-20250901080001.xlsx
2025-12-01 15:20:53,113 - INFO - 读取文件: IGPR-20250827080001.xlsx
2025-12-01 15:20:55,916 - INFO - 读取文件: IGPR-20250828080001.xlsx
2025-12-01 15:20:58,253 - INFO - 读取文件: IGPR-20250826080001.xlsx
2025-12-01 15:21:00,346 - INFO - 读取文件: IGPR-20250823080001.xlsx
2025-12-01 15:21:02,955 - INFO - 读取文件: IGPR-20250824080001.xlsx
2025-12-01 15:21:03,181 - INFO - 读取文件: IGPR-20250825080001.xlsx
2025-12-01 15:21:03,429 - INFO - 读取文件: IGPR-20250822080001.xlsx
2025-12-01 15:21:05,928 - INFO - 读取文件: IGPR-20250821080001.xlsx
2025-12-01 15:21:08,229 - INFO - 读取文件: IGPR-20250820080001.xlsx
2025-12-01 15:21:10,476 - INFO - 读取文件: IGPR-20250819080001.xlsx
2025-12-01 15:21:12,289 - INFO - 读取文件: IGPR-20250815080001.xlsx
2025-12-01 15:21:14,239 - INFO - 读取文件: IGPR-20250816080001.xlsx
2025-12-01 15:21:15,951 - INFO - 读取文件: IGPR-20250817080001.xlsx
2025-12-01 15:21:16,130 - INFO - 读取文件: IGPR-20250818080001.xlsx
2025-12-01 15:21:16,343 - INFO - 读取文件: IGPR-20250814080001.xlsx
2025-12-01 15:21:18,766 - INFO - 读取文件: IGPR-20250813080001.xlsx
2025-12-01 15:21:20,810 - INFO - 读取文件: IGPR-20250812080001.xlsx
2025-12-01 15:21:22,743 - INFO - 读取文件: IGPR-20250810080001.xlsx
2025-12-01 15:21:22,939 - INFO - 读取文件: IGPR-20250811080001.xlsx
2025-12-01 15:21:23,116 - INFO - 读取文件: IGPR-20250809080001.xlsx
2025-12-01 15:21:25,271 - INFO - 读取文件: IGPR-20250808080001.xlsx
2025-12-01 15:21:27,235 - INFO - 读取文件: IGPR-20250807080001.xlsx
2025-12-01 15:21:29,231 - INFO - 读取文件: IGPR-20250806080001.xlsx
2025-12-01 15:21:31,559 - INFO - 读取文件: IGPR-20250805080001.xlsx
2025-12-01 15:21:34,036 - INFO - 读取文件: IGPR-20250802080001.xlsx
2025-12-01 15:21:36,254 - INFO - 读取文件: IGPR-20250804080001.xlsx
2025-12-01 15:21:36,446 - INFO - 读取文件: IGPR-20250801080001.xlsx
2025-12-01 15:21:38,757 - INFO - 读取文件: IGPR-20250731080001.xlsx
2025-12-01 15:21:39,655 - INFO - 读取文件: IGPR-20250730080001.xlsx
2025-12-01 15:21:41,690 - INFO - 读取文件: IGPR-20250725080001.xlsx
2025-12-01 15:21:43,679 - INFO - 读取文件: IGPR-20250726080001.xlsx
2025-12-01 15:21:45,831 - INFO - 读取文件: IGPR-20250727080001.xlsx
2025-12-01 15:21:48,142 - INFO - 合并后班组合格率数据行数: 1628547
2025-12-01 15:21:48,197 - INFO - 开始验证班组合格率数据完整性...
2025-12-01 15:21:48,303 - INFO - 班组合格率数据验证通过: 1628547 行记录
2025-12-01 15:21:48,303 - INFO - 开始清洗班组合格率数据...
2025-12-01 15:21:48,831 - INFO - 已用工序编号填充 22795 个缺失的机床设备
2025-12-01 15:21:48,942 - INFO - 已填充 48158 个缺失的产品序号
2025-12-01 15:21:49,453 - WARNING - 发现 48158 个异常检验结果
2025-12-01 15:21:50,492 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 301864 条重复记录
2025-12-01 15:21:51,716 - INFO - 总去重统计: 移除 301864 条重复记录
2025-12-01 15:21:51,717 - INFO - 班组合格率数据清洗完成: 1628547 → 1326683 行
2025-12-01 15:21:51,786 - INFO - 开始按业务维度分组聚合数据...
2025-12-01 15:21:51,787 - INFO - 检测到批次级统计数据，直接聚合...
2025-12-01 15:21:57,082 - INFO - 聚合完成: 1326683 → 51207 条记录
2025-12-01 15:21:57,085 - INFO - 平均合格率: 99.46%
2025-12-01 15:21:57,160 - INFO - 开始从SFC批次报工表获取工序加工时间...
2025-12-01 15:21:57,569 - INFO - 成功读取SFC批次报工表: 78334 条记录
2025-12-01 15:21:57,595 - INFO - SFC批次报工表去重后: 76127 条唯一记录
2025-12-01 15:21:57,605 - ERROR - 数据增强失败: Can only compare identically-labeled Series objects
2025-12-01 15:21:57,611 - INFO - 开始补充聚合数据的指标字段...
2025-12-01 15:21:57,624 - INFO - 聚合数据指标补充完成
2025-12-01 15:21:57,624 - INFO - 最终数据统计:
2025-12-01 15:21:57,624 - INFO -   总记录数: 51207
2025-12-01 15:21:57,627 - INFO -   班组数: 8
2025-12-01 15:21:57,630 - INFO -   批次数: 7825
2025-12-01 15:21:57,920 - INFO - 已保存Parquet文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet, 行数: 51207
2025-12-01 15:21:57,930 - INFO - 数据量较大(51207行)，Excel文件只保存前10000行
2025-12-01 15:22:00,724 - INFO - 已保存Excel验证文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 10000
2025-12-01 15:22:00,726 - INFO - 班组合格率数据已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet
2025-12-01 15:22:00,973 - INFO - 班组合格率Excel验证文件已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-01 15:22:00,975 - INFO - SFC班组合格率数据处理完成
2025-12-01 15:22:50,520 - INFO - ============================================================
2025-12-01 15:22:50,521 - INFO - 开始处理SFC班组合格率数据
2025-12-01 15:22:50,521 - INFO - ============================================================
2025-12-01 15:22:50,522 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-01 15:22:50,540 - INFO - 找到 282 个班组合格率数据文件，按修改时间排序
2025-12-01 15:22:50,541 - INFO - 🧪 测试模式：仅读取前 120 个最新文件
2025-12-01 15:22:50,542 - INFO -   1. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-01 15:22:50,543 - INFO -   2. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-01 15:22:50,543 - INFO -   3. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-01 15:22:50,544 - INFO -   4. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-01 15:22:50,545 - INFO -   5. IGPR-20251201080001.xlsx (修改时间: 2025-12-01 08:15:17)
2025-12-01 15:22:50,545 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-01 15:23:02,123 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-01 15:23:09,255 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-01 15:23:10,392 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-01 15:23:12,329 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-01 15:23:14,563 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-01 15:23:23,848 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-01 15:23:36,146 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-01 15:23:49,031 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-01 15:24:01,006 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-01 15:24:12,715 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-01 15:24:21,584 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-01 15:24:29,005 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-01 15:24:39,521 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-01 15:24:46,797 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-01 15:24:52,053 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-01 15:24:58,354 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-01 15:25:08,889 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-01 15:25:14,504 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-01 15:25:18,255 - INFO - 读取文件: IGPR-20251117080001.xlsx
2025-12-01 15:25:22,674 - INFO - 读取文件: IGPR-20251113200001.xlsx
2025-12-01 15:25:32,039 - INFO - 读取文件: IGPR-20251112200001.xlsx
2025-12-01 15:25:36,182 - INFO - 读取文件: IGPR-20251111200001.xlsx
2025-12-01 15:25:45,010 - INFO - 读取文件: IGPR-20251110200001.xlsx
2025-12-01 15:25:52,080 - INFO - 读取文件: IGPR-20251107200001.xlsx
2025-12-01 15:26:00,996 - INFO - 读取文件: IGPR-20251108200001.xlsx
2025-12-01 15:26:10,893 - INFO - 读取文件: IGPR-20251109200001.xlsx
2025-12-01 15:26:16,657 - INFO - 读取文件: IGPR-20251106200001.xlsx
2025-12-01 15:26:26,103 - INFO - 读取文件: IGPR-20251105200001.xlsx
2025-12-01 15:26:36,214 - INFO - 读取文件: IGPR-20251104200001.xlsx
2025-12-01 15:26:44,510 - INFO - 读取文件: IGPR-20251103200001.xlsx
2025-12-01 15:26:50,742 - INFO - 读取文件: IGPR-20251031200001.xlsx
2025-12-01 15:27:00,131 - INFO - 读取文件: IGPR-20251101200001.xlsx
2025-12-01 15:27:08,391 - INFO - 读取文件: IGPR-20251102200001.xlsx
2025-12-01 15:27:13,610 - INFO - 读取文件: IGPR-20251031080001.xlsx
2025-12-01 15:27:20,369 - INFO - 读取文件: IGPR-20251029200001.xlsx
2025-12-01 15:27:29,753 - INFO - 读取文件: IGPR-20251028200001.xlsx
2025-12-01 15:27:41,420 - INFO - 读取文件: IGPR-20251027200001.xlsx
2025-12-01 15:27:52,342 - INFO - 读取文件: IGPR-20251024200001.xlsx
2025-12-01 15:32:00,071 - INFO - 读取文件: IGPR-20251025200001.xlsx
2025-12-01 15:32:09,346 - INFO - 读取文件: IGPR-20251026200001.xlsx
2025-12-01 15:32:16,218 - INFO - 读取文件: IGPR-20251023080001.xlsx
2025-12-01 15:32:26,008 - INFO - 读取文件: IGPR-20251023200001.xlsx
2025-12-01 15:32:41,409 - INFO - 读取文件: IGPR-20251021200001.xlsx
2025-12-01 15:32:46,543 - INFO - 读取文件: IGPR-20251020200001.xlsx
2025-12-01 15:32:50,734 - INFO - 读取文件: IGPR-20251018080001.xlsx
2025-12-01 15:32:56,723 - INFO - 读取文件: IGPR-20251019080001.xlsx
2025-12-01 15:32:59,341 - INFO - 读取文件: IGPR-20251020080001.xlsx
2025-12-01 15:33:02,198 - INFO - 读取文件: IGPR-20251017080001.xlsx
2025-12-01 15:33:07,811 - INFO - 读取文件: IGPR-20251016080001.xlsx
2025-12-01 15:33:12,849 - INFO - 读取文件: IGPR-20251014080001.xlsx
2025-12-01 15:33:22,021 - INFO - 读取文件: IGPR-20251015080001.xlsx
2025-12-01 15:33:27,112 - INFO - 读取文件: IGPR-20251009080001.xlsx
2025-12-01 15:33:29,932 - INFO - 读取文件: IGPR-20251001080001.xlsx
2025-12-01 15:33:35,403 - INFO - 读取文件: IGPR-20251007080001.xlsx
2025-12-01 15:33:35,459 - INFO - 读取文件: IGPR-20251008080001.xlsx
2025-12-01 15:33:36,427 - INFO - 读取文件: IGPR-20250930080001.xlsx
2025-12-01 15:33:42,675 - INFO - 读取文件: IGPR-20250929080001.xlsx
2025-12-01 15:33:48,520 - INFO - 读取文件: IGPR-20250927080001.xlsx
2025-12-01 15:33:54,519 - INFO - 读取文件: IGPR-20250928080001.xlsx
2025-12-01 15:33:57,856 - INFO - 读取文件: IGPR-20250926080001.xlsx
2025-12-01 15:34:04,186 - INFO - 读取文件: IGPR-20250925080001.xlsx
2025-12-01 15:34:10,213 - INFO - 读取文件: IGPR-20250924080001.xlsx
2025-12-01 15:34:15,954 - INFO - 读取文件: IGPR-20250923080001.xlsx
2025-12-01 15:34:22,160 - INFO - 读取文件: IGPR-20250920080001.xlsx
2025-12-01 15:34:28,818 - INFO - 读取文件: IGPR-20250921080001.xlsx
2025-12-01 15:34:30,599 - INFO - 读取文件: IGPR-20250922080001.xlsx
2025-12-01 15:34:31,028 - INFO - 读取文件: IGPR-20250919080001.xlsx
2025-12-01 15:34:37,743 - INFO - 读取文件: IGPR-20250918080001.xlsx
2025-12-01 15:34:44,667 - INFO - 读取文件: IGPR-20250917080001.xlsx
2025-12-01 15:34:51,275 - INFO - 读取文件: IGPR-20250916080001.xlsx
2025-12-01 15:34:56,609 - INFO - 读取文件: IGPR-20250913080001.xlsx
2025-12-01 15:35:02,451 - INFO - 读取文件: IGPR-20250914080001.xlsx
2025-12-01 15:35:02,956 - INFO - 读取文件: IGPR-20250915080001.xlsx
2025-12-01 15:35:03,749 - INFO - 读取文件: IGPR-20250912080001.xlsx
2025-12-01 15:35:09,333 - INFO - 读取文件: IGPR-20250911080001.xlsx
2025-12-01 15:35:15,237 - INFO - 读取文件: IGPR-20250910080001.xlsx
2025-12-01 15:35:21,572 - INFO - 读取文件: IGPR-20250908080001.xlsx
2025-12-01 15:35:22,170 - INFO - 读取文件: IGPR-20250909080001.xlsx
2025-12-01 15:35:28,973 - INFO - 读取文件: IGPR-20250906080001.xlsx
2025-12-01 15:43:08,198 - INFO - 读取文件: IGPR-20250905080001.xlsx
2025-12-01 15:43:19,284 - INFO - 读取文件: IGPR-20250904080001.xlsx
2025-12-01 15:43:24,801 - INFO - 读取文件: IGPR-20250903080001.xlsx
2025-12-01 15:43:29,717 - INFO - 读取文件: IGPR-20250902080001.xlsx
2025-12-01 15:43:34,195 - INFO - 读取文件: IGPR-20250829080001.xlsx
2025-12-01 15:43:39,466 - INFO - 读取文件: IGPR-20250830080001.xlsx
2025-12-01 15:43:44,124 - INFO - 读取文件: IGPR-20250831080001.xlsx
2025-12-01 15:43:44,639 - INFO - 读取文件: IGPR-20250901080001.xlsx
2025-12-01 15:43:45,230 - INFO - 读取文件: IGPR-20250827080001.xlsx
2025-12-01 15:43:51,180 - INFO - 读取文件: IGPR-20250828080001.xlsx
2025-12-01 15:43:56,376 - INFO - 读取文件: IGPR-20250826080001.xlsx
2025-12-01 15:44:01,661 - INFO - 读取文件: IGPR-20250823080001.xlsx
2025-12-01 15:44:07,081 - INFO - 读取文件: IGPR-20250824080001.xlsx
2025-12-01 15:44:07,678 - INFO - 读取文件: IGPR-20250825080001.xlsx
2025-12-01 15:44:08,074 - INFO - 读取文件: IGPR-20250822080001.xlsx
2025-12-01 15:44:15,179 - INFO - 读取文件: IGPR-20250821080001.xlsx
2025-12-01 15:44:20,476 - INFO - 读取文件: IGPR-20250820080001.xlsx
2025-12-01 15:44:25,327 - INFO - 读取文件: IGPR-20250819080001.xlsx
2025-12-01 15:44:29,220 - INFO - 读取文件: IGPR-20250815080001.xlsx
2025-12-01 15:44:34,127 - INFO - 读取文件: IGPR-20250816080001.xlsx
2025-12-01 15:44:38,861 - INFO - 读取文件: IGPR-20250817080001.xlsx
2025-12-01 15:44:39,242 - INFO - 读取文件: IGPR-20250818080001.xlsx
2025-12-01 15:44:39,651 - INFO - 读取文件: IGPR-20250814080001.xlsx
2025-12-01 15:44:44,783 - INFO - 读取文件: IGPR-20250813080001.xlsx
2025-12-01 15:44:49,810 - INFO - 读取文件: IGPR-20250812080001.xlsx
2025-12-01 15:44:54,301 - INFO - 读取文件: IGPR-20250810080001.xlsx
2025-12-01 15:44:54,780 - INFO - 读取文件: IGPR-20250811080001.xlsx
2025-12-01 15:44:55,239 - INFO - 读取文件: IGPR-20250809080001.xlsx
2025-12-01 15:45:00,488 - INFO - 读取文件: IGPR-20250808080001.xlsx
2025-12-01 15:45:05,296 - INFO - 读取文件: IGPR-20250807080001.xlsx
2025-12-01 15:45:10,084 - INFO - 读取文件: IGPR-20250806080001.xlsx
2025-12-01 15:45:36,985 - INFO - ============================================================
2025-12-01 15:45:36,986 - INFO - 开始处理SFC班组合格率数据
2025-12-01 15:45:36,989 - INFO - ============================================================
2025-12-01 15:45:36,990 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-01 15:45:37,047 - INFO - 找到 282 个班组合格率数据文件，按修改时间排序
2025-12-01 15:45:37,049 - INFO - 🧪 测试模式：仅读取前 20 个最新文件
2025-12-01 15:45:37,050 - INFO -   1. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-01 15:45:37,051 - INFO -   2. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-01 15:45:37,052 - INFO -   3. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-01 15:45:37,052 - INFO -   4. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-01 15:45:37,053 - INFO -   5. IGPR-20251201080001.xlsx (修改时间: 2025-12-01 08:15:17)
2025-12-01 15:45:37,054 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-01 15:45:45,784 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-01 15:45:52,196 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-01 15:45:53,542 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-01 15:45:55,333 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-01 15:45:56,777 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-01 15:46:01,751 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-01 15:46:07,253 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-01 15:46:13,611 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-01 15:46:19,089 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-01 15:46:24,586 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-01 15:46:28,611 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-01 15:46:31,958 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-01 15:46:37,717 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-01 15:46:44,063 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-01 15:46:49,958 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-01 15:46:55,551 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-01 15:47:04,032 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-01 15:47:09,871 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-01 15:47:13,442 - INFO - 读取文件: IGPR-20251117080001.xlsx
2025-12-01 15:47:17,266 - INFO - 合并后班组合格率数据行数: 310660
2025-12-01 15:47:17,295 - INFO - 开始验证班组合格率数据完整性...
2025-12-01 15:47:17,389 - INFO - 班组合格率数据验证通过: 310660 行记录
2025-12-01 15:47:17,391 - INFO - 开始清洗班组合格率数据...
2025-12-01 15:47:17,630 - INFO - 已用工序编号填充 3505 个缺失的机床设备
2025-12-01 15:47:17,703 - INFO - 已填充 7483 个缺失的产品序号
2025-12-01 15:47:17,889 - WARNING - 发现 7483 个异常检验结果
2025-12-01 15:47:18,285 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 58200 条重复记录
2025-12-01 15:47:18,816 - INFO - 总去重统计: 移除 58200 条重复记录
2025-12-01 15:47:18,818 - INFO - 班组合格率数据清洗完成: 310660 → 252460 行
2025-12-01 15:47:18,865 - INFO - 开始按业务维度分组聚合数据...
2025-12-01 15:47:18,866 - INFO - 检测到批次级统计数据，直接聚合...
2025-12-01 15:47:22,967 - INFO - 聚合完成: 252460 → 8129 条记录
2025-12-01 15:47:22,969 - INFO - 平均合格率: 99.49%
2025-12-01 15:47:22,991 - INFO - 开始从SFC批次报工表获取工序加工时间...
2025-12-01 15:47:24,043 - INFO - 成功读取SFC批次报工表: 78334 条记录
2025-12-01 15:47:24,100 - INFO - SFC批次报工表去重后: 76127 条唯一记录
2025-12-01 15:47:24,104 - INFO - 班组合格率聚合数据调试信息:
2025-12-01 15:47:24,105 - INFO -   数据形状: (8129, 14)
2025-12-01 15:47:24,105 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-01 15:47:24,105 - INFO -   关键字段存在: 批次号=True, 工序编号=True
2025-12-01 15:47:24,107 - INFO -   关键字段样本: 批次号=IPQCK25L4343, 工序编号=10   
2025-12-01 15:47:24,107 - INFO - SFC批次报工表调试信息:
2025-12-01 15:47:24,107 - INFO -   数据形状: (76127, 4)
2025-12-01 15:47:24,109 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-01 15:47:24,109 - INFO -   关键字段样本: BatchNumber=K25J5020, Operation=0190
2025-12-01 15:47:24,111 - INFO - 开始执行合并操作...
2025-12-01 15:47:24,194 - INFO - 合并操作成功完成
2025-12-01 15:47:24,202 - INFO - 数据增强完成: 0/8129 条记录匹配到加工时间 (0.0%)
2025-12-01 15:47:24,203 - WARNING - 加工时间匹配率较低 (0.0%)，可能存在数据不一致
2025-12-01 15:47:24,218 - INFO - 开始补充聚合数据的指标字段...
2025-12-01 15:47:24,227 - INFO - 聚合数据指标补充完成
2025-12-01 15:47:24,228 - INFO - 最终数据统计:
2025-12-01 15:47:24,229 - INFO -   总记录数: 8129
2025-12-01 15:47:24,230 - INFO -   班组数: 8
2025-12-01 15:47:24,234 - INFO -   批次数: 1789
2025-12-01 15:47:24,512 - INFO - 已保存Parquet文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet, 行数: 8129
2025-12-01 15:47:29,179 - INFO - 已保存Excel验证文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 8129
2025-12-01 15:47:29,180 - INFO - 班组合格率数据已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet
2025-12-01 15:47:30,055 - INFO - 班组合格率Excel验证文件已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-01 15:47:30,056 - INFO - SFC班组合格率数据处理完成
2025-12-01 15:52:16,897 - INFO - ============================================================
2025-12-01 15:52:16,899 - INFO - 开始处理SFC班组合格率数据
2025-12-01 15:52:16,900 - INFO - ============================================================
2025-12-01 15:52:16,901 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-01 15:52:16,924 - INFO - 找到 282 个班组合格率数据文件，按修改时间排序
2025-12-01 15:52:16,927 - INFO - 🧪 测试模式：仅读取前 20 个最新文件
2025-12-01 15:52:16,929 - INFO -   1. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-01 15:52:16,931 - INFO -   2. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-01 15:52:16,932 - INFO -   3. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-01 15:52:16,933 - INFO -   4. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-01 15:52:16,935 - INFO -   5. IGPR-20251201080001.xlsx (修改时间: 2025-12-01 08:15:17)
2025-12-01 15:52:16,936 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-01 15:52:25,848 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-01 15:52:31,938 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-01 15:52:33,286 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-01 15:52:35,335 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-01 15:52:36,752 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-01 15:52:41,667 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-01 15:52:47,817 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-01 15:52:54,270 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-01 15:53:00,204 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-01 15:53:04,866 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-01 15:53:09,136 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-01 15:53:12,970 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-01 15:53:18,278 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-01 15:53:24,438 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-01 15:53:30,402 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-01 15:53:36,358 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-01 15:53:45,256 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-01 15:53:51,312 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-01 15:53:55,546 - INFO - 读取文件: IGPR-20251117080001.xlsx
2025-12-01 15:54:00,442 - INFO - 合并后班组合格率数据行数: 310660
2025-12-01 15:54:00,465 - INFO - 开始验证班组合格率数据完整性...
2025-12-01 15:54:00,547 - INFO - 班组合格率数据验证通过: 310660 行记录
2025-12-01 15:54:00,549 - INFO - 开始清洗班组合格率数据...
2025-12-01 15:54:00,690 - INFO - 已用工序编号填充 3505 个缺失的机床设备
2025-12-01 15:54:00,714 - INFO - 已填充 7483 个缺失的产品序号
2025-12-01 15:54:00,946 - WARNING - 发现 7483 个异常检验结果
2025-12-01 15:54:01,339 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 58200 条重复记录
2025-12-01 15:54:01,857 - INFO - 总去重统计: 移除 58200 条重复记录
2025-12-01 15:54:01,859 - INFO - 班组合格率数据清洗完成: 310660 → 252460 行
2025-12-01 15:54:01,893 - INFO - 开始按业务维度分组聚合数据...
2025-12-01 15:54:01,894 - INFO - 检测到批次级统计数据，直接聚合...
2025-12-01 15:54:06,370 - INFO - 聚合完成: 252460 → 8129 条记录
2025-12-01 15:54:06,372 - INFO - 平均合格率: 99.49%
2025-12-01 15:54:06,398 - INFO - 开始从SFC批次报工表获取工序加工时间...
2025-12-01 15:54:06,716 - INFO - 成功读取SFC批次报工表: 78334 条记录
2025-12-01 15:54:06,778 - INFO - SFC批次报工表去重后: 76127 条唯一记录
2025-12-01 15:54:06,794 - INFO - 已标准化批次号：移除IPQCK前缀
2025-12-01 15:54:06,805 - INFO - 已标准化工序编号：数字补零到4位
2025-12-01 15:54:06,808 - INFO - 数据标准化效果:
2025-12-01 15:54:06,816 - INFO -   批次号标准化: ['IPQCK25L4343', 'K25L3010', 'K25L3011', 'K25L3009', 'K25L3012'] -> ['25L4343', 'K25L3010', 'K25L3011', 'K25L3009', 'K25L3012']
2025-12-01 15:54:06,824 - INFO -   工序编号标准化: ['10   ', '20   ', 'N/A  ', '90   ', '80   '] -> ['10   ', '20   ', 'N/A  ', '90   ', '80   ']
2025-12-01 15:54:06,825 - INFO - 班组合格率聚合数据调试信息:
2025-12-01 15:54:06,826 - INFO -   数据形状: (8129, 16)
2025-12-01 15:54:06,827 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-01 15:54:06,829 - INFO -   关键字段存在: 批次号_标准化=True, 工序编号_标准化=True
2025-12-01 15:54:06,830 - INFO -   关键字段样本: 批次号_标准化=25L4343, 工序编号_标准化=10   
2025-12-01 15:54:06,830 - INFO - SFC批次报工表调试信息:
2025-12-01 15:54:06,831 - INFO -   数据形状: (76127, 4)
2025-12-01 15:54:06,831 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-01 15:54:06,832 - INFO -   关键字段样本: BatchNumber=K25J5020, Operation=0190
2025-12-01 15:54:06,833 - INFO - 开始执行合并操作（使用标准化字段）...
2025-12-01 15:54:06,903 - INFO - 合并操作成功完成
2025-12-01 15:54:06,914 - INFO - 数据增强完成: 41/8129 条记录匹配到加工时间 (0.5%)
2025-12-01 15:54:06,915 - WARNING - 加工时间匹配率较低 (0.5%)，可能存在数据不一致
2025-12-01 15:54:06,928 - INFO - 开始补充聚合数据的指标字段...
2025-12-01 15:54:06,936 - INFO - 聚合数据指标补充完成
2025-12-01 15:54:06,937 - INFO - 最终数据统计:
2025-12-01 15:54:06,938 - INFO -   总记录数: 8129
2025-12-01 15:54:06,941 - INFO -   班组数: 8
2025-12-01 15:54:06,944 - INFO -   批次数: 1789
2025-12-01 15:54:07,183 - INFO - 已保存Parquet文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet, 行数: 8129
2025-12-01 15:54:12,570 - INFO - 已保存Excel验证文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 8129
2025-12-01 15:54:12,572 - INFO - 班组合格率数据已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet
2025-12-01 15:54:13,253 - INFO - 班组合格率Excel验证文件已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-01 15:54:13,256 - INFO - SFC班组合格率数据处理完成
2025-12-01 16:02:51,000 - INFO - ============================================================
2025-12-01 16:02:51,002 - INFO - 开始处理SFC班组合格率数据
2025-12-01 16:02:51,003 - INFO - ============================================================
2025-12-01 16:02:51,003 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-01 16:02:51,042 - INFO - 找到 282 个班组合格率数据文件，按修改时间排序
2025-12-01 16:02:51,046 - INFO - 🧪 测试模式：仅读取前 20 个最新文件
2025-12-01 16:02:51,047 - INFO -   1. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-01 16:02:51,048 - INFO -   2. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-01 16:02:51,049 - INFO -   3. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-01 16:02:51,050 - INFO -   4. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-01 16:02:51,051 - INFO -   5. IGPR-20251201080001.xlsx (修改时间: 2025-12-01 08:15:17)
2025-12-01 16:02:51,052 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-01 16:02:55,403 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-01 16:02:57,780 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-01 16:02:58,452 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-01 16:02:59,384 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-01 16:03:00,147 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-01 16:03:02,853 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-01 16:03:05,261 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-01 16:03:08,129 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-01 16:03:10,835 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-01 16:03:12,949 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-01 16:03:14,695 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-01 16:03:16,501 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-01 16:03:19,301 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-01 16:03:21,923 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-01 16:03:23,993 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-01 16:03:26,906 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-01 16:03:31,103 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-01 16:03:33,785 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-01 16:03:35,655 - INFO - 读取文件: IGPR-20251117080001.xlsx
2025-12-01 16:03:37,534 - INFO - 合并后班组合格率数据行数: 310660
2025-12-01 16:03:37,544 - INFO - 开始验证班组合格率数据完整性...
2025-12-01 16:03:37,570 - INFO - 班组合格率数据验证通过: 310660 行记录
2025-12-01 16:03:37,571 - INFO - 开始清洗班组合格率数据...
2025-12-01 16:03:37,692 - INFO - 已用工序编号填充 3505 个缺失的机床设备
2025-12-01 16:03:37,739 - INFO - 已填充 7483 个缺失的产品序号
2025-12-01 16:03:37,850 - WARNING - 发现 7483 个异常检验结果
2025-12-01 16:03:38,079 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 58200 条重复记录
2025-12-01 16:03:38,485 - INFO - 总去重统计: 移除 58200 条重复记录
2025-12-01 16:03:38,485 - INFO - 班组合格率数据清洗完成: 310660 → 252460 行
2025-12-01 16:03:38,510 - INFO - 开始按业务维度分组聚合数据...
2025-12-01 16:03:38,511 - INFO - 检测到批次级统计数据，直接聚合...
2025-12-01 16:03:40,343 - INFO - 聚合完成: 252460 → 8129 条记录
2025-12-01 16:03:40,345 - INFO - 平均合格率: 99.49%
2025-12-01 16:03:40,356 - INFO - 开始从SFC批次报工表获取工序加工时间...
2025-12-01 16:03:40,713 - INFO - 成功读取SFC批次报工表: 78334 条记录
2025-12-01 16:03:40,742 - INFO - SFC批次报工表去重后: 76127 条唯一记录
2025-12-01 16:03:40,749 - INFO - 已标准化批次号：移除IPQCK前缀
2025-12-01 16:03:40,758 - INFO - 已标准化工序编号：数字补零到4位（与SFC批次报工表保持一致）
2025-12-01 16:03:40,759 - INFO - 数据标准化效果:
2025-12-01 16:03:40,762 - INFO -   批次号标准化: ['IPQCK25L4343', 'K25L3010', 'K25L3011', 'K25L3009', 'K25L3012'] -> ['25L4343', 'K25L3010', 'K25L3011', 'K25L3009', 'K25L3012']
2025-12-01 16:03:40,764 - INFO -   工序编号标准化: ['10   ', '20   ', 'N/A  ', '90   ', '80   '] -> ['0010', '0020', 'N/A', '0090', '0080']
2025-12-01 16:03:40,765 - INFO - 班组合格率聚合数据调试信息:
2025-12-01 16:03:40,765 - INFO -   数据形状: (8129, 16)
2025-12-01 16:03:40,765 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-01 16:03:40,765 - INFO -   关键字段存在: 批次号_标准化=True, 工序编号_标准化=True
2025-12-01 16:03:40,766 - INFO -   关键字段样本: 批次号_标准化=25L4343, 工序编号_标准化=0010
2025-12-01 16:03:40,766 - INFO - SFC批次报工表调试信息:
2025-12-01 16:03:40,766 - INFO -   数据形状: (76127, 4)
2025-12-01 16:03:40,766 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-01 16:03:40,766 - INFO -   关键字段样本: BatchNumber=K25J5020, Operation=0190
2025-12-01 16:03:40,767 - INFO - 开始执行合并操作（使用标准化字段）...
2025-12-01 16:03:40,790 - INFO - 合并操作成功完成
2025-12-01 16:03:40,796 - INFO - 已更新工序编号为4位标准化格式
2025-12-01 16:03:40,797 - INFO - 数据增强完成: 6890/8129 条记录匹配到加工时间 (84.8%)
2025-12-01 16:03:40,803 - INFO - 开始补充聚合数据的指标字段...
2025-12-01 16:03:40,807 - INFO - 聚合数据指标补充完成
2025-12-01 16:03:40,807 - INFO - 最终数据统计:
2025-12-01 16:03:40,807 - INFO -   总记录数: 8129
2025-12-01 16:03:40,808 - INFO -   班组数: 8
2025-12-01 16:03:40,810 - INFO -   批次数: 1789
2025-12-01 16:03:40,889 - INFO - 已保存Parquet文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet, 行数: 8129
2025-12-01 16:03:43,154 - INFO - 已保存Excel验证文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 8129
2025-12-01 16:03:43,156 - INFO - 班组合格率数据已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet
2025-12-01 16:03:43,534 - INFO - 班组合格率Excel验证文件已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-01 16:03:43,535 - INFO - SFC班组合格率数据处理完成
2025-12-01 16:30:34,360 - INFO - ============================================================
2025-12-01 16:30:34,361 - INFO - 开始处理SFC班组合格率数据
2025-12-01 16:30:34,361 - INFO - ============================================================
2025-12-01 16:30:34,363 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-01 16:30:34,396 - INFO - 找到 282 个班组合格率数据文件，按修改时间排序
2025-12-01 16:30:34,396 - INFO -   1. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-01 16:30:34,397 - INFO -   2. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-01 16:30:34,397 - INFO -   3. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-01 16:30:34,397 - INFO -   4. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-01 16:30:34,398 - INFO -   5. IGPR-20251201080001.xlsx (修改时间: 2025-12-01 08:15:17)
2025-12-01 16:30:34,398 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-01 16:30:39,078 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-01 16:30:42,106 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-01 16:30:42,774 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-01 16:30:43,664 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-01 16:30:44,307 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-01 16:30:46,766 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-01 16:30:49,514 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-01 16:30:52,038 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-01 16:30:54,733 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-01 16:30:56,664 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-01 16:30:58,476 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-01 16:31:00,290 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-01 16:31:03,455 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-01 16:31:06,418 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-01 16:31:08,827 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-01 16:31:11,458 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-01 16:31:15,499 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-01 16:31:17,916 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-01 16:31:19,464 - INFO - 读取文件: IGPR-20251117080001.xlsx
2025-12-01 16:31:21,267 - INFO - 读取文件: IGPR-20251113200001.xlsx
2025-12-01 16:31:25,523 - INFO - 读取文件: IGPR-20251112200001.xlsx
2025-12-01 16:31:27,474 - INFO - 读取文件: IGPR-20251111200001.xlsx
2025-12-01 16:31:32,116 - INFO - 读取文件: IGPR-20251110200001.xlsx
2025-12-01 16:31:35,257 - INFO - 读取文件: IGPR-20251107200001.xlsx
2025-12-01 16:31:39,509 - INFO - 读取文件: IGPR-20251108200001.xlsx
2025-12-01 16:31:43,489 - INFO - 读取文件: IGPR-20251109200001.xlsx
2025-12-01 16:31:46,230 - INFO - 读取文件: IGPR-20251106200001.xlsx
2025-12-01 16:31:49,930 - INFO - 读取文件: IGPR-20251105200001.xlsx
2025-12-01 16:31:54,385 - INFO - 读取文件: IGPR-20251104200001.xlsx
2025-12-01 16:31:58,010 - INFO - 读取文件: IGPR-20251103200001.xlsx
2025-12-01 16:32:00,970 - INFO - 读取文件: IGPR-20251031200001.xlsx
2025-12-01 16:32:05,465 - INFO - 读取文件: IGPR-20251101200001.xlsx
2025-12-01 16:32:09,145 - INFO - 读取文件: IGPR-20251102200001.xlsx
2025-12-01 16:32:11,619 - INFO - 读取文件: IGPR-20251031080001.xlsx
2025-12-01 16:32:14,179 - INFO - 读取文件: IGPR-20251029200001.xlsx
2025-12-01 16:32:18,238 - INFO - 读取文件: IGPR-20251028200001.xlsx
2025-12-01 16:32:22,231 - INFO - 读取文件: IGPR-20251027200001.xlsx
2025-12-01 16:32:24,476 - INFO - 读取文件: IGPR-20251024200001.xlsx
2025-12-01 16:32:28,726 - INFO - 读取文件: IGPR-20251025200001.xlsx
2025-12-01 16:32:31,859 - INFO - 读取文件: IGPR-20251026200001.xlsx
2025-12-01 16:32:34,033 - INFO - 读取文件: IGPR-20251023080001.xlsx
2025-12-01 16:32:36,828 - INFO - 读取文件: IGPR-20251023200001.xlsx
2025-12-01 16:32:40,681 - INFO - 读取文件: IGPR-20251021200001.xlsx
2025-12-01 16:32:41,909 - INFO - 读取文件: IGPR-20251020200001.xlsx
2025-12-01 16:32:42,864 - INFO - 读取文件: IGPR-20251018080001.xlsx
2025-12-01 16:32:44,159 - INFO - 读取文件: IGPR-20251019080001.xlsx
2025-12-01 16:32:44,731 - INFO - 读取文件: IGPR-20251020080001.xlsx
2025-12-01 16:32:45,259 - INFO - 读取文件: IGPR-20251017080001.xlsx
2025-12-01 16:32:46,768 - INFO - 读取文件: IGPR-20251016080001.xlsx
2025-12-01 16:32:48,023 - INFO - 读取文件: IGPR-20251014080001.xlsx
2025-12-01 16:32:50,147 - INFO - 读取文件: IGPR-20251015080001.xlsx
2025-12-01 16:32:51,469 - INFO - 读取文件: IGPR-20251009080001.xlsx
2025-12-01 16:32:52,333 - INFO - 读取文件: IGPR-20251001080001.xlsx
2025-12-01 16:32:53,664 - INFO - 读取文件: IGPR-20251007080001.xlsx
2025-12-01 16:32:53,682 - INFO - 读取文件: IGPR-20251008080001.xlsx
2025-12-01 16:32:53,887 - INFO - 读取文件: IGPR-20250930080001.xlsx
2025-12-01 16:32:55,694 - INFO - 读取文件: IGPR-20250929080001.xlsx
2025-12-01 16:32:57,142 - INFO - 读取文件: IGPR-20250927080001.xlsx
2025-12-01 16:32:58,744 - INFO - 读取文件: IGPR-20250928080001.xlsx
2025-12-01 16:32:59,712 - INFO - 读取文件: IGPR-20250926080001.xlsx
2025-12-01 16:33:01,826 - INFO - 读取文件: IGPR-20250925080001.xlsx
2025-12-01 16:33:03,480 - INFO - 读取文件: IGPR-20250924080001.xlsx
2025-12-01 16:33:05,043 - INFO - 读取文件: IGPR-20250923080001.xlsx
2025-12-01 16:33:06,614 - INFO - 读取文件: IGPR-20250920080001.xlsx
2025-12-01 16:33:08,153 - INFO - 读取文件: IGPR-20250921080001.xlsx
2025-12-01 16:33:08,624 - INFO - 读取文件: IGPR-20250922080001.xlsx
2025-12-01 16:33:08,736 - INFO - 读取文件: IGPR-20250919080001.xlsx
2025-12-01 16:33:10,174 - INFO - 读取文件: IGPR-20250918080001.xlsx
2025-12-01 16:33:11,899 - INFO - 读取文件: IGPR-20250917080001.xlsx
2025-12-01 16:33:13,579 - INFO - 读取文件: IGPR-20250916080001.xlsx
2025-12-01 16:33:14,849 - INFO - 读取文件: IGPR-20250913080001.xlsx
2025-12-01 16:33:16,316 - INFO - 读取文件: IGPR-20250914080001.xlsx
2025-12-01 16:33:16,460 - INFO - 读取文件: IGPR-20250915080001.xlsx
2025-12-01 16:33:16,655 - INFO - 读取文件: IGPR-20250912080001.xlsx
2025-12-01 16:33:18,096 - INFO - 读取文件: IGPR-20250911080001.xlsx
2025-12-01 16:33:19,901 - INFO - 读取文件: IGPR-20250910080001.xlsx
2025-12-01 16:33:21,897 - INFO - 读取文件: IGPR-20250908080001.xlsx
2025-12-01 16:33:22,087 - INFO - 读取文件: IGPR-20250909080001.xlsx
2025-12-01 16:33:23,481 - INFO - 读取文件: IGPR-20250906080001.xlsx
2025-12-01 16:33:26,061 - INFO - 读取文件: IGPR-20250905080001.xlsx
2025-12-01 16:33:28,760 - INFO - 读取文件: IGPR-20250904080001.xlsx
2025-12-01 16:33:31,008 - INFO - 读取文件: IGPR-20250903080001.xlsx
2025-12-01 16:33:33,158 - INFO - 读取文件: IGPR-20250902080001.xlsx
2025-12-01 16:33:35,055 - INFO - 读取文件: IGPR-20250829080001.xlsx
2025-12-01 16:33:37,558 - INFO - 读取文件: IGPR-20250830080001.xlsx
2025-12-01 16:33:39,502 - INFO - 读取文件: IGPR-20250831080001.xlsx
2025-12-01 16:33:39,707 - INFO - 读取文件: IGPR-20250901080001.xlsx
2025-12-01 16:33:40,053 - INFO - 读取文件: IGPR-20250827080001.xlsx
2025-12-01 16:33:42,643 - INFO - 读取文件: IGPR-20250828080001.xlsx
2025-12-01 16:33:45,303 - INFO - 读取文件: IGPR-20250826080001.xlsx
2025-12-01 16:33:47,725 - INFO - 读取文件: IGPR-20250823080001.xlsx
2025-12-01 16:33:50,356 - INFO - 读取文件: IGPR-20250824080001.xlsx
2025-12-01 16:33:50,632 - INFO - 读取文件: IGPR-20250825080001.xlsx
2025-12-01 16:33:50,786 - INFO - 读取文件: IGPR-20250822080001.xlsx
2025-12-01 16:33:53,527 - INFO - 读取文件: IGPR-20250821080001.xlsx
2025-12-01 16:33:55,854 - INFO - 读取文件: IGPR-20250820080001.xlsx
2025-12-01 16:33:58,037 - INFO - 读取文件: IGPR-20250819080001.xlsx
2025-12-01 16:34:00,278 - INFO - 读取文件: IGPR-20250815080001.xlsx
2025-12-01 16:34:03,166 - INFO - 读取文件: IGPR-20250816080001.xlsx
2025-12-01 16:34:05,537 - INFO - 读取文件: IGPR-20250817080001.xlsx
2025-12-01 16:34:05,706 - INFO - 读取文件: IGPR-20250818080001.xlsx
2025-12-01 16:34:05,888 - INFO - 读取文件: IGPR-20250814080001.xlsx
2025-12-01 16:34:08,207 - INFO - 读取文件: IGPR-20250813080001.xlsx
2025-12-01 16:34:10,476 - INFO - 读取文件: IGPR-20250812080001.xlsx
2025-12-01 16:34:12,877 - INFO - 读取文件: IGPR-20250810080001.xlsx
2025-12-01 16:34:13,061 - INFO - 读取文件: IGPR-20250811080001.xlsx
2025-12-01 16:34:13,242 - INFO - 读取文件: IGPR-20250809080001.xlsx
2025-12-01 16:34:15,646 - INFO - 读取文件: IGPR-20250808080001.xlsx
2025-12-01 16:34:18,013 - INFO - 读取文件: IGPR-20250807080001.xlsx
2025-12-01 16:34:20,312 - INFO - 读取文件: IGPR-20250806080001.xlsx
2025-12-01 16:34:22,522 - INFO - 读取文件: IGPR-20250805080001.xlsx
2025-12-01 16:34:25,892 - INFO - 读取文件: IGPR-20250802080001.xlsx
2025-12-01 16:34:29,172 - INFO - 读取文件: IGPR-20250804080001.xlsx
2025-12-01 16:34:29,501 - INFO - 读取文件: IGPR-20250801080001.xlsx
2025-12-01 16:34:32,324 - INFO - 读取文件: IGPR-20250731080001.xlsx
2025-12-01 16:34:33,691 - INFO - 读取文件: IGPR-20250730080001.xlsx
2025-12-01 16:34:36,716 - INFO - 读取文件: IGPR-20250725080001.xlsx
2025-12-01 16:34:39,525 - INFO - 读取文件: IGPR-20250726080001.xlsx
2025-12-01 16:34:42,638 - INFO - 读取文件: IGPR-20250727080001.xlsx
2025-12-01 16:34:46,063 - INFO - 读取文件: IGPR-20250728080001.xlsx
2025-12-01 16:34:47,789 - INFO - 读取文件: IGPR-20250729080001.xlsx
2025-12-01 16:34:51,055 - INFO - 读取文件: IGPR-20250724080001.xlsx
2025-12-01 16:34:54,849 - INFO - 读取文件: IGPR-20250723080001.xlsx
2025-12-01 16:34:58,595 - INFO - 读取文件: IGPR-20250612080001.xlsx
2025-12-01 16:35:01,357 - INFO - 读取文件: IGPR-20250613080001.xlsx
2025-12-01 16:35:04,909 - INFO - 读取文件: IGPR-20250614080001.xlsx
2025-12-01 16:35:07,744 - INFO - 读取文件: IGPR-20250615080001.xlsx
2025-12-01 16:35:10,141 - INFO - 读取文件: IGPR-20250616080001.xlsx
2025-12-01 16:35:12,652 - INFO - 读取文件: IGPR-20250617080001.xlsx
2025-12-01 16:35:15,444 - INFO - 读取文件: IGPR-20250618080001.xlsx
2025-12-01 16:35:18,144 - INFO - 读取文件: IGPR-20250619080001.xlsx
2025-12-01 16:35:20,552 - INFO - 读取文件: IGPR-20250620080001.xlsx
2025-12-01 16:35:23,127 - INFO - 读取文件: IGPR-20250621080001.xlsx
2025-12-01 16:35:25,898 - INFO - 读取文件: IGPR-20250622080001.xlsx
2025-12-01 16:35:29,003 - INFO - 读取文件: IGPR-20250623080001.xlsx
2025-12-01 16:35:29,302 - INFO - 读取文件: IGPR-20250624080001.xlsx
2025-12-01 16:35:32,004 - INFO - 读取文件: IGPR-20250625080001.xlsx
2025-12-01 16:35:34,707 - INFO - 读取文件: IGPR-20250626080001.xlsx
2025-12-01 16:35:37,538 - INFO - 读取文件: IGPR-20250627080001.xlsx
2025-12-01 16:35:39,853 - INFO - 读取文件: IGPR-20250628080001.xlsx
2025-12-01 16:35:39,924 - INFO - 读取文件: IGPR-20250629080001.xlsx
2025-12-01 16:35:42,291 - INFO - 读取文件: IGPR-20250630080001.xlsx
2025-12-01 16:35:44,674 - INFO - 读取文件: IGPR-20250701080001.xlsx
2025-12-01 16:35:46,258 - INFO - 读取文件: IGPR-20250702080001.xlsx
2025-12-01 16:35:48,862 - INFO - 读取文件: IGPR-20250703080001.xlsx
2025-12-01 16:35:51,426 - INFO - 读取文件: IGPR-20250704080001.xlsx
2025-12-01 16:35:54,331 - INFO - 读取文件: IGPR-20250705080001.xlsx
2025-12-01 16:35:56,980 - INFO - 读取文件: IGPR-20250706080001.xlsx
2025-12-01 16:35:59,162 - INFO - 读取文件: IGPR-20250707080001.xlsx
2025-12-01 16:36:00,077 - INFO - 读取文件: IGPR-20250708080001.xlsx
2025-12-01 16:36:03,274 - INFO - 读取文件: IGPR-20250709080001.xlsx
2025-12-01 16:36:06,494 - INFO - 读取文件: IGPR-20250710080001.xlsx
2025-12-01 16:36:09,208 - INFO - 读取文件: IGPR-20250711080001.xlsx
2025-12-01 16:36:12,022 - INFO - 读取文件: IGPR-20250712080001.xlsx
2025-12-01 16:36:15,001 - INFO - 读取文件: IGPR-20250713080001.xlsx
2025-12-01 16:36:17,747 - INFO - 读取文件: IGPR-20250714080001.xlsx
2025-12-01 16:36:18,091 - INFO - 读取文件: IGPR-20250715080001.xlsx
2025-12-01 16:36:20,730 - INFO - 读取文件: IGPR-20250716080001.xlsx
2025-12-01 16:36:23,522 - INFO - 读取文件: IGPR-20250717080001.xlsx
2025-12-01 16:36:26,935 - INFO - 读取文件: IGPR-20250718080001.xlsx
2025-12-01 16:36:30,070 - INFO - 读取文件: IGPR-20250719080001.xlsx
2025-12-01 16:36:33,504 - INFO - 读取文件: IGPR-20250720080001.xlsx
2025-12-01 16:36:34,389 - INFO - 读取文件: IGPR-20250721080001.xlsx
2025-12-01 16:36:35,113 - INFO - 读取文件: IGPR-20250722080001.xlsx
2025-12-01 16:36:38,371 - INFO - 读取文件: IGPR-20250611080001.xlsx
2025-12-01 16:36:41,027 - INFO - 读取文件: IGPR-20250610080001.xlsx
2025-12-01 16:36:43,666 - INFO - 读取文件: IGPR-20250607080001.xlsx
2025-12-01 16:36:46,618 - INFO - 读取文件: IGPR-20250608080001.xlsx
2025-12-01 16:36:49,245 - INFO - 读取文件: IGPR-20250609080001.xlsx
2025-12-01 16:36:51,408 - INFO - 读取文件: IGPR-20250606080001.xlsx
2025-12-01 16:36:54,536 - INFO - 读取文件: IGPR-20250605080001.xlsx
2025-12-01 16:36:57,559 - INFO - 读取文件: IGPR-20250531080001.xlsx
2025-12-01 16:37:00,604 - INFO - 读取文件: IGPR-20250530080001.xlsx
2025-12-01 16:37:04,022 - INFO - 读取文件: IGPR-20250524080001.xlsx
2025-12-01 16:37:06,699 - INFO - 读取文件: IGPR-20250525080001.xlsx
2025-12-01 16:37:09,239 - INFO - 读取文件: IGPR-20250526080001.xlsx
2025-12-01 16:37:11,674 - INFO - 读取文件: IGPR-20250527080001.xlsx
2025-12-01 16:37:11,699 - INFO - 读取文件: IGPR-20250528080001.xlsx
2025-12-01 16:37:13,219 - INFO - 读取文件: IGPR-20250529080001.xlsx
2025-12-01 16:37:15,421 - INFO - 读取文件: IGPR-20250523080001.xlsx
2025-12-01 16:37:17,503 - INFO - 读取文件: IGPR-20250522080001.xlsx
2025-12-01 16:37:24,189 - INFO - 读取文件: IGPR-20250521080001.xlsx
2025-12-01 16:37:27,411 - INFO - 读取文件: IGPR-20250520080001.xlsx
2025-12-01 16:37:30,895 - INFO - 读取文件: IGPR-20250515080001.xlsx
2025-12-01 16:37:34,769 - INFO - 读取文件: IGPR-20250516080001.xlsx
2025-12-01 16:37:39,802 - INFO - 读取文件: IGPR-20250517080001.xlsx
2025-12-01 16:37:44,204 - INFO - 读取文件: IGPR-20250518080001.xlsx
2025-12-01 16:37:48,810 - INFO - 读取文件: IGPR-20250519080001.xlsx
2025-12-01 16:37:50,319 - INFO - 读取文件: IGPR-20250423080001.xlsx
2025-12-01 16:37:54,282 - INFO - 读取文件: IGPR-20250424080001.xlsx
2025-12-01 16:37:58,407 - INFO - 读取文件: IGPR-20250425080001.xlsx
2025-12-01 16:38:04,518 - INFO - 读取文件: IGPR-20250426080001.xlsx
2025-12-02 08:32:32,191 - INFO - ============================================================
2025-12-02 08:32:32,195 - INFO - 开始处理SFC班组合格率数据
2025-12-02 08:32:32,196 - INFO - ============================================================
2025-12-02 08:32:32,198 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-02 08:32:32,342 - INFO - 找到 283 个班组合格率数据文件，按修改时间排序
2025-12-02 08:32:32,345 - INFO - 🧪 测试模式：仅读取前 120 个最新文件
2025-12-02 08:32:32,348 - INFO -   1. IGPR-20251202080001.xlsx (修改时间: 2025-12-02 08:14:51)
2025-12-02 08:32:32,349 - INFO -   2. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-02 08:32:32,352 - INFO -   3. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-02 08:32:32,356 - INFO -   4. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-02 08:32:32,358 - INFO -   5. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-02 08:32:32,359 - INFO - 读取文件: IGPR-20251202080001.xlsx
2025-12-02 08:32:37,199 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-02 08:32:40,809 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-02 08:32:43,693 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-02 08:32:44,392 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-02 08:32:45,391 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-02 08:32:46,159 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-02 08:32:48,474 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-02 08:32:51,044 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-02 08:32:53,724 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-02 08:32:56,190 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-02 08:32:58,364 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-02 08:33:00,051 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-02 08:33:02,147 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-02 08:33:05,232 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-02 08:33:08,118 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-02 08:33:10,621 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-02 08:33:13,282 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-02 08:33:17,125 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-02 08:33:19,674 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-02 08:33:21,318 - INFO - 读取文件: IGPR-20251117080001.xlsx
2025-12-02 08:33:23,539 - INFO - 读取文件: IGPR-20251113200001.xlsx
2025-12-02 08:33:28,930 - INFO - 读取文件: IGPR-20251112200001.xlsx
2025-12-02 08:33:31,543 - INFO - 读取文件: IGPR-20251111200001.xlsx
2025-12-02 08:33:37,539 - INFO - 读取文件: IGPR-20251110200001.xlsx
2025-12-02 08:33:41,708 - INFO - 读取文件: IGPR-20251107200001.xlsx
2025-12-02 08:33:46,892 - INFO - 读取文件: IGPR-20251108200001.xlsx
2025-12-02 08:33:51,645 - INFO - 读取文件: IGPR-20251109200001.xlsx
2025-12-02 08:33:54,996 - INFO - 读取文件: IGPR-20251106200001.xlsx
2025-12-02 08:34:00,149 - INFO - 读取文件: IGPR-20251105200001.xlsx
2025-12-02 08:34:07,787 - INFO - 读取文件: IGPR-20251104200001.xlsx
2025-12-02 08:34:13,499 - INFO - 读取文件: IGPR-20251103200001.xlsx
2025-12-02 08:34:17,061 - INFO - 读取文件: IGPR-20251031200001.xlsx
2025-12-02 08:34:21,609 - INFO - 读取文件: IGPR-20251101200001.xlsx
2025-12-02 08:34:25,390 - INFO - 读取文件: IGPR-20251102200001.xlsx
2025-12-02 08:34:27,749 - INFO - 读取文件: IGPR-20251031080001.xlsx
2025-12-02 08:34:30,753 - INFO - 读取文件: IGPR-20251029200001.xlsx
2025-12-02 08:34:36,218 - INFO - 读取文件: IGPR-20251028200001.xlsx
2025-12-02 08:34:39,970 - INFO - 读取文件: IGPR-20251027200001.xlsx
2025-12-02 08:34:42,827 - INFO - 读取文件: IGPR-20251024200001.xlsx
2025-12-02 08:34:48,513 - INFO - 读取文件: IGPR-20251025200001.xlsx
2025-12-02 08:34:53,871 - INFO - 读取文件: IGPR-20251026200001.xlsx
2025-12-02 08:34:56,705 - INFO - 读取文件: IGPR-20251023080001.xlsx
2025-12-02 08:35:00,811 - INFO - 读取文件: IGPR-20251023200001.xlsx
2025-12-02 08:35:07,735 - INFO - 读取文件: IGPR-20251021200001.xlsx
2025-12-02 08:35:09,615 - INFO - 读取文件: IGPR-20251020200001.xlsx
2025-12-02 08:35:11,104 - INFO - 读取文件: IGPR-20251018080001.xlsx
2025-12-02 08:35:13,202 - INFO - 读取文件: IGPR-20251019080001.xlsx
2025-12-02 08:35:14,158 - INFO - 读取文件: IGPR-20251020080001.xlsx
2025-12-02 08:35:15,116 - INFO - 读取文件: IGPR-20251017080001.xlsx
2025-12-02 08:35:17,016 - INFO - 读取文件: IGPR-20251016080001.xlsx
2025-12-02 08:35:18,832 - INFO - 读取文件: IGPR-20251014080001.xlsx
2025-12-02 08:35:22,867 - INFO - 读取文件: IGPR-20251015080001.xlsx
2025-12-02 08:35:24,602 - INFO - 读取文件: IGPR-20251009080001.xlsx
2025-12-02 08:35:25,553 - INFO - 读取文件: IGPR-20251001080001.xlsx
2025-12-02 08:35:27,822 - INFO - 读取文件: IGPR-20251007080001.xlsx
2025-12-02 08:35:27,849 - INFO - 读取文件: IGPR-20251008080001.xlsx
2025-12-02 08:35:28,225 - INFO - 读取文件: IGPR-20250930080001.xlsx
2025-12-02 08:35:30,442 - INFO - 读取文件: IGPR-20250929080001.xlsx
2025-12-02 08:35:32,378 - INFO - 读取文件: IGPR-20250927080001.xlsx
2025-12-02 08:35:34,680 - INFO - 读取文件: IGPR-20250928080001.xlsx
2025-12-02 08:35:35,985 - INFO - 读取文件: IGPR-20250926080001.xlsx
2025-12-02 08:35:38,344 - INFO - 读取文件: IGPR-20250925080001.xlsx
2025-12-02 08:35:40,794 - INFO - 读取文件: IGPR-20250924080001.xlsx
2025-12-02 08:35:43,424 - INFO - 读取文件: IGPR-20250923080001.xlsx
2025-12-02 08:35:45,663 - INFO - 读取文件: IGPR-20250920080001.xlsx
2025-12-02 08:35:48,458 - INFO - 读取文件: IGPR-20250921080001.xlsx
2025-12-02 08:35:49,465 - INFO - 读取文件: IGPR-20250922080001.xlsx
2025-12-02 08:35:49,868 - INFO - 读取文件: IGPR-20250919080001.xlsx
2025-12-02 08:35:54,210 - INFO - 读取文件: IGPR-20250918080001.xlsx
2025-12-02 08:35:58,264 - INFO - 读取文件: IGPR-20250917080001.xlsx
2025-12-02 08:36:01,788 - INFO - 读取文件: IGPR-20250916080001.xlsx
2025-12-02 08:36:07,757 - INFO - 读取文件: IGPR-20250913080001.xlsx
2025-12-02 08:36:10,624 - INFO - 读取文件: IGPR-20250914080001.xlsx
2025-12-02 08:36:10,850 - INFO - 读取文件: IGPR-20250915080001.xlsx
2025-12-02 08:36:11,395 - INFO - 读取文件: IGPR-20250912080001.xlsx
2025-12-02 08:36:14,718 - INFO - 读取文件: IGPR-20250911080001.xlsx
2025-12-02 08:36:17,619 - INFO - 读取文件: IGPR-20250910080001.xlsx
2025-12-02 08:36:20,686 - INFO - 读取文件: IGPR-20250908080001.xlsx
2025-12-02 08:36:20,949 - INFO - 读取文件: IGPR-20250909080001.xlsx
2025-12-02 08:36:23,362 - INFO - 读取文件: IGPR-20250906080001.xlsx
2025-12-02 08:36:27,631 - INFO - 读取文件: IGPR-20250905080001.xlsx
2025-12-02 08:36:31,163 - INFO - 读取文件: IGPR-20250904080001.xlsx
2025-12-02 08:36:34,172 - INFO - 读取文件: IGPR-20250903080001.xlsx
2025-12-02 08:36:37,592 - INFO - 读取文件: IGPR-20250902080001.xlsx
2025-12-02 08:36:40,850 - INFO - 读取文件: IGPR-20250829080001.xlsx
2025-12-02 08:36:44,669 - INFO - 读取文件: IGPR-20250830080001.xlsx
2025-12-02 08:36:48,422 - INFO - 读取文件: IGPR-20250831080001.xlsx
2025-12-02 08:36:48,752 - INFO - 读取文件: IGPR-20250901080001.xlsx
2025-12-02 08:36:49,048 - INFO - 读取文件: IGPR-20250827080001.xlsx
2025-12-02 08:36:52,817 - INFO - 读取文件: IGPR-20250828080001.xlsx
2025-12-02 08:36:55,887 - INFO - 读取文件: IGPR-20250826080001.xlsx
2025-12-02 08:36:58,594 - INFO - 读取文件: IGPR-20250823080001.xlsx
2025-12-02 08:37:02,867 - INFO - 读取文件: IGPR-20250824080001.xlsx
2025-12-02 08:37:03,466 - INFO - 读取文件: IGPR-20250825080001.xlsx
2025-12-02 08:37:03,847 - INFO - 读取文件: IGPR-20250822080001.xlsx
2025-12-02 08:37:09,044 - INFO - 读取文件: IGPR-20250821080001.xlsx
2025-12-02 08:37:12,462 - INFO - 读取文件: IGPR-20250820080001.xlsx
2025-12-02 08:37:15,856 - INFO - 读取文件: IGPR-20250819080001.xlsx
2025-12-02 08:37:18,971 - INFO - 读取文件: IGPR-20250815080001.xlsx
2025-12-02 08:37:22,385 - INFO - 读取文件: IGPR-20250816080001.xlsx
2025-12-02 08:37:25,670 - INFO - 读取文件: IGPR-20250817080001.xlsx
2025-12-02 08:37:25,959 - INFO - 读取文件: IGPR-20250818080001.xlsx
2025-12-02 08:37:26,253 - INFO - 读取文件: IGPR-20250814080001.xlsx
2025-12-02 08:37:29,496 - INFO - 读取文件: IGPR-20250813080001.xlsx
2025-12-02 08:37:33,324 - INFO - 读取文件: IGPR-20250812080001.xlsx
2025-12-02 08:37:36,571 - INFO - 读取文件: IGPR-20250810080001.xlsx
2025-12-02 08:37:36,866 - INFO - 读取文件: IGPR-20250811080001.xlsx
2025-12-02 08:37:37,166 - INFO - 读取文件: IGPR-20250809080001.xlsx
2025-12-02 08:37:40,881 - INFO - 读取文件: IGPR-20250808080001.xlsx
2025-12-02 08:37:44,263 - INFO - 读取文件: IGPR-20250807080001.xlsx
2025-12-02 08:37:47,205 - INFO - 读取文件: IGPR-20250806080001.xlsx
2025-12-02 08:37:50,256 - INFO - 读取文件: IGPR-20250805080001.xlsx
2025-12-02 08:37:54,952 - INFO - 读取文件: IGPR-20250802080001.xlsx
2025-12-02 08:38:00,439 - INFO - 读取文件: IGPR-20250804080001.xlsx
2025-12-02 08:38:01,164 - INFO - 读取文件: IGPR-20250801080001.xlsx
2025-12-02 08:38:05,559 - INFO - 读取文件: IGPR-20250731080001.xlsx
2025-12-02 08:38:07,362 - INFO - 读取文件: IGPR-20250730080001.xlsx
2025-12-02 08:38:10,704 - INFO - 读取文件: IGPR-20250725080001.xlsx
2025-12-02 08:38:17,099 - INFO - 读取文件: IGPR-20250726080001.xlsx
2025-12-02 08:38:20,973 - INFO - 合并后班组合格率数据行数: 1627163
2025-12-02 08:38:21,050 - INFO - 开始验证班组合格率数据完整性...
2025-12-02 08:38:21,259 - INFO - 班组合格率数据验证通过: 1627163 行记录
2025-12-02 08:38:21,260 - INFO - 开始清洗班组合格率数据...
2025-12-02 08:38:21,762 - INFO - 已用工序编号填充 22923 个缺失的机床设备
2025-12-02 08:38:21,847 - INFO - 已填充 48263 个缺失的产品序号
2025-12-02 08:38:22,512 - WARNING - 发现 48263 个异常检验结果
2025-12-02 08:38:23,668 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 302045 条重复记录
2025-12-02 08:38:25,417 - INFO - 总去重统计: 移除 302045 条重复记录
2025-12-02 08:38:25,418 - INFO - 班组合格率数据清洗完成: 1627163 → 1325118 行
2025-12-02 08:38:25,522 - INFO - 开始按批次计算真实合格率...
2025-12-02 08:38:25,523 - INFO - 检测到批次级统计数据，直接聚合...
2025-12-02 08:38:42,293 - INFO - 工序级聚合完成: 1325118 → 51372 条记录
2025-12-02 08:38:42,412 - ERROR - 班组合格率数据处理失败: nan
2025-12-02 08:38:42,413 - ERROR - ETL处理失败: nan
Traceback (most recent call last):
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3805, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "index.pyx", line 167, in pandas._libs.index.IndexEngine.get_loc
  File "index.pyx", line 175, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\\_libs\\index_class_helper.pxi", line 70, in pandas._libs.index.Int64Engine._check_type
KeyError: nan

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\etl_dataclean_sfc_team_passrate.py", line 639, in main
    result_df = process_team_passrate_data(config, force_full_refresh=(args.mode == 'full'))
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\etl_dataclean_sfc_team_passrate.py", line 593, in process_team_passrate_data
    aggregated_df = aggregate_team_passrate_data_batch_level(cleaned_df, config)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\10-SA指标\13-SA数据清洗\01_核心ETL程序\etl_dataclean_sfc_team_passrate.py", line 268, in aggregate_team_passrate_data_batch_level
    final_operations = batch_group.loc[batch_group['工序编号_数字'].idxmax()]
                       ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexing.py", line 1191, in __getitem__
    return self._getitem_axis(maybe_callable, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexing.py", line 1431, in _getitem_axis
    return self._get_label(key, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexing.py", line 1381, in _get_label
    return self.obj.xs(label, axis=axis)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\generic.py", line 4298, in xs
    loc = index.get_loc(key)
          ^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\core\indexes\base.py", line 3812, in get_loc
    raise KeyError(key) from err
KeyError: nan
2025-12-02 08:39:11,673 - INFO - ============================================================
2025-12-02 08:39:11,673 - INFO - 开始处理SFC班组合格率数据
2025-12-02 08:39:11,674 - INFO - ============================================================
2025-12-02 08:39:11,674 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-02 08:39:11,717 - INFO - 找到 283 个班组合格率数据文件，按修改时间排序
2025-12-02 08:39:11,717 - INFO - 🧪 测试模式：仅读取前 120 个最新文件
2025-12-02 08:39:11,719 - INFO -   1. IGPR-20251202080001.xlsx (修改时间: 2025-12-02 08:14:51)
2025-12-02 08:39:11,719 - INFO -   2. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-02 08:39:11,719 - INFO -   3. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-02 08:39:11,719 - INFO -   4. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-02 08:39:11,720 - INFO -   5. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-02 08:39:11,720 - INFO - 读取文件: IGPR-20251202080001.xlsx
2025-12-02 08:41:27,005 - INFO - ============================================================
2025-12-02 08:41:27,006 - INFO - 开始处理SFC班组合格率数据
2025-12-02 08:41:27,007 - INFO - ============================================================
2025-12-02 08:41:27,008 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-02 08:41:27,017 - INFO - 找到 283 个班组合格率数据文件，按修改时间排序
2025-12-02 08:41:27,018 - INFO - 🧪 测试模式：仅读取前 20 个最新文件
2025-12-02 08:41:27,018 - INFO -   1. IGPR-20251202080001.xlsx (修改时间: 2025-12-02 08:14:51)
2025-12-02 08:41:27,019 - INFO -   2. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-02 08:41:27,019 - INFO -   3. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-02 08:41:27,020 - INFO -   4. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-02 08:41:27,021 - INFO -   5. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-02 08:41:27,021 - INFO - 读取文件: IGPR-20251202080001.xlsx
2025-12-02 08:41:29,682 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-02 08:41:33,049 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-02 08:41:35,506 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-02 08:41:36,181 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-02 08:41:37,830 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-02 08:41:39,637 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-02 08:41:42,484 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-02 08:41:45,069 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-02 08:41:47,817 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-02 08:41:50,412 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-02 08:41:52,565 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-02 08:41:54,273 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-02 08:41:55,907 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-02 08:41:58,420 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-02 08:42:01,348 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-02 08:42:04,450 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-02 08:42:07,117 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-02 08:42:11,084 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-02 08:42:14,128 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-02 08:42:15,803 - INFO - 合并后班组合格率数据行数: 315494
2025-12-02 08:42:15,816 - INFO - 开始验证班组合格率数据完整性...
2025-12-02 08:42:15,839 - INFO - 班组合格率数据验证通过: 315494 行记录
2025-12-02 08:42:15,839 - INFO - 开始清洗班组合格率数据...
2025-12-02 08:42:15,919 - INFO - 已用工序编号填充 3700 个缺失的机床设备
2025-12-02 08:42:15,927 - INFO - 已填充 7907 个缺失的产品序号
2025-12-02 08:42:16,015 - WARNING - 发现 7907 个异常检验结果
2025-12-02 08:42:16,206 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 56086 条重复记录
2025-12-02 08:42:16,471 - INFO - 总去重统计: 移除 56086 条重复记录
2025-12-02 08:42:16,472 - INFO - 班组合格率数据清洗完成: 315494 → 259408 行
2025-12-02 08:42:16,494 - INFO - 开始按批次计算真实合格率...
2025-12-02 08:42:16,495 - INFO - 检测到批次级统计数据，直接聚合...
2025-12-02 08:42:18,419 - INFO - 工序级聚合完成: 259408 → 8681 条记录
2025-12-02 08:42:18,428 - WARNING - 过滤掉 1034 条无效工序编号记录
2025-12-02 08:42:22,910 - INFO - 批次级合格率计算完成: 8681 → 1946 条记录
2025-12-02 08:42:22,912 - INFO - 平均批次合格率: 97.11%
2025-12-02 08:42:22,932 - INFO - 开始从SFC批次报工表获取工序加工时间...
2025-12-02 08:42:24,312 - INFO - 成功读取SFC批次报工表: 78334 条记录
2025-12-02 08:42:24,343 - INFO - SFC批次报工表去重后: 76127 条唯一记录
2025-12-02 08:42:24,348 - INFO - 已标准化批次号：移除IPQCK前缀
2025-12-02 08:42:24,357 - INFO - 已标准化工序编号：数字补零到4位（与SFC批次报工表保持一致）
2025-12-02 08:42:24,358 - INFO - 数据标准化效果:
2025-12-02 08:42:24,360 - INFO -   批次号标准化: ['IPQCK25L4343', 'K25L2140', 'K25L2148', 'K25L2147', 'K25G5057'] -> ['25L4343', 'K25L2140', 'K25L2148', 'K25L2147', 'K25G5057']
2025-12-02 08:42:24,367 - INFO -   工序编号标准化: ['10   ', '60   ', '20   ', '30   ', '160  '] -> ['0010', '0060', '0020', '0030', '0160']
2025-12-02 08:42:24,368 - INFO - 班组合格率聚合数据调试信息:
2025-12-02 08:42:24,369 - INFO -   数据形状: (1946, 18)
2025-12-02 08:42:24,369 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-02 08:42:24,370 - INFO -   关键字段存在: 批次号_标准化=True, 工序编号_标准化=True
2025-12-02 08:42:24,371 - INFO -   关键字段样本: 批次号_标准化=25L4343, 工序编号_标准化=0010
2025-12-02 08:42:24,372 - INFO - SFC批次报工表调试信息:
2025-12-02 08:42:24,372 - INFO -   数据形状: (76127, 4)
2025-12-02 08:42:24,373 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-02 08:42:24,374 - INFO -   关键字段样本: BatchNumber=K25J5020, Operation=0190
2025-12-02 08:42:24,374 - INFO - 开始执行合并操作（使用标准化字段）...
2025-12-02 08:42:24,429 - INFO - 合并操作成功完成
2025-12-02 08:42:24,432 - INFO - 已更新工序编号为4位标准化格式
2025-12-02 08:42:24,433 - INFO - 数据增强完成: 1301/1946 条记录匹配到加工时间 (66.9%)
2025-12-02 08:42:24,433 - WARNING - 加工时间匹配率较低 (66.9%)，可能存在数据不一致
2025-12-02 08:42:24,440 - INFO - 开始补充聚合数据的指标字段...
2025-12-02 08:42:24,441 - INFO - 聚合数据指标补充完成
2025-12-02 08:42:24,442 - INFO - 最终数据统计:
2025-12-02 08:42:24,442 - INFO -   总记录数: 1946
2025-12-02 08:42:24,443 - INFO -   班组数: 6
2025-12-02 08:42:24,443 - INFO -   批次数: 1831
2025-12-02 08:42:24,596 - INFO - 已保存Parquet文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet, 行数: 1946
2025-12-02 08:42:25,210 - INFO - 已保存Excel验证文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 1946
2025-12-02 08:42:25,210 - INFO - 班组合格率数据已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet
2025-12-02 08:42:25,587 - INFO - 班组合格率Excel验证文件已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-02 08:42:25,588 - INFO - SFC班组合格率数据处理完成
2025-12-02 08:56:32,312 - INFO - ============================================================
2025-12-02 08:56:32,313 - INFO - 开始处理SFC班组合格率数据
2025-12-02 08:56:32,314 - INFO - ============================================================
2025-12-02 08:56:32,314 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-02 08:56:32,379 - INFO - 找到 283 个班组合格率数据文件，按修改时间排序
2025-12-02 08:56:32,380 - INFO - 🧪 测试模式：仅读取前 120 个最新文件
2025-12-02 08:56:32,380 - INFO -   1. IGPR-20251202080001.xlsx (修改时间: 2025-12-02 08:14:51)
2025-12-02 08:56:32,380 - INFO -   2. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-02 08:56:32,380 - INFO -   3. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-02 08:56:32,380 - INFO -   4. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-02 08:56:32,382 - INFO -   5. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-02 08:56:32,382 - INFO - 读取文件: IGPR-20251202080001.xlsx
2025-12-02 08:56:36,127 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-02 08:56:40,126 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-02 08:56:43,044 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-02 08:56:43,712 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-02 08:56:44,781 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-02 08:56:45,995 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-02 08:56:58,104 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-02 08:57:08,927 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-02 08:57:14,627 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-02 08:57:22,694 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-02 08:57:28,790 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-02 08:57:32,815 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-02 08:57:36,292 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-02 08:57:41,653 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-02 08:57:46,975 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-02 08:57:51,866 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-02 08:57:57,317 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-02 08:58:05,956 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-02 08:58:10,894 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-02 08:58:14,210 - INFO - 读取文件: IGPR-20251117080001.xlsx
2025-12-02 08:58:17,563 - INFO - 读取文件: IGPR-20251113200001.xlsx
2025-12-02 08:58:26,171 - INFO - 读取文件: IGPR-20251112200001.xlsx
2025-12-02 08:58:29,859 - INFO - 读取文件: IGPR-20251111200001.xlsx
2025-12-02 08:58:38,164 - INFO - 读取文件: IGPR-20251110200001.xlsx
2025-12-02 08:58:44,534 - INFO - 读取文件: IGPR-20251107200001.xlsx
2025-12-02 08:58:52,396 - INFO - 读取文件: IGPR-20251108200001.xlsx
2025-12-02 08:58:59,797 - INFO - 读取文件: IGPR-20251109200001.xlsx
2025-12-02 08:59:05,129 - INFO - 读取文件: IGPR-20251106200001.xlsx
2025-12-02 08:59:13,954 - INFO - 读取文件: IGPR-20251105200001.xlsx
2025-12-02 08:59:23,479 - INFO - 读取文件: IGPR-20251104200001.xlsx
2025-12-02 08:59:31,664 - INFO - 读取文件: IGPR-20251103200001.xlsx
2025-12-02 08:59:38,124 - INFO - 读取文件: IGPR-20251031200001.xlsx
2025-12-02 08:59:47,664 - INFO - 读取文件: IGPR-20251101200001.xlsx
2025-12-02 08:59:54,765 - INFO - 读取文件: IGPR-20251102200001.xlsx
2025-12-02 08:59:59,718 - INFO - 读取文件: IGPR-20251031080001.xlsx
2025-12-02 09:00:05,387 - INFO - 读取文件: IGPR-20251029200001.xlsx
2025-12-02 09:00:14,323 - INFO - 读取文件: IGPR-20251028200001.xlsx
2025-12-02 09:00:22,120 - INFO - 读取文件: IGPR-20251027200001.xlsx
2025-12-02 09:00:27,347 - INFO - 读取文件: IGPR-20251024200001.xlsx
2025-12-02 09:00:35,624 - INFO - 读取文件: IGPR-20251025200001.xlsx
2025-12-02 09:00:41,810 - INFO - 读取文件: IGPR-20251026200001.xlsx
2025-12-02 09:00:45,442 - INFO - 读取文件: IGPR-20251023080001.xlsx
2025-12-02 09:00:50,373 - INFO - 读取文件: IGPR-20251023200001.xlsx
2025-12-02 09:00:58,871 - INFO - 读取文件: IGPR-20251021200001.xlsx
2025-12-02 09:01:01,574 - INFO - 读取文件: IGPR-20251020200001.xlsx
2025-12-02 09:01:03,710 - INFO - 读取文件: IGPR-20251018080001.xlsx
2025-12-02 09:01:06,583 - INFO - 读取文件: IGPR-20251019080001.xlsx
2025-12-02 09:01:07,754 - INFO - 读取文件: IGPR-20251020080001.xlsx
2025-12-02 09:01:09,182 - INFO - 读取文件: IGPR-20251017080001.xlsx
2025-12-02 09:01:11,760 - INFO - 读取文件: IGPR-20251016080001.xlsx
2025-12-02 09:01:14,451 - INFO - 读取文件: IGPR-20251014080001.xlsx
2025-12-02 09:01:18,888 - INFO - 读取文件: IGPR-20251015080001.xlsx
2025-12-02 09:01:21,613 - INFO - 读取文件: IGPR-20251009080001.xlsx
2025-12-02 09:01:23,143 - INFO - 读取文件: IGPR-20251001080001.xlsx
2025-12-02 09:01:25,844 - INFO - 读取文件: IGPR-20251007080001.xlsx
2025-12-02 09:01:25,871 - INFO - 读取文件: IGPR-20251008080001.xlsx
2025-12-02 09:01:26,340 - INFO - 读取文件: IGPR-20250930080001.xlsx
2025-12-02 09:01:29,275 - INFO - 读取文件: IGPR-20250929080001.xlsx
2025-12-02 09:01:32,829 - INFO - 读取文件: IGPR-20250927080001.xlsx
2025-12-02 09:01:36,437 - INFO - 读取文件: IGPR-20250928080001.xlsx
2025-12-02 09:01:38,191 - INFO - 读取文件: IGPR-20250926080001.xlsx
2025-12-02 09:01:41,129 - INFO - 读取文件: IGPR-20250925080001.xlsx
2025-12-02 09:01:44,311 - INFO - 读取文件: IGPR-20250924080001.xlsx
2025-12-02 09:01:47,365 - INFO - 读取文件: IGPR-20250923080001.xlsx
2025-12-02 09:01:50,560 - INFO - 读取文件: IGPR-20250920080001.xlsx
2025-12-02 09:01:53,933 - INFO - 读取文件: IGPR-20250921080001.xlsx
2025-12-02 09:01:54,957 - INFO - 读取文件: IGPR-20250922080001.xlsx
2025-12-02 09:01:55,291 - INFO - 读取文件: IGPR-20250919080001.xlsx
2025-12-02 09:01:58,758 - INFO - 读取文件: IGPR-20250918080001.xlsx
2025-12-02 09:02:02,599 - INFO - 读取文件: IGPR-20250917080001.xlsx
2025-12-02 09:02:05,467 - INFO - 读取文件: IGPR-20250916080001.xlsx
2025-12-02 09:02:08,446 - INFO - 读取文件: IGPR-20250913080001.xlsx
2025-12-02 09:02:11,644 - INFO - 读取文件: IGPR-20250914080001.xlsx
2025-12-02 09:02:11,927 - INFO - 读取文件: IGPR-20250915080001.xlsx
2025-12-02 09:02:12,438 - INFO - 读取文件: IGPR-20250912080001.xlsx
2025-12-02 09:02:15,601 - INFO - 读取文件: IGPR-20250911080001.xlsx
2025-12-02 09:02:18,853 - INFO - 读取文件: IGPR-20250910080001.xlsx
2025-12-02 09:02:22,285 - INFO - 读取文件: IGPR-20250908080001.xlsx
2025-12-02 09:02:22,600 - INFO - 读取文件: IGPR-20250909080001.xlsx
2025-12-02 09:02:25,703 - INFO - 读取文件: IGPR-20250906080001.xlsx
2025-12-02 09:02:30,522 - INFO - 读取文件: IGPR-20250905080001.xlsx
2025-12-02 09:02:35,872 - INFO - 读取文件: IGPR-20250904080001.xlsx
2025-12-02 09:02:40,516 - INFO - 读取文件: IGPR-20250903080001.xlsx
2025-12-02 09:02:45,312 - INFO - 读取文件: IGPR-20250902080001.xlsx
2025-12-02 09:02:50,003 - INFO - 读取文件: IGPR-20250829080001.xlsx
2025-12-02 09:02:54,093 - INFO - 读取文件: IGPR-20250830080001.xlsx
2025-12-02 09:02:58,084 - INFO - 读取文件: IGPR-20250831080001.xlsx
2025-12-02 09:02:58,517 - INFO - 读取文件: IGPR-20250901080001.xlsx
2025-12-02 09:02:58,826 - INFO - 读取文件: IGPR-20250827080001.xlsx
2025-12-02 09:03:03,858 - INFO - 读取文件: IGPR-20250828080001.xlsx
2025-12-02 09:03:08,127 - INFO - 读取文件: IGPR-20250826080001.xlsx
2025-12-02 09:03:12,640 - INFO - 读取文件: IGPR-20250823080001.xlsx
2025-12-02 09:03:17,298 - INFO - 读取文件: IGPR-20250824080001.xlsx
2025-12-02 09:03:17,799 - INFO - 读取文件: IGPR-20250825080001.xlsx
2025-12-02 09:03:18,270 - INFO - 读取文件: IGPR-20250822080001.xlsx
2025-12-02 09:03:23,782 - INFO - 读取文件: IGPR-20250821080001.xlsx
2025-12-02 09:03:28,349 - INFO - 读取文件: IGPR-20250820080001.xlsx
2025-12-02 09:03:32,474 - INFO - 读取文件: IGPR-20250819080001.xlsx
2025-12-02 09:03:36,498 - INFO - 读取文件: IGPR-20250815080001.xlsx
2025-12-02 09:03:40,891 - INFO - 读取文件: IGPR-20250816080001.xlsx
2025-12-02 09:03:45,133 - INFO - 读取文件: IGPR-20250817080001.xlsx
2025-12-02 09:03:45,515 - INFO - 读取文件: IGPR-20250818080001.xlsx
2025-12-02 09:03:45,893 - INFO - 读取文件: IGPR-20250814080001.xlsx
2025-12-02 09:03:50,335 - INFO - 读取文件: IGPR-20250813080001.xlsx
2025-12-02 09:03:54,760 - INFO - 读取文件: IGPR-20250812080001.xlsx
2025-12-02 09:03:59,095 - INFO - 读取文件: IGPR-20250810080001.xlsx
2025-12-02 09:03:59,545 - INFO - 读取文件: IGPR-20250811080001.xlsx
2025-12-02 09:04:00,020 - INFO - 读取文件: IGPR-20250809080001.xlsx
2025-12-02 09:04:05,457 - INFO - 读取文件: IGPR-20250808080001.xlsx
2025-12-02 09:04:09,790 - INFO - 读取文件: IGPR-20250807080001.xlsx
2025-12-02 09:04:14,604 - INFO - 读取文件: IGPR-20250806080001.xlsx
2025-12-02 09:04:19,002 - INFO - 读取文件: IGPR-20250805080001.xlsx
2025-12-02 09:04:23,337 - INFO - 读取文件: IGPR-20250802080001.xlsx
2025-12-02 09:04:27,435 - INFO - 读取文件: IGPR-20250804080001.xlsx
2025-12-02 09:04:27,886 - INFO - 读取文件: IGPR-20250801080001.xlsx
2025-12-02 09:04:34,162 - INFO - 读取文件: IGPR-20250731080001.xlsx
2025-12-02 09:04:36,685 - INFO - 读取文件: IGPR-20250730080001.xlsx
2025-12-02 09:04:41,238 - INFO - 读取文件: IGPR-20250725080001.xlsx
2025-12-02 09:04:45,500 - INFO - 读取文件: IGPR-20250726080001.xlsx
2025-12-02 09:04:50,500 - INFO - 合并后班组合格率数据行数: 1627163
2025-12-02 09:04:50,598 - INFO - 开始验证班组合格率数据完整性...
2025-12-02 09:04:50,902 - INFO - 班组合格率数据验证通过: 1627163 行记录
2025-12-02 09:04:50,903 - INFO - 开始清洗班组合格率数据...
2025-12-02 09:04:51,608 - INFO - 已用工序编号填充 22923 个缺失的机床设备
2025-12-02 09:04:51,785 - INFO - 已填充 48263 个缺失的产品序号
2025-12-02 09:04:52,705 - WARNING - 发现 48263 个异常检验结果
2025-12-02 09:04:54,385 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 302045 条重复记录
2025-12-02 09:04:56,990 - INFO - 总去重统计: 移除 302045 条重复记录
2025-12-02 09:04:56,992 - INFO - 班组合格率数据清洗完成: 1627163 → 1325118 行
2025-12-02 09:04:57,159 - INFO - 开始按批次计算真实合格率...
2025-12-02 09:04:57,160 - INFO - 检测到批次级统计数据，直接聚合...
2025-12-02 09:05:21,944 - INFO - 工序级聚合完成: 1325118 → 51372 条记录
2025-12-02 09:05:22,022 - WARNING - 过滤掉 6543 条无效工序编号记录
2025-12-02 09:05:58,901 - INFO - 批次级合格率计算完成: 51372 → 7967 条记录
2025-12-02 09:05:58,904 - INFO - 平均批次合格率: 0.9719 (百分比格式)
2025-12-02 09:05:59,061 - INFO - 开始从SFC批次报工表获取工序加工时间...
2025-12-02 09:05:59,831 - INFO - 成功读取SFC批次报工表: 78334 条记录
2025-12-02 09:05:59,883 - INFO - SFC批次报工表去重后: 76127 条唯一记录
2025-12-02 09:05:59,899 - INFO - 已标准化批次号：移除IPQCK前缀
2025-12-02 09:05:59,921 - INFO - 已标准化工序编号：数字补零到4位（与SFC批次报工表保持一致）
2025-12-02 09:05:59,923 - INFO - 数据标准化效果:
2025-12-02 09:05:59,935 - INFO -   批次号标准化: ['IPQCK25L4343', 'K25B5062', 'K25B5064', 'K25B5066', 'K25B5067'] -> ['25L4343', 'K25B5062', 'K25B5064', 'K25B5066', 'K25B5067']
2025-12-02 09:05:59,945 - INFO -   工序编号标准化: ['10   ', '180  ', '190  ', '160  ', '120  '] -> ['0010', '0180', '0190', '0160', '0120']
2025-12-02 09:05:59,946 - INFO - 班组合格率聚合数据调试信息:
2025-12-02 09:05:59,947 - INFO -   数据形状: (7967, 15)
2025-12-02 09:05:59,948 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-02 09:05:59,950 - INFO -   关键字段存在: 批次号_标准化=True, 工序编号_标准化=True
2025-12-02 09:05:59,951 - INFO -   关键字段样本: 批次号_标准化=25L4343, 工序编号_标准化=0010
2025-12-02 09:05:59,952 - INFO - SFC批次报工表调试信息:
2025-12-02 09:05:59,953 - INFO -   数据形状: (76127, 4)
2025-12-02 09:05:59,954 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-02 09:05:59,955 - INFO -   关键字段样本: BatchNumber=K25J5020, Operation=0190
2025-12-02 09:05:59,957 - INFO - 开始执行合并操作（使用标准化字段）...
2025-12-02 09:06:00,041 - INFO - 合并操作成功完成
2025-12-02 09:06:00,063 - INFO - 已更新工序编号为4位标准化格式
2025-12-02 09:06:00,065 - INFO - 数据增强完成: 7320/7967 条记录匹配到加工时间 (91.9%)
2025-12-02 09:06:00,078 - INFO - 开始补充聚合数据的指标字段...
2025-12-02 09:06:00,085 - INFO - 聚合数据指标补充完成
2025-12-02 09:06:00,086 - INFO - 最终数据统计:
2025-12-02 09:06:00,086 - INFO -   总记录数: 7967
2025-12-02 09:06:00,087 - INFO -   班组数: 6
2025-12-02 09:06:00,093 - INFO -   批次数: 7807
2025-12-02 09:06:00,501 - INFO - 已保存Parquet文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet, 行数: 7967
2025-12-02 09:06:04,997 - INFO - 已保存Excel验证文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 7967
2025-12-02 09:06:04,998 - INFO - 班组合格率数据已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet
2025-12-02 09:06:05,786 - INFO - 班组合格率Excel验证文件已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-02 09:06:05,787 - INFO - SFC班组合格率数据处理完成
2025-12-02 09:39:52,614 - INFO - ============================================================
2025-12-02 09:39:52,621 - INFO - 开始处理SFC班组合格率数据
2025-12-02 09:39:52,622 - INFO - ============================================================
2025-12-02 09:39:52,623 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-02 09:39:52,722 - INFO - 找到 283 个班组合格率数据文件，按修改时间排序
2025-12-02 09:39:52,723 - INFO - 🧪 测试模式：仅读取前 120 个最新文件
2025-12-02 09:39:52,724 - INFO -   1. IGPR-20251202080001.xlsx (修改时间: 2025-12-02 08:14:51)
2025-12-02 09:39:52,725 - INFO -   2. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-02 09:39:52,726 - INFO -   3. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-02 09:39:52,726 - INFO -   4. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-02 09:39:52,727 - INFO -   5. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-02 09:39:52,728 - INFO - 读取文件: IGPR-20251202080001.xlsx
2025-12-02 09:39:59,228 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-02 09:41:57,991 - INFO - ============================================================
2025-12-02 09:41:57,993 - INFO - 开始处理SFC班组合格率数据
2025-12-02 09:41:57,994 - INFO - ============================================================
2025-12-02 09:41:57,994 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-02 09:41:58,012 - INFO - 找到 283 个班组合格率数据文件，按修改时间排序
2025-12-02 09:41:58,014 - INFO - 🧪 测试模式：仅读取前 20 个最新文件
2025-12-02 09:41:58,014 - INFO -   1. IGPR-20251202080001.xlsx (修改时间: 2025-12-02 08:14:51)
2025-12-02 09:41:58,015 - INFO -   2. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-02 09:41:58,016 - INFO -   3. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-02 09:41:58,018 - INFO -   4. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-02 09:41:58,019 - INFO -   5. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-02 09:41:58,020 - INFO - 读取文件: IGPR-20251202080001.xlsx
2025-12-02 09:42:04,270 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-02 09:42:13,076 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-02 09:42:18,955 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-02 09:42:20,241 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-02 09:42:22,166 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-02 09:42:23,689 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-02 09:42:29,267 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-02 09:42:34,902 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-02 09:42:40,937 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-02 09:42:46,880 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-02 09:42:51,730 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-02 09:42:55,037 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-02 09:42:58,664 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-02 09:43:04,289 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-02 09:43:09,962 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-02 09:43:15,220 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-02 09:43:21,068 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-02 09:43:29,868 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-02 09:43:35,326 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-02 09:43:38,773 - INFO - 合并后班组合格率数据行数: 315494
2025-12-02 09:43:38,797 - INFO - 开始验证班组合格率数据完整性...
2025-12-02 09:43:38,855 - INFO - 班组合格率数据验证通过: 315494 行记录
2025-12-02 09:43:38,856 - INFO - 开始清洗班组合格率数据...
2025-12-02 09:43:39,027 - INFO - 已用工序编号填充 3700 个缺失的机床设备
2025-12-02 09:43:39,084 - INFO - 已填充 7907 个缺失的产品序号
2025-12-02 09:43:39,282 - WARNING - 发现 7907 个异常检验结果
2025-12-02 09:43:39,618 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 56086 条重复记录
2025-12-02 09:43:40,149 - INFO - 总去重统计: 移除 56086 条重复记录
2025-12-02 09:43:40,149 - INFO - 班组合格率数据清洗完成: 315494 → 259408 行
2025-12-02 09:43:40,184 - INFO - 开始按批次计算真实合格率...
2025-12-02 09:43:40,185 - INFO - 检测到批次级统计数据，直接聚合...
2025-12-02 09:43:44,370 - INFO - 工序级聚合完成: 259408 → 8681 条记录
2025-12-02 09:43:44,385 - WARNING - 过滤掉 1034 条无效工序编号记录
2025-12-02 09:43:53,302 - INFO - 批次级合格率计算完成: 8681 → 1946 条记录
2025-12-02 09:43:53,303 - INFO - 平均批次合格率: 0.9711 (百分比格式)
2025-12-02 09:43:53,334 - INFO - 开始从SFC批次报工表获取工序加工时间...
2025-12-02 09:43:54,058 - INFO - 成功读取SFC批次报工表: 78750 条记录
2025-12-02 09:43:54,119 - INFO - SFC批次报工表去重后: 76535 条唯一记录
2025-12-02 09:43:54,125 - INFO - 已标准化批次号：移除IPQCK前缀
2025-12-02 09:43:54,134 - INFO - 已标准化工序编号：数字补零到4位（与SFC批次报工表保持一致）
2025-12-02 09:43:54,135 - INFO - 数据标准化效果:
2025-12-02 09:43:54,137 - INFO -   批次号标准化: ['IPQCK25L4343', 'K25G5057', 'K25G5058', 'K25G5059', 'K25H2228'] -> ['25L4343', 'K25G5057', 'K25G5058', 'K25G5059', 'K25H2228']
2025-12-02 09:43:54,139 - INFO -   工序编号标准化: ['10   ', '160  ', '120  ', '210  ', 210] -> ['0010', '0160', '0120', '0210', '0130']
2025-12-02 09:43:54,139 - INFO - 班组合格率聚合数据调试信息:
2025-12-02 09:43:54,140 - INFO -   数据形状: (1946, 15)
2025-12-02 09:43:54,140 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-02 09:43:54,141 - INFO -   关键字段存在: 批次号_标准化=True, 工序编号_标准化=True
2025-12-02 09:43:54,142 - INFO -   关键字段样本: 批次号_标准化=25L4343, 工序编号_标准化=0010
2025-12-02 09:43:54,142 - INFO - SFC批次报工表调试信息:
2025-12-02 09:43:54,143 - INFO -   数据形状: (76535, 4)
2025-12-02 09:43:54,143 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-02 09:43:54,144 - INFO -   关键字段样本: BatchNumber=K25L5052, Operation=0040
2025-12-02 09:43:54,144 - INFO - 开始执行合并操作（使用标准化字段）...
2025-12-02 09:43:54,196 - INFO - 合并操作成功完成
2025-12-02 09:43:54,200 - INFO - 已更新工序编号为4位标准化格式
2025-12-02 09:43:54,202 - INFO - 数据增强完成: 1507/1946 条记录匹配到加工时间 (77.4%)
2025-12-02 09:43:54,202 - WARNING - 加工时间匹配率较低 (77.4%)，可能存在数据不一致
2025-12-02 09:43:54,212 - INFO - 开始补充聚合数据的指标字段...
2025-12-02 09:43:54,215 - INFO - 聚合数据指标补充完成
2025-12-02 09:43:54,216 - INFO - 最终数据统计:
2025-12-02 09:43:54,216 - INFO -   总记录数: 1946
2025-12-02 09:43:54,217 - INFO -   班组数: 6
2025-12-02 09:43:54,219 - INFO -   批次数: 1831
2025-12-02 09:43:54,356 - INFO - 已保存Parquet文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet, 行数: 1946
2025-12-02 09:43:55,379 - INFO - 已保存Excel验证文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 1946
2025-12-02 09:43:55,380 - INFO - 班组合格率数据已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet
2025-12-02 09:43:56,115 - INFO - 班组合格率Excel验证文件已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-02 09:43:56,118 - INFO - SFC班组合格率数据处理完成
2025-12-02 13:41:39,816 - INFO - ============================================================
2025-12-02 13:41:39,818 - INFO - 开始处理SFC班组合格率数据
2025-12-02 13:41:39,820 - INFO - ============================================================
2025-12-02 13:41:39,821 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-02 13:41:39,848 - INFO - 找到 283 个班组合格率数据文件，按修改时间排序
2025-12-02 13:41:39,849 - INFO - 🧪 测试模式：仅读取前 20 个最新文件
2025-12-02 13:41:39,850 - INFO -   1. IGPR-20251202080001.xlsx (修改时间: 2025-12-02 13:09:56.616330)
2025-12-02 13:41:39,853 - INFO -   2. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-02 13:41:39,854 - INFO -   3. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-02 13:41:39,855 - INFO -   4. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-02 13:41:39,856 - INFO -   5. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-02 13:41:39,857 - INFO - 读取文件: IGPR-20251202080001.xlsx
2025-12-02 13:41:41,023 - WARNING - Excel文件被占用，等待后重试: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251202080001.xlsx
2025-12-02 13:41:41,033 - INFO - 重试读取Excel文件 (第2次): C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251202080001.xlsx
2025-12-02 13:41:43,036 - WARNING - Excel文件被占用，等待后重试: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251202080001.xlsx
2025-12-02 13:41:46,040 - INFO - 重试读取Excel文件 (第3次): C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251202080001.xlsx
2025-12-02 13:41:50,044 - ERROR - Excel文件被其他程序占用: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251202080001.xlsx
2025-12-02 13:41:50,045 - ERROR - 请关闭正在使用该文件的程序（如Excel）
2025-12-02 13:41:50,045 - WARNING - 读取文件失败 C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251202080001.xlsx: 文件被占用，请关闭Excel或其他程序: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251202080001.xlsx
2025-12-02 13:41:50,046 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-02 13:41:58,384 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-02 13:42:03,993 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-02 13:42:05,457 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-02 13:42:07,720 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-02 13:42:09,660 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-02 13:42:14,898 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-02 13:42:20,671 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-02 13:42:26,464 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-02 13:42:32,089 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-02 13:42:36,606 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-02 13:42:40,237 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-02 13:42:43,926 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-02 13:42:49,276 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-02 13:42:54,826 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-02 13:43:00,789 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-02 13:43:06,821 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-02 13:43:14,797 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-02 13:43:20,018 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-02 13:43:23,464 - INFO - 合并后班组合格率数据行数: 299254
2025-12-02 13:43:23,484 - INFO - 开始验证班组合格率数据完整性...
2025-12-02 13:43:23,528 - INFO - 班组合格率数据验证通过: 299254 行记录
2025-12-02 13:43:23,529 - INFO - 开始清洗班组合格率数据...
2025-12-02 13:43:23,659 - INFO - 已用工序编号填充 3458 个缺失的机床设备
2025-12-02 13:43:23,697 - INFO - 已填充 7403 个缺失的产品序号
2025-12-02 13:43:23,868 - WARNING - 发现 7403 个异常检验结果
2025-12-02 13:43:24,196 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 55368 条重复记录
2025-12-02 13:43:24,677 - INFO - 总去重统计: 移除 55368 条重复记录
2025-12-02 13:43:24,679 - INFO - 班组合格率数据清洗完成: 299254 → 243886 行
2025-12-02 13:43:24,712 - INFO - 开始按批次计算真实合格率...
2025-12-02 13:43:24,714 - INFO - 检测到批次级统计数据，直接聚合...
2025-12-02 13:43:28,339 - INFO - 工序级聚合完成: 243886 → 8048 条记录
2025-12-02 13:43:28,355 - WARNING - 过滤掉 954 条无效工序编号记录
2025-12-02 13:43:35,654 - INFO - 批次级合格率计算完成: 8048 → 1838 条记录
2025-12-02 13:43:35,655 - INFO - 平均批次合格率: 0.9732 (百分比格式)
2025-12-02 13:43:35,677 - INFO - 开始从SFC批次报工表获取工序加工时间...
2025-12-02 13:43:35,994 - INFO - 成功读取SFC批次报工表: 78750 条记录
2025-12-02 13:43:36,057 - INFO - SFC批次报工表去重后: 76535 条唯一记录
2025-12-02 13:43:36,063 - INFO - 已标准化批次号：移除IPQCK前缀
2025-12-02 13:43:36,072 - INFO - 已标准化工序编号：数字补零到4位（与SFC批次报工表保持一致）
2025-12-02 13:43:36,073 - INFO - 数据标准化效果:
2025-12-02 13:43:36,077 - INFO -   批次号标准化: ['IPQCK25L4343', 'K25G5057', 'K25G5058', 'K25G5059', 'K25H2228'] -> ['25L4343', 'K25G5057', 'K25G5058', 'K25G5059', 'K25H2228']
2025-12-02 13:43:36,082 - INFO -   工序编号标准化: ['10   ', '160  ', '120  ', '210  ', 210] -> ['0010', '0160', '0120', '0210', '0130']
2025-12-02 13:43:36,082 - INFO - 班组合格率聚合数据调试信息:
2025-12-02 13:43:36,083 - INFO -   数据形状: (1838, 16)
2025-12-02 13:43:36,084 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-02 13:43:36,084 - INFO -   关键字段存在: 批次号_标准化=True, 工序编号_标准化=True
2025-12-02 13:43:36,085 - INFO -   关键字段样本: 批次号_标准化=25L4343, 工序编号_标准化=0010
2025-12-02 13:43:36,085 - INFO - SFC批次报工表调试信息:
2025-12-02 13:43:36,086 - INFO -   数据形状: (76535, 4)
2025-12-02 13:43:36,086 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-02 13:43:36,086 - INFO -   关键字段样本: BatchNumber=K25L5052, Operation=0040
2025-12-02 13:43:36,087 - INFO - 开始执行合并操作（使用标准化字段）...
2025-12-02 13:43:36,143 - INFO - 合并操作成功完成
2025-12-02 13:43:36,149 - INFO - 已更新工序编号为4位标准化格式
2025-12-02 13:43:36,150 - INFO - 数据增强完成: 1636/1838 条记录匹配到加工时间 (89.0%)
2025-12-02 13:43:36,165 - INFO - 开始补充聚合数据的指标字段...
2025-12-02 13:43:36,168 - INFO - 聚合数据指标补充完成
2025-12-02 13:43:36,168 - INFO - 最终数据统计:
2025-12-02 13:43:36,169 - INFO -   总记录数: 1838
2025-12-02 13:43:36,170 - INFO -   班组数: 6
2025-12-02 13:43:36,170 - INFO -   批次数: 1741
2025-12-02 13:43:36,314 - INFO - 已保存Parquet文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet, 行数: 1838
2025-12-02 13:43:37,339 - INFO - 已保存Excel验证文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 1838
2025-12-02 13:43:37,340 - INFO - 班组合格率数据已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet
2025-12-02 13:43:37,924 - INFO - 班组合格率Excel验证文件已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-02 13:43:37,925 - INFO - SFC班组合格率数据处理完成
2025-12-02 13:45:36,606 - INFO - ============================================================
2025-12-02 13:45:36,608 - INFO - 开始处理SFC班组合格率数据
2025-12-02 13:45:36,609 - INFO - ============================================================
2025-12-02 13:45:36,610 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-02 13:45:36,618 - INFO - 找到 283 个班组合格率数据文件，按修改时间排序
2025-12-02 13:45:36,619 - INFO - 🧪 测试模式：仅读取前 20 个最新文件
2025-12-02 13:45:36,620 - INFO -   1. IGPR-20251202080001.xlsx (修改时间: 2025-12-02 13:09:56.616330)
2025-12-02 13:45:36,621 - INFO -   2. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-02 13:45:36,624 - INFO -   3. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-02 13:45:36,625 - INFO -   4. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-02 13:45:36,626 - INFO -   5. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-02 13:45:36,627 - INFO - 读取文件: IGPR-20251202080001.xlsx
2025-12-02 13:45:37,083 - WARNING - Excel文件被占用，等待后重试: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251202080001.xlsx
2025-12-02 13:45:37,084 - INFO - 重试读取Excel文件 (第2次): C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251202080001.xlsx
2025-12-02 13:45:39,085 - WARNING - Excel文件被占用，等待后重试: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251202080001.xlsx
2025-12-02 13:45:42,087 - INFO - 重试读取Excel文件 (第3次): C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251202080001.xlsx
2025-12-02 13:45:46,089 - ERROR - Excel文件被其他程序占用: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251202080001.xlsx
2025-12-02 13:45:46,090 - ERROR - 请关闭正在使用该文件的程序（如Excel）
2025-12-02 13:45:46,091 - WARNING - 读取文件失败 C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251202080001.xlsx: 文件被占用，请关闭Excel或其他程序: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据\IGPR-20251202080001.xlsx
2025-12-02 13:45:46,092 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-02 13:45:53,704 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-02 13:46:04,995 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-02 13:46:07,602 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-02 13:46:11,022 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-02 13:46:13,866 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-02 13:46:23,685 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-02 13:46:34,964 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-02 13:46:43,504 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-02 13:46:48,577 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-02 13:46:53,095 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-02 13:46:56,131 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-02 13:46:59,225 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-02 13:47:03,393 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-02 13:47:08,848 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-02 13:47:14,886 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-02 13:47:20,400 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-02 13:47:28,589 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-02 13:47:33,791 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-02 13:47:37,098 - INFO - 合并后班组合格率数据行数: 299254
2025-12-02 13:47:37,115 - INFO - 开始验证班组合格率数据完整性...
2025-12-02 13:47:37,162 - INFO - 班组合格率数据验证通过: 299254 行记录
2025-12-02 13:47:37,163 - INFO - 开始清洗班组合格率数据...
2025-12-02 13:47:37,271 - INFO - 已用工序编号填充 3458 个缺失的机床设备
2025-12-02 13:47:37,282 - INFO - 已填充 7403 个缺失的产品序号
2025-12-02 13:47:37,439 - WARNING - 发现 7403 个异常检验结果
2025-12-02 13:47:37,713 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 55368 条重复记录
2025-12-02 13:47:38,132 - INFO - 总去重统计: 移除 55368 条重复记录
2025-12-02 13:47:38,133 - INFO - 班组合格率数据清洗完成: 299254 → 243886 行
2025-12-02 13:47:38,161 - INFO - 开始按批次计算真实合格率...
2025-12-02 13:47:38,162 - INFO - 检测到批次级统计数据，直接聚合...
2025-12-02 13:47:41,847 - INFO - 工序级聚合完成: 243886 → 8048 条记录
2025-12-02 13:47:41,863 - WARNING - 过滤掉 954 条无效工序编号记录
2025-12-02 13:47:49,687 - INFO - 批次级合格率计算完成: 8048 → 1838 条记录
2025-12-02 13:47:49,690 - INFO - 平均批次合格率: 0.9732 (百分比格式)
2025-12-02 13:47:49,726 - INFO - 开始从SFC批次报工表获取工序加工时间...
2025-12-02 13:47:50,071 - INFO - 成功读取SFC批次报工表: 78750 条记录
2025-12-02 13:47:50,122 - INFO - SFC批次报工表去重后: 76535 条唯一记录
2025-12-02 13:47:50,127 - INFO - 已标准化批次号：移除IPQCK前缀
2025-12-02 13:47:50,134 - INFO - 已标准化工序编号：数字补零到4位（与SFC批次报工表保持一致）
2025-12-02 13:47:50,135 - INFO - 数据标准化效果:
2025-12-02 13:47:50,139 - INFO -   批次号标准化: ['IPQCK25L4343', 'K25G5057', 'K25G5058', 'K25G5059', 'K25H2228'] -> ['25L4343', 'K25G5057', 'K25G5058', 'K25G5059', 'K25H2228']
2025-12-02 13:47:50,140 - INFO -   工序编号标准化: ['10   ', '160  ', '120  ', '210  ', 210] -> ['0010', '0160', '0120', '0210', '0130']
2025-12-02 13:47:50,141 - INFO - 班组合格率聚合数据调试信息:
2025-12-02 13:47:50,142 - INFO -   数据形状: (1838, 16)
2025-12-02 13:47:50,142 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-02 13:47:50,143 - INFO -   关键字段存在: 批次号_标准化=True, 工序编号_标准化=True
2025-12-02 13:47:50,143 - INFO -   关键字段样本: 批次号_标准化=25L4343, 工序编号_标准化=0010
2025-12-02 13:47:50,144 - INFO - SFC批次报工表调试信息:
2025-12-02 13:47:50,144 - INFO -   数据形状: (76535, 4)
2025-12-02 13:47:50,144 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-02 13:47:50,145 - INFO -   关键字段样本: BatchNumber=K25L5052, Operation=0040
2025-12-02 13:47:50,147 - INFO - 开始执行合并操作（使用标准化字段）...
2025-12-02 13:47:50,183 - INFO - 合并操作成功完成
2025-12-02 13:47:50,189 - INFO - 已更新工序编号为4位标准化格式
2025-12-02 13:47:50,190 - INFO - 数据增强完成: 1636/1838 条记录匹配到加工时间 (89.0%)
2025-12-02 13:47:50,200 - INFO - 开始补充聚合数据的指标字段...
2025-12-02 13:47:50,204 - INFO - 聚合数据指标补充完成
2025-12-02 13:47:50,204 - INFO - 开始最终去重处理...
2025-12-02 13:47:50,209 - INFO - 最终去重完成: 移除 5 条重复记录
2025-12-02 13:47:50,210 - INFO - 最终数据统计:
2025-12-02 13:47:50,211 - INFO -   总记录数: 1833
2025-12-02 13:47:50,212 - INFO -   班组数: 6
2025-12-02 13:47:50,213 - INFO -   批次数: 1741
2025-12-02 13:47:50,300 - INFO - 已保存Parquet文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet, 行数: 1833
2025-12-02 13:47:51,307 - INFO - 已保存Excel验证文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 1833
2025-12-02 13:47:51,308 - INFO - 班组合格率数据已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet
2025-12-02 13:47:51,805 - INFO - 班组合格率Excel验证文件已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-02 13:47:51,806 - INFO - SFC班组合格率数据处理完成
2025-12-02 13:59:49,851 - INFO - ============================================================
2025-12-02 13:59:49,854 - INFO - 开始处理SFC班组合格率数据
2025-12-02 13:59:49,855 - INFO - ============================================================
2025-12-02 13:59:49,857 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-02 13:59:49,869 - INFO - 找到 283 个班组合格率数据文件，按修改时间排序
2025-12-02 13:59:49,873 - INFO - 🧪 测试模式：仅读取前 20 个最新文件
2025-12-02 13:59:49,875 - INFO -   1. IGPR-20251202080001.xlsx (修改时间: 2025-12-02 13:09:56)
2025-12-02 13:59:49,875 - INFO -   2. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-02 13:59:49,877 - INFO -   3. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-02 13:59:49,878 - INFO -   4. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-02 13:59:49,879 - INFO -   5. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-02 13:59:49,880 - INFO - 读取文件: IGPR-20251202080001.xlsx
2025-12-02 13:59:53,200 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-02 13:59:59,805 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-02 14:00:05,092 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-02 14:00:06,293 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-02 14:00:08,185 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-02 14:00:09,670 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-02 14:00:14,784 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-02 14:00:20,482 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-02 14:00:26,266 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-02 14:00:32,108 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-02 14:00:36,898 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-02 14:00:40,671 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-02 14:00:44,032 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-02 14:00:49,191 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-02 14:00:55,378 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-02 14:01:00,411 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-02 14:01:06,849 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-02 14:01:15,527 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-02 14:01:21,727 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-02 14:01:25,257 - INFO - 合并后班组合格率数据行数: 315494
2025-12-02 14:01:25,278 - INFO - 开始验证班组合格率数据完整性...
2025-12-02 14:01:25,330 - INFO - 班组合格率数据验证通过: 315494 行记录
2025-12-02 14:01:25,330 - INFO - 开始清洗班组合格率数据...
2025-12-02 14:01:25,726 - INFO - 已标准化批次号：移除IPQCK前缀
2025-12-02 14:01:25,752 - INFO - 已用工序编号填充 3700 个缺失的机床设备
2025-12-02 14:01:25,781 - INFO - 已填充 7907 个缺失的产品序号
2025-12-02 14:01:25,993 - WARNING - 发现 7907 个异常检验结果
2025-12-02 14:01:26,357 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 56086 条重复记录
2025-12-02 14:01:26,954 - INFO - 总去重统计: 移除 56086 条重复记录
2025-12-02 14:01:26,955 - INFO - 班组合格率数据清洗完成: 315494 → 259408 行
2025-12-02 14:01:26,987 - INFO - 开始按批次计算真实合格率...
2025-12-02 14:01:26,989 - INFO - 检测到批次级统计数据，直接聚合...
2025-12-02 14:01:31,504 - INFO - 工序级聚合完成: 259408 → 8681 条记录
2025-12-02 14:01:31,526 - WARNING - 过滤掉 1034 条无效工序编号记录
2025-12-02 14:01:40,735 - INFO - 批次级合格率计算完成: 8681 → 1946 条记录
2025-12-02 14:01:40,737 - INFO - 平均批次合格率: 0.9711 (百分比格式)
2025-12-02 14:01:40,768 - INFO - 开始从SFC批次报工表获取工序加工时间...
2025-12-02 14:01:41,328 - INFO - 成功读取SFC批次报工表: 78750 条记录
2025-12-02 14:01:41,385 - INFO - SFC批次报工表去重后: 76535 条唯一记录
2025-12-02 14:01:41,400 - INFO - 已标准化工序编号：数字补零到4位（与SFC批次报工表保持一致）
2025-12-02 14:01:41,401 - INFO - 数据标准化效果:
2025-12-02 14:01:41,405 - INFO -   批次号标准化: ['25L4343', 'K25G5057', 'K25G5058', 'K25G5059', 'K25H2228'] -> ['25L4343', 'K25G5057', 'K25G5058', 'K25G5059', 'K25H2228']
2025-12-02 14:01:41,407 - INFO -   工序编号标准化: ['10   ', '160  ', '120  ', '210  ', 210] -> ['0010', '0160', '0120', '0210', '0130']
2025-12-02 14:01:41,409 - INFO - 班组合格率聚合数据调试信息:
2025-12-02 14:01:41,409 - INFO -   数据形状: (1946, 16)
2025-12-02 14:01:41,410 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-02 14:01:41,411 - INFO -   关键字段存在: 批次号_标准化=True, 工序编号_标准化=True
2025-12-02 14:01:41,412 - INFO -   关键字段样本: 批次号_标准化=25L4343, 工序编号_标准化=0010
2025-12-02 14:01:41,412 - INFO - SFC批次报工表调试信息:
2025-12-02 14:01:41,413 - INFO -   数据形状: (76535, 4)
2025-12-02 14:01:41,413 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-02 14:01:41,414 - INFO -   关键字段样本: BatchNumber=K25L5052, Operation=0040
2025-12-02 14:01:41,415 - INFO - 开始执行合并操作（使用标准化字段）...
2025-12-02 14:01:41,461 - INFO - 合并操作成功完成
2025-12-02 14:01:41,470 - INFO - 已更新工序编号为4位标准化格式
2025-12-02 14:01:41,472 - INFO - 数据增强完成: 1507/1946 条记录匹配到加工时间 (77.4%)
2025-12-02 14:01:41,473 - WARNING - 加工时间匹配率较低 (77.4%)，可能存在数据不一致
2025-12-02 14:01:41,487 - INFO - 开始补充聚合数据的指标字段...
2025-12-02 14:01:41,490 - INFO - 聚合数据指标补充完成
2025-12-02 14:01:41,491 - INFO - 开始最终去重处理...
2025-12-02 14:01:41,496 - INFO - 最终去重完成: 移除 3 条重复记录
2025-12-02 14:01:41,496 - INFO - 最终数据统计:
2025-12-02 14:01:41,497 - INFO -   总记录数: 1943
2025-12-02 14:01:41,499 - INFO -   班组数: 6
2025-12-02 14:01:41,500 - INFO -   批次数: 1831
2025-12-02 14:01:41,609 - INFO - 已保存Parquet文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet, 行数: 1943
2025-12-02 14:01:43,017 - INFO - 已保存Excel验证文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 1943
2025-12-02 14:01:43,018 - INFO - 班组合格率数据已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet
2025-12-02 14:01:43,584 - INFO - 班组合格率Excel验证文件已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-02 14:01:43,586 - INFO - SFC班组合格率数据处理完成
