C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\final_verify_logic.py:23: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df_snap = pd.read_sql(query_snap, conn)
C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\final_verify_logic.py:32: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df_routing = pd.read_sql(query_routing, conn)
C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\final_verify_logic.py:43: UserWarning: pandas only supports SQLAlchemy connectable (engine/connection) or database string URI or sqlite3 DBAPI2 connection. Other DBAPI2 objects are not tested. Please consider using SQLAlchemy.
  df_cal = pd.read_sql(query_cal, conn)
Traceback (most recent call last):
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\sql.py", line 2672, in execute
    cur.execute(sql, *args)
pyodbc.ProgrammingError: ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]列名 'factory_code' 无效。 (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]列名 'date_value' 无效。 (207); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]列名 'date_value' 无效。 (207); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]列名 'date_value' 无效。 (207); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]列名 'is_workday' 无效。 (207); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]列名 'holiday_name' 无效。 (207)")

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\final_verify_logic.py", line 100, in <module>
    calculate_verification()
  File "C:\Users\huangk14\OneDrive - Medtronic PLC\Huangkai Files\B1_Project\250418_MDDAP_project\final_verify_logic.py", line 43, in calculate_verification
    df_cal = pd.read_sql(query_cal, conn)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\sql.py", line 706, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\sql.py", line 2736, in read_query
    cursor = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\huangk14\AppData\Local\Programs\Python\Python312\Lib\site-packages\pandas\io\sql.py", line 2684, in execute
    raise ex from exc
pandas.errors.DatabaseError: Execution failed on sql '
    SELECT date_value, is_workday, holiday_name
    FROM dbo.raw_calendar
    WHERE factory_code = '1303' AND date_value BETWEEN CAST('2025-12-30 14:27:35.956666' AS DATE) AND CAST('2026-01-08 02:23:01.146666' AS DATE)
    ': ('42S22', "[42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]列名 'factory_code' 无效。 (207) (SQLExecDirectW); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]列名 'date_value' 无效。 (207); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]列名 'date_value' 无效。 (207); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]列名 'date_value' 无效。 (207); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]列名 'is_workday' 无效。 (207); [42S22] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]列名 'holiday_name' 无效。 (207)")
