# å¸¸å·å›­åŒºæ•°å­—åŒ–æ•°æ®å¹³å°

## ğŸ“Š é¡¹ç›®ç®€ä»‹

å¸¸å·å›­åŒºæ•°å­—åŒ–æ•°æ®å¹³å°æ˜¯ä¸€ä¸ªé›†æˆåŒ–çš„æ•°æ®å¤„ç†å’Œåˆ†æç³»ç»Ÿï¼Œç”¨äºæ•´åˆMESã€SFCã€SAPç­‰å¤šä¸ªæ•°æ®æºï¼Œä¸ºç”Ÿäº§ã€è´¨é‡ã€è´¢åŠ¡ç­‰ä¸šåŠ¡éƒ¨é—¨æä¾›æ•°æ®æ”¯æŒå’Œåˆ†ææœåŠ¡ã€‚

**é¡¹ç›®çŠ¶æ€ï¼š** âœ… ç”Ÿäº§ç¯å¢ƒè¿è¡Œä¸­  
**æ¶æ„ç‰ˆæœ¬ï¼š** Phase 5 (å¹¶è¡Œç¼–æ’ä¸æ™ºèƒ½éªŒè¯)  
**æœ€åæ›´æ–°ï¼š** 2026å¹´1æœˆ25æ—¥

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### æ ¸å¿ƒæ•°æ®å¿«é€Ÿåˆ·æ–° (æ—¥å¸¸æ¨è)

ä½¿ç”¨å¹¶è¡Œç¼–æ’å™¨è¿›è¡Œä¸€é”®åˆ·æ–°ï¼š

```bash
.\scripts\orchestration\refresh_parallel.bat
```

> **æ³¨æ„**ï¼šé¦–æ¬¡è¿è¡Œæˆ–Tokenè¿‡æœŸæ—¶ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶æç¤ºæ‚¨åœ¨å¼¹å‡ºçš„æµè§ˆå™¨ä¸­ç™»å½•ã€‚

### é¢„è§ˆæ–‡æ¡£

```bash
mkdocs serve
```

è®¿é—®ï¼šhttp://127.0.0.1:8000/

æƒå¨æ–‡æ¡£å…¥å£ï¼š[`docs/README.md`](docs/README.md)

### è¿ç§»æŒ‡å—

å¦‚éœ€å°†é¡¹ç›®è¿ç§»è‡³æ–°è®¾å¤‡ï¼Œè¯·é˜…è¯»ï¼š[`docs/MIGRATION_GUIDE.md`](docs/MIGRATION_GUIDE.md)

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
250418_MDDAP_project/
â”œâ”€â”€ scripts/                    # è„šæœ¬æ ¹ç›®å½•
â”‚   â”œâ”€â”€ orchestration/         # [æ ¸å¿ƒ] ç¼–æ’ä¸æ‰§è¡Œè„šæœ¬ (run_etl_parallel.py)
â”‚   â”œâ”€â”€ maintenance/           # ç»´æŠ¤ä¸æ•°æ®åº“åˆ·æ–°è„šæœ¬
â”‚   â””â”€â”€ archive/               # æ—§è„šæœ¬å½’æ¡£
â”œâ”€â”€ data_pipelines/            # æ•°æ®ç®¡é“
â”‚   â””â”€â”€ sources/               # æ•°æ®æºï¼ˆMES, SFC, SAPï¼‰
â”œâ”€â”€ shared_infrastructure/     # å…±äº«åŸºç¡€è®¾æ–½
â”‚   â”œâ”€â”€ config/               # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ utils/                # å·¥å…·å‡½æ•°
â”‚   â””â”€â”€ logs/                 # æ—¥å¿—æ–‡ä»¶ (è‡ªåŠ¨æ¸…ç†7å¤©å‰æ—¥å¿—)
â”œâ”€â”€ business_domains/          # ä¸šåŠ¡é¢†åŸŸ
â”œâ”€â”€ documentation/             # MkDocsæ–‡æ¡£ç³»ç»Ÿ
â””â”€â”€ docs/                      # é¡¹ç›®æ–‡æ¡£ï¼ˆæƒå¨å…¥å£ï¼‰
```

**è¯¦ç»†è¯´æ˜ï¼š** æŸ¥çœ‹ [`docs/05_reference/tools/é¡¹ç›®ç»“æ„æŒ‡å—.md`](docs/05_reference/tools/é¡¹ç›®ç»“æ„æŒ‡å—.md)

---

## ğŸŒŸ æ ¸å¿ƒåŠŸèƒ½æ¦‚è§ˆ

æœ¬é¡¹ç›®(MDDAP)å®ç°äº†ä»**åŸå§‹æ•°æ®è·å–**åˆ°**æŠ¥è¡¨å±•ç¤º**çš„å…¨é“¾è·¯è‡ªåŠ¨åŒ–ï¼Œä¸»è¦åŒ…å«ä»¥ä¸‹å››å¤§æ¨¡å—ï¼š

### 1. è‡ªåŠ¨åŒ–é‡‡é›† (Data Collection)
*   **æ™ºèƒ½çˆ¬è™«**ï¼šä½¿ç”¨ Headless Browser (Playwright) æ¨¡æ‹Ÿç”¨æˆ·ç™»å½•ï¼Œè‡ªåŠ¨ä» **Microsoft Planner** å’Œ **CMES (Power BI)** ä¸‹è½½æœ€æ–°çš„ç”Ÿäº§æŠ¥è¡¨å’Œä»»åŠ¡æ•°æ®ã€‚
*   **æ™ºèƒ½éªŒè¯**ï¼šå…·å¤‡â€œSmart Authâ€åŠŸèƒ½ï¼Œè‡ªåŠ¨æ£€æµ‹ Token æ˜¯å¦è¿‡æœŸã€‚å¦‚æœè¿‡æœŸï¼Œä¼šå¼¹çª—æç¤ºæ‰‹åŠ¨ç™»å½•ï¼Œå¹³æ—¶åˆ™é™é»˜è¿è¡Œã€‚
*   **SAP é›†æˆ**ï¼šå¤„ç†å’Œæ ¼å¼åŒ– SAP å¯¼å‡ºçš„å·¥æ—¶å’Œè·¯ç”±æ•°æ®ã€‚

### 2. ETL æ•°æ®æ¸…æ´—ä¸å…¥åº“ (ETL Pipeline)
*   **å¤šæºå¼‚æ„æ•´åˆ**ï¼šå°†æ¥è‡ªä¸åŒæ¥æºï¼ˆMES ç³»ç»Ÿã€SFC ç°åœºæ§åˆ¶ã€SAP ERPã€Planner ä»»åŠ¡ï¼‰çš„ Excel/CSV æ•°æ®ç»Ÿä¸€æ¸…æ´—ã€‚
*   **å¢é‡å¤„ç†**ï¼šé€šè¿‡æ–‡ä»¶æŒ‡çº¹ï¼ˆHash/MTimeï¼‰è¯†åˆ«å˜åŒ–ï¼Œåªå¤„ç†æ–°æ–‡ä»¶ï¼Œæå¤§æé«˜äº†æ¯æ—¥è¿è¡Œæ•ˆç‡ã€‚
*   **æ ¸å¿ƒè®¡ç®—**ï¼š
    *   **WIP è®¡ç®—**ï¼šè®¡ç®—äº§çº¿åœ¨åˆ¶å“æ•°é‡ã€‚
    *   **å·¥æ—¶/æ•ˆç‡**ï¼šè®¡ç®— SAP æ ‡å‡†å·¥æ—¶ä¸å®é™…äº§å‡ºçš„å¯¹æ¯”ã€‚
    *   **Calendar/Shift**ï¼šç»Ÿä¸€å¯¹é½å·¥å‚æ—¥å†å’Œç­æ¬¡ã€‚

### 3. æ•°æ®ä»“åº“ä¸æŒ‡æ ‡è®¡ç®— (Data Warehousing)
*   **SQL Server å­˜å‚¨**ï¼šæ‰€æœ‰æ¸…æ´—åçš„æ•°æ®å­˜å…¥ SQL Server (`mddap_v2`)ã€‚
*   **ç‰©åŒ–è§†å›¾ (Materialized Views)**ï¼šé’ˆå¯¹å¤æ‚çš„ MES æŒ‡æ ‡ï¼ˆå¦‚äº§é‡ã€ä¸€æ¬¡åˆæ ¼ç‡ã€OEEï¼‰ï¼Œé¢„å…ˆè®¡ç®—å¹¶å­˜å‚¨å¿«ç…§ï¼ˆSnapshotsï¼‰ï¼Œè§£å†³å®æ—¶æŸ¥è¯¢æ…¢çš„é—®é¢˜ã€‚
*   **ä¸šåŠ¡é¢†åŸŸå»ºæ¨¡**ï¼šåŒ…å«ç”Ÿäº§ (Production)ã€è´¨é‡ (Quality)ã€è´¢åŠ¡ (Finance)ã€EHS (Safety) ç­‰åˆ†é¢†åŸŸçš„ä¸šåŠ¡é€»è¾‘æ˜ å°„ã€‚

### 4. ç¼–æ’ä¸è¾“å‡º (Orchestration & Output)
*   **å¹¶è¡Œç¼–æ’**ï¼šä½¿ç”¨ `run_etl_parallel.py` å¹¶è¡Œæ‰§è¡Œå¤šä¸ª ETL ä»»åŠ¡ï¼Œæ˜¾è‘—ç¼©çŸ­è¿è¡Œæ—¶é—´ã€‚
*   **Power BI ä¾›æ•°**ï¼šå°†æœ€ç»ˆçš„æ¸…æ´—æ•°æ®ï¼ˆCurated Dataï¼‰å¯¼å‡ºä¸º **Parquet** æ ¼å¼ï¼ˆé«˜æ€§èƒ½ï¼‰æˆ– Excelï¼Œä¾› Power BI ç›´æ¥è¯»å–å±•ç¤ºã€‚
*   **è‡ªåŠ¨åŒ–è¿ç»´**ï¼šå…·å¤‡æ—¥å¿—è‡ªåŠ¨æ¸…ç†ã€é”™è¯¯é‡è¯•å’Œå¥åº·æ£€æŸ¥æœºåˆ¶ã€‚

---

## ğŸ“Š æ•°æ®æºè¯´æ˜

### MES (Manufacturing Execution System)
- **æ•°æ®ç±»å‹ï¼š** ç”Ÿäº§æ‰¹æ¬¡æŠ¥å‘Š
- **æ›´æ–°é¢‘ç‡ï¼š** æ¯æ—¥
- **ETLè„šæœ¬ï¼š** `data_pipelines/sources/mes/etl/`

### SFC (Shop Floor Control)
- **æ•°æ®ç±»å‹ï¼š** è´¨é‡æ£€éªŒã€å›¢é˜Ÿåˆæ ¼ç‡ã€æ‰¹æ¬¡æŠ¥å‘Š
- **æ›´æ–°é¢‘ç‡ï¼š** æ¯æ—¥
- **ETLè„šæœ¬ï¼š** `data_pipelines/sources/sfc/etl/`

### SAP (Systems, Applications, and Products)
- **æ•°æ®ç±»å‹ï¼š** è·¯ç”±ä¿¡æ¯ã€æ ‡å‡†æ—¶é—´
- **æ›´æ–°é¢‘ç‡ï¼š** æŒ‰éœ€
- **ETLè„šæœ¬ï¼š** `data_pipelines/sources/sap/etl/`

---

## ğŸ› ï¸ ä½¿ç”¨æŒ‡å—

### æ•°æ®åˆ·æ–°

**ä¸€é”®åˆ·æ–°æ ¸å¿ƒæ•°æ®ï¼š**
```bash
.\scripts\refresh_core_data.bat
```

**åˆ·æ–°å•ä¸ªæ•°æ®æºï¼š**
```bash
# MESæ‰¹é‡æŠ¥å‘Š
python data_pipelines\sources\mes\etl\etl_dataclean_mes_batch_report.py --mode incremental --unattended

# SFCå›¢é˜Ÿåˆæ ¼ç‡
python data_pipelines\sources\sfc\etl\etl_dataclean_sfc_team_passrate.py --mode incremental --unattended

# SAPè·¯ç”±æ•°æ®
python data_pipelines\sources\sap\etl\etl_dataclean_sap_routing.py --mode incremental --unattended
```

### æŸ¥çœ‹æ—¥å¿—

æ—¥å¿—æ–‡ä»¶ä½ç½®ï¼š`shared_infrastructure/logs/`

```bash
# æŸ¥çœ‹MESæ—¥å¿—
Get-Content shared_infrastructure\logs\etl_mes.log -Tail 50

# æŸ¥çœ‹SFCæ—¥å¿—
Get-Content shared_infrastructure\logs\etl_sfc.log -Tail 50
```

### éªŒè¯æ•°æ®

```bash
# è¿è¡ŒKPIèšåˆä¸æŠ¥è¡¨ç”Ÿæˆ
python data_pipelines\monitoring\etl\etl_kpi_aggregation.py
```

---

## ğŸ“š æ–‡æ¡£

### ç”¨æˆ·æ–‡æ¡£
- **æƒå¨æ–‡æ¡£ä¸­å¿ƒï¼š** [`docs/README.md`](docs/README.md)
- **æ–‡æ¡£æ²»ç†è§„åˆ™ï¼š** [`docs/DOCS_RULES.md`](docs/DOCS_RULES.md)
- **ç”µå­è¯´æ˜ä¹¦ï¼š** è¿è¡Œ `mkdocs serve` æŸ¥çœ‹å®Œæ•´æ–‡æ¡£
- **KPIå®šä¹‰ï¼š** `documentation/docs/kpi/`
- **ETLè¯´æ˜ï¼š** `documentation/docs/etl/`

### å¼€å‘æ–‡æ¡£
- **é¡¹ç›®ç»“æ„æŒ‡å—ï¼š** [`docs/05_reference/tools/é¡¹ç›®ç»“æ„æŒ‡å—.md`](docs/05_reference/tools/é¡¹ç›®ç»“æ„æŒ‡å—.md)
- **ETLè¿ç§»æ¨¡æ¿ï¼š** [`docs/05_reference/templates/ETLè¿ç§»æ¨¡æ¿.md`](docs/05_reference/templates/ETLè¿ç§»æ¨¡æ¿.md)
- **ETLè¿ç§»æ€»ç»“ï¼š** [`docs/04_reports_archive/phase_summary/é˜¶æ®µ2_ETLè¿ç§»æ€»ç»“.md`](docs/04_reports_archive/phase_summary/é˜¶æ®µ2_ETLè¿ç§»æ€»ç»“.md)
- **æ–‡ä»¶ç»„ç»‡æ€»ç»“ï¼š** [`docs/04_reports_archive/phase_summary/é˜¶æ®µ3_æ–‡ä»¶ç»„ç»‡æ€»ç»“.md`](docs/04_reports_archive/phase_summary/é˜¶æ®µ3_æ–‡ä»¶ç»„ç»‡æ€»ç»“.md)
- **è„šæœ¬ç»„ç»‡æ€»ç»“ï¼š** [`docs/04_reports_archive/phase_summary/é˜¶æ®µ3.5_è„šæœ¬ç»„ç»‡æ€»ç»“.md`](docs/04_reports_archive/phase_summary/é˜¶æ®µ3.5_è„šæœ¬ç»„ç»‡æ€»ç»“.md)
- **æœ€ç»ˆæ¸…ç†æ€»ç»“ï¼š** [`docs/04_reports_archive/phase_summary/é˜¶æ®µ4_æœ€ç»ˆæ¸…ç†æ€»ç»“.md`](docs/04_reports_archive/phase_summary/é˜¶æ®µ4_æœ€ç»ˆæ¸…ç†æ€»ç»“.md)

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒæŠ€æœ¯æ ˆ
- **Python 3.xï¼š** æ•°æ®å¤„ç†å’ŒETL
- **Pandasï¼š** æ•°æ®åˆ†æå’Œå¤„ç†
- **PyArrow/Parquetï¼š** é«˜æ•ˆæ•°æ®å­˜å‚¨
- **MkDocsï¼š** æ–‡æ¡£ç”Ÿæˆ
- **Power BIï¼š** æ•°æ®å¯è§†åŒ–

### æ¶æ„ç‰¹ç‚¹
- âœ… **æ¨¡å—åŒ–è®¾è®¡ï¼š** æŒ‰æ•°æ®æºå’ŒåŠŸèƒ½åˆ†ç¦»
- âœ… **å…±äº«åŸºç¡€è®¾æ–½ï¼š** ç»Ÿä¸€çš„å·¥å…·å‡½æ•°å’Œé…ç½®
- âœ… **æ ‡å‡†åŒ–è·¯å¾„ï¼š** é›†ä¸­åŒ–çš„è·¯å¾„ç®¡ç†
- âœ… **å¢é‡å¤„ç†ï¼š** é«˜æ•ˆçš„æ•°æ®æ›´æ–°æœºåˆ¶
- âœ… **çŠ¶æ€ç®¡ç†ï¼š** è‡ªåŠ¨è·Ÿè¸ªå¤„ç†è¿›åº¦

---

## ğŸ“‹ å¼€å‘æŒ‡å—

### ç¯å¢ƒè®¾ç½®

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone <repository_url>
   cd 250418_MDDAP_project
   ```

2. **åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ**
   ```bash
   python -m venv .venv
   .venv\Scripts\activate
   ```

3. **å®‰è£…ä¾èµ–**
   ```bash
   pip install -r documentation\requirements.txt
   ```

### æ·»åŠ æ–°çš„ETLè„šæœ¬

1. åœ¨ `data_pipelines/sources/{source}/etl/` åˆ›å»ºè„šæœ¬
2. ä½¿ç”¨å…±äº«å·¥å…·å‡½æ•°ï¼š
   ```python
   from shared_infrastructure.utils.etl_utils import (
       setup_logging,
       load_config,
       save_to_parquet
   )
   ```
3. åˆ›å»ºå¯¹åº”çš„é…ç½®æ–‡ä»¶
4. æ›´æ–°ä¸€é”®åˆ·æ–°è„šæœ¬

è¯¦ç»†è¯´æ˜ï¼šæŸ¥çœ‹ [`docs/05_reference/templates/ETLè¿ç§»æ¨¡æ¿.md`](docs/05_reference/templates/ETLè¿ç§»æ¨¡æ¿.md)

---

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

**Q: ETLè„šæœ¬è¿è¡Œå¤±è´¥ï¼Ÿ**
- æ£€æŸ¥æ—¥å¿—æ–‡ä»¶ï¼š`shared_infrastructure/logs/`
- éªŒè¯é…ç½®æ–‡ä»¶è·¯å¾„
- ç¡®è®¤æ•°æ®æºè¿æ¥æ­£å¸¸

**Q: æ‰¾ä¸åˆ°æ¨¡å—ï¼Ÿ**
- ç¡®è®¤è™šæ‹Ÿç¯å¢ƒå·²æ¿€æ´»
- æ£€æŸ¥ `sys.path` è®¾ç½®
- éªŒè¯é¡¹ç›®æ ¹ç›®å½•ä½ç½®

**Q: æ•°æ®æœªæ›´æ–°ï¼Ÿ**
- æ£€æŸ¥çŠ¶æ€æ–‡ä»¶ï¼š`data_pipelines/sources/{source}/state/`
- å°è¯•å…¨é‡åˆ·æ–°æ¨¡å¼
- æŸ¥çœ‹æ—¥å¿—äº†è§£è¯¦ç»†é”™è¯¯

---

## ğŸ“ˆ é¡¹ç›®å†å²

### Phase 1: åˆå§‹å¼€å‘
- åŸºç¡€ETLè„šæœ¬å¼€å‘
- æ•°æ®æºé›†æˆ

### Phase 2: ETLè¿ç§» (2025å¹´12æœˆ3æ—¥)
- âœ… 6ä¸ªETLè„šæœ¬è¿ç§»åˆ°æ ‡å‡†åŒ–æ¶æ„
- âœ… å…±äº«å·¥å…·å‡½æ•°æ•´åˆ
- âœ… é…ç½®æ–‡ä»¶æ ‡å‡†åŒ–

### Phase 2.5: æ–‡æ¡£è¿ç§» (2025å¹´12æœˆ3æ—¥)
- âœ… MkDocsæ–‡æ¡£ç³»ç»Ÿè¿ç§»
- âœ… æ–‡æ¡£ç»“æ„æ ‡å‡†åŒ–

### Phase 3: æ–‡ä»¶æ•´ç† (2025å¹´12æœˆ9æ—¥)
- âœ… çŠ¶æ€æ–‡ä»¶è¿ç§»
- âœ… è°ƒè¯•è„šæœ¬æ•´ç†
- âœ… æ—§ç›®å½•æ ‡è®°

### Phase 3.5: è„šæœ¬æ•´ç† (2025å¹´12æœˆ9æ—¥)
- âœ… å·¥å…·è„šæœ¬è¯„ä¼°å’Œè¿ç§»
- âœ… æµ‹è¯•éªŒè¯è„šæœ¬æ•´ç†
- âœ… æŠ€æœ¯æ–‡æ¡£å½’æ¡£

### Phase 4: æœ€ç»ˆæ¸…ç† (2025å¹´12æœˆ9æ—¥)
- âœ… å‰©ä½™ç›®å½•è¿ç§»
- âœ… æ— æ•ˆæ–‡ä»¶åˆ é™¤
- âœ… é¡¹ç›®ç»“æ„å®Œå…¨æ ‡å‡†åŒ–

---

## ğŸ‘¥ å›¢é˜Ÿ

**é¡¹ç›®è´Ÿè´£äººï¼š** Medtronic å¸¸å·å›­åŒºæ•°å­—åŒ–å›¢é˜Ÿ

**ç»´æŠ¤å›¢é˜Ÿï¼š**
- æ•°æ®å·¥ç¨‹
- è´¨é‡åˆ†æ
- ç”Ÿäº§åˆ†æ

---

## ğŸ“„ è®¸å¯è¯

å†…éƒ¨é¡¹ç›® - Medtronic å¸¸å·å›­åŒº

---

## ğŸ”— ç›¸å…³é“¾æ¥

- **MkDocsæ–‡æ¡£ï¼š** http://127.0.0.1:8000/ (æœ¬åœ°)
- **Power BIæŠ¥è¡¨ï¼š** [å†…éƒ¨é“¾æ¥]
- **SharePointæ•°æ®æºï¼š** [å†…éƒ¨é“¾æ¥]

---

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»æ•°å­—åŒ–å›¢é˜Ÿã€‚

---

*æœ€åæ›´æ–°ï¼š2025å¹´12æœˆ9æ—¥*  
*ç‰ˆæœ¬ï¼šPhase 4 (æ ‡å‡†åŒ–å®Œæˆ)*
