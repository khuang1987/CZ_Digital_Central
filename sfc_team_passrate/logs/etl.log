2025-12-01 16:46:41,882 - INFO - ============================================================
2025-12-01 16:46:41,884 - INFO - 开始处理SFC班组合格率数据
2025-12-01 16:46:41,884 - INFO - ============================================================
2025-12-01 16:46:41,884 - INFO - 读取班组合格率数据: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/70-SFC导出数据/班组合格率数据/*.xlsx
2025-12-01 16:46:41,895 - INFO - 找到 282 个班组合格率数据文件，按修改时间排序
2025-12-01 16:46:41,895 - INFO - 🧪 测试模式：仅读取前 120 个最新文件
2025-12-01 16:46:41,896 - INFO -   1. IGPR-20251128200001.xlsx (修改时间: 2025-12-01 08:19:20)
2025-12-01 16:46:41,898 - INFO -   2. IGPR-20251129080001.xlsx (修改时间: 2025-12-01 08:17:15)
2025-12-01 16:46:41,898 - INFO -   3. IGPR-20251130080001.xlsx (修改时间: 2025-12-01 08:16:12)
2025-12-01 16:46:41,898 - INFO -   4. IGPR-20251130200001.xlsx (修改时间: 2025-12-01 08:15:52)
2025-12-01 16:46:41,898 - INFO -   5. IGPR-20251201080001.xlsx (修改时间: 2025-12-01 08:15:17)
2025-12-01 16:46:41,899 - INFO - 读取文件: IGPR-20251128200001.xlsx
2025-12-01 16:46:46,090 - INFO - 读取文件: IGPR-20251129080001.xlsx
2025-12-01 16:46:48,514 - INFO - 读取文件: IGPR-20251130080001.xlsx
2025-12-01 16:46:49,143 - INFO - 读取文件: IGPR-20251130200001.xlsx
2025-12-01 16:46:50,024 - INFO - 读取文件: IGPR-20251201080001.xlsx
2025-12-01 16:46:50,630 - INFO - 读取文件: IGPR-20251128080001.xlsx
2025-12-01 16:46:52,611 - INFO - 读取文件: IGPR-20251127080001.xlsx
2025-12-01 16:46:55,066 - INFO - 读取文件: IGPR-20251126080001.xlsx
2025-12-01 16:46:57,730 - INFO - 读取文件: IGPR-20251125080001.xlsx
2025-12-01 16:47:00,364 - INFO - 读取文件: IGPR-20251122080001.xlsx
2025-12-01 16:47:02,709 - INFO - 读取文件: IGPR-20251123080001.xlsx
2025-12-01 16:47:04,226 - INFO - 读取文件: IGPR-20251124080001.xlsx
2025-12-01 16:47:05,770 - INFO - 读取文件: IGPR-20251121080001.xlsx
2025-12-01 16:47:11,130 - INFO - 读取文件: IGPR-20251120080001.xlsx
2025-12-01 16:47:17,879 - INFO - 读取文件: IGPR-20251119080001.xlsx
2025-12-01 16:47:23,414 - INFO - 读取文件: IGPR-20251118080001.xlsx
2025-12-01 16:47:30,500 - INFO - 读取文件: IGPR-20251114200001.xlsx
2025-12-01 16:47:38,949 - INFO - 读取文件: IGPR-20251115080001.xlsx
2025-12-01 16:47:44,884 - INFO - 读取文件: IGPR-20251116080001.xlsx
2025-12-01 16:47:48,205 - INFO - 读取文件: IGPR-20251117080001.xlsx
2025-12-01 16:47:51,447 - INFO - 读取文件: IGPR-20251113200001.xlsx
2025-12-01 16:48:00,240 - INFO - 读取文件: IGPR-20251112200001.xlsx
2025-12-01 16:48:04,087 - INFO - 读取文件: IGPR-20251111200001.xlsx
2025-12-01 16:48:13,249 - INFO - 读取文件: IGPR-20251110200001.xlsx
2025-12-01 16:48:20,150 - INFO - 读取文件: IGPR-20251107200001.xlsx
2025-12-01 16:48:28,120 - INFO - 读取文件: IGPR-20251108200001.xlsx
2025-12-01 16:48:37,222 - INFO - 读取文件: IGPR-20251109200001.xlsx
2025-12-01 16:48:42,828 - INFO - 读取文件: IGPR-20251106200001.xlsx
2025-12-01 16:48:52,466 - INFO - 读取文件: IGPR-20251105200001.xlsx
2025-12-01 16:49:02,669 - INFO - 读取文件: IGPR-20251104200001.xlsx
2025-12-01 16:49:11,128 - INFO - 读取文件: IGPR-20251103200001.xlsx
2025-12-01 16:49:17,144 - INFO - 读取文件: IGPR-20251031200001.xlsx
2025-12-01 16:49:27,536 - INFO - 读取文件: IGPR-20251101200001.xlsx
2025-12-01 16:49:34,663 - INFO - 读取文件: IGPR-20251102200001.xlsx
2025-12-01 16:49:39,236 - INFO - 读取文件: IGPR-20251031080001.xlsx
2025-12-01 16:49:45,024 - INFO - 读取文件: IGPR-20251029200001.xlsx
2025-12-01 16:49:53,969 - INFO - 读取文件: IGPR-20251028200001.xlsx
2025-12-01 17:34:26,566 - INFO - 读取文件: IGPR-20251027200001.xlsx
2025-12-01 17:34:34,388 - INFO - 读取文件: IGPR-20251024200001.xlsx
2025-12-01 17:34:46,946 - INFO - 读取文件: IGPR-20251025200001.xlsx
2025-12-01 17:34:55,444 - INFO - 读取文件: IGPR-20251026200001.xlsx
2025-12-01 17:35:00,736 - INFO - 读取文件: IGPR-20251023080001.xlsx
2025-12-01 17:35:07,252 - INFO - 读取文件: IGPR-20251023200001.xlsx
2025-12-01 17:35:16,876 - INFO - 读取文件: IGPR-20251021200001.xlsx
2025-12-01 17:35:19,868 - INFO - 读取文件: IGPR-20251020200001.xlsx
2025-12-01 17:35:22,278 - INFO - 读取文件: IGPR-20251018080001.xlsx
2025-12-01 17:35:25,713 - INFO - 读取文件: IGPR-20251019080001.xlsx
2025-12-01 17:35:27,306 - INFO - 读取文件: IGPR-20251020080001.xlsx
2025-12-01 17:35:29,029 - INFO - 读取文件: IGPR-20251017080001.xlsx
2025-12-01 17:35:32,550 - INFO - 读取文件: IGPR-20251016080001.xlsx
2025-12-01 17:35:35,406 - INFO - 读取文件: IGPR-20251014080001.xlsx
2025-12-01 17:35:41,128 - INFO - 读取文件: IGPR-20251015080001.xlsx
2025-12-01 17:35:44,098 - INFO - 读取文件: IGPR-20251009080001.xlsx
2025-12-01 17:35:45,729 - INFO - 读取文件: IGPR-20251001080001.xlsx
2025-12-01 17:35:48,736 - INFO - 读取文件: IGPR-20251007080001.xlsx
2025-12-01 17:35:48,775 - INFO - 读取文件: IGPR-20251008080001.xlsx
2025-12-01 17:35:49,245 - INFO - 读取文件: IGPR-20250930080001.xlsx
2025-12-01 17:35:52,767 - INFO - 读取文件: IGPR-20250929080001.xlsx
2025-12-01 17:35:56,304 - INFO - 读取文件: IGPR-20250927080001.xlsx
2025-12-01 17:36:00,144 - INFO - 读取文件: IGPR-20250928080001.xlsx
2025-12-01 17:36:02,289 - INFO - 读取文件: IGPR-20250926080001.xlsx
2025-12-01 17:36:05,660 - INFO - 读取文件: IGPR-20250925080001.xlsx
2025-12-01 17:36:08,524 - INFO - 读取文件: IGPR-20250924080001.xlsx
2025-12-01 17:36:11,637 - INFO - 读取文件: IGPR-20250923080001.xlsx
2025-12-01 17:36:14,530 - INFO - 读取文件: IGPR-20250920080001.xlsx
2025-12-01 17:36:17,718 - INFO - 读取文件: IGPR-20250921080001.xlsx
2025-12-01 17:36:18,609 - INFO - 读取文件: IGPR-20250922080001.xlsx
2025-12-01 17:36:18,835 - INFO - 读取文件: IGPR-20250919080001.xlsx
2025-12-01 17:36:22,299 - INFO - 读取文件: IGPR-20250918080001.xlsx
2025-12-01 17:36:25,550 - INFO - 读取文件: IGPR-20250917080001.xlsx
2025-12-01 17:36:29,245 - INFO - 读取文件: IGPR-20250916080001.xlsx
2025-12-01 17:36:32,024 - INFO - 读取文件: IGPR-20250913080001.xlsx
2025-12-01 17:36:35,146 - INFO - 读取文件: IGPR-20250914080001.xlsx
2025-12-01 17:36:35,391 - INFO - 读取文件: IGPR-20250915080001.xlsx
2025-12-01 17:36:35,792 - INFO - 读取文件: IGPR-20250912080001.xlsx
2025-12-01 17:36:39,005 - INFO - 读取文件: IGPR-20250911080001.xlsx
2025-12-01 17:36:42,370 - INFO - 读取文件: IGPR-20250910080001.xlsx
2025-12-01 17:36:46,096 - INFO - 读取文件: IGPR-20250908080001.xlsx
2025-12-01 17:36:46,424 - INFO - 读取文件: IGPR-20250909080001.xlsx
2025-12-01 17:36:49,554 - INFO - 读取文件: IGPR-20250906080001.xlsx
2025-12-01 17:36:54,788 - INFO - 读取文件: IGPR-20250905080001.xlsx
2025-12-01 17:36:59,156 - INFO - 读取文件: IGPR-20250904080001.xlsx
2025-12-01 17:37:03,990 - INFO - 读取文件: IGPR-20250903080001.xlsx
2025-12-01 17:37:10,121 - INFO - 读取文件: IGPR-20250902080001.xlsx
2025-12-01 17:37:15,778 - INFO - 读取文件: IGPR-20250829080001.xlsx
2025-12-01 17:37:21,121 - INFO - 读取文件: IGPR-20250830080001.xlsx
2025-12-01 17:37:25,092 - INFO - 读取文件: IGPR-20250831080001.xlsx
2025-12-01 17:37:25,597 - INFO - 读取文件: IGPR-20250901080001.xlsx
2025-12-01 17:37:25,952 - INFO - 读取文件: IGPR-20250827080001.xlsx
2025-12-01 17:37:31,045 - INFO - 读取文件: IGPR-20250828080001.xlsx
2025-12-01 17:37:35,988 - INFO - 读取文件: IGPR-20250826080001.xlsx
2025-12-01 17:37:41,745 - INFO - 读取文件: IGPR-20250823080001.xlsx
2025-12-01 17:37:47,842 - INFO - 读取文件: IGPR-20250824080001.xlsx
2025-12-01 17:37:48,434 - INFO - 读取文件: IGPR-20250825080001.xlsx
2025-12-01 17:37:48,998 - INFO - 读取文件: IGPR-20250822080001.xlsx
2025-12-01 17:37:55,971 - INFO - 读取文件: IGPR-20250821080001.xlsx
2025-12-01 17:38:00,573 - INFO - 读取文件: IGPR-20250820080001.xlsx
2025-12-01 17:38:04,561 - INFO - 读取文件: IGPR-20250819080001.xlsx
2025-12-01 17:38:08,242 - INFO - 读取文件: IGPR-20250815080001.xlsx
2025-12-01 17:38:12,667 - INFO - 读取文件: IGPR-20250816080001.xlsx
2025-12-01 17:38:17,209 - INFO - 读取文件: IGPR-20250817080001.xlsx
2025-12-01 17:38:17,568 - INFO - 读取文件: IGPR-20250818080001.xlsx
2025-12-01 17:38:17,956 - INFO - 读取文件: IGPR-20250814080001.xlsx
2025-12-01 17:38:22,013 - INFO - 读取文件: IGPR-20250813080001.xlsx
2025-12-01 17:38:26,357 - INFO - 读取文件: IGPR-20250812080001.xlsx
2025-12-01 17:38:30,369 - INFO - 读取文件: IGPR-20250810080001.xlsx
2025-12-01 17:38:30,778 - INFO - 读取文件: IGPR-20250811080001.xlsx
2025-12-01 17:38:31,173 - INFO - 读取文件: IGPR-20250809080001.xlsx
2025-12-01 17:38:36,030 - INFO - 读取文件: IGPR-20250808080001.xlsx
2025-12-01 17:38:40,552 - INFO - 读取文件: IGPR-20250807080001.xlsx
2025-12-01 17:38:44,958 - INFO - 读取文件: IGPR-20250806080001.xlsx
2025-12-01 17:38:49,081 - INFO - 读取文件: IGPR-20250805080001.xlsx
2025-12-01 17:38:54,056 - INFO - 读取文件: IGPR-20250802080001.xlsx
2025-12-01 17:38:59,069 - INFO - 读取文件: IGPR-20250804080001.xlsx
2025-12-01 17:38:59,693 - INFO - 读取文件: IGPR-20250801080001.xlsx
2025-12-01 17:39:08,098 - INFO - 读取文件: IGPR-20250731080001.xlsx
2025-12-01 17:39:11,562 - INFO - 读取文件: IGPR-20250730080001.xlsx
2025-12-01 17:39:18,855 - INFO - 读取文件: IGPR-20250725080001.xlsx
2025-12-01 17:39:26,009 - INFO - 读取文件: IGPR-20250726080001.xlsx
2025-12-01 19:37:23,201 - INFO - 读取文件: IGPR-20250727080001.xlsx
2025-12-01 20:50:11,774 - INFO - 合并后班组合格率数据行数: 1628547
2025-12-01 20:50:11,824 - INFO - 开始验证班组合格率数据完整性...
2025-12-01 20:50:12,357 - INFO - 班组合格率数据验证通过: 1628547 行记录
2025-12-01 20:50:12,359 - INFO - 开始清洗班组合格率数据...
2025-12-01 20:50:15,673 - INFO - 已用工序编号填充 22795 个缺失的机床设备
2025-12-01 20:50:16,061 - INFO - 已填充 48158 个缺失的产品序号
2025-12-01 20:50:17,182 - WARNING - 发现 48158 个异常检验结果
2025-12-01 20:50:18,762 - INFO - 业务键去重: 基于批次号+产品序号+工序编号+工序名称移除 301864 条重复记录
2025-12-01 20:50:20,526 - INFO - 总去重统计: 移除 301864 条重复记录
2025-12-01 20:50:20,526 - INFO - 班组合格率数据清洗完成: 1628547 → 1326683 行
2025-12-01 20:50:20,643 - INFO - 开始按业务维度分组聚合数据...
2025-12-01 20:50:20,647 - INFO - 检测到批次级统计数据，直接聚合...
2025-12-01 20:50:58,212 - INFO - 聚合完成: 1326683 → 51207 条记录
2025-12-01 20:50:58,220 - INFO - 平均合格率: 99.46%
2025-12-01 20:50:58,221 - INFO - 开始从SFC批次报工表获取工序加工时间...
2025-12-01 20:50:59,478 - INFO - 成功读取SFC批次报工表: 78334 条记录
2025-12-01 20:50:59,513 - INFO - SFC批次报工表去重后: 76127 条唯一记录
2025-12-01 20:50:59,555 - INFO - 已标准化批次号：移除IPQCK前缀
2025-12-01 20:50:59,595 - INFO - 已标准化工序编号：数字补零到4位（与SFC批次报工表保持一致）
2025-12-01 20:50:59,595 - INFO - 数据标准化效果:
2025-12-01 20:50:59,618 - INFO -   批次号标准化: ['SORTK25J5068', 'IPQCK25L4343', 'K25B5062', 'K25L6049', 'K25L6046'] -> ['SORTK25J5068', '25L4343', 'K25B5062', 'K25L6049', 'K25L6046']
2025-12-01 20:50:59,628 - INFO -   工序编号标准化: ['20   ', '10   ', '150  ', '160  ', '170  '] -> ['0020', '0010', '0150', '0160', '0170']
2025-12-01 20:50:59,629 - INFO - 班组合格率聚合数据调试信息:
2025-12-01 20:50:59,629 - INFO -   数据形状: (51207, 16)
2025-12-01 20:50:59,630 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-01 20:50:59,630 - INFO -   关键字段存在: 批次号_标准化=True, 工序编号_标准化=True
2025-12-01 20:50:59,630 - INFO -   关键字段样本: 批次号_标准化=SORTK25J5068, 工序编号_标准化=0020
2025-12-01 20:50:59,630 - INFO - SFC批次报工表调试信息:
2025-12-01 20:50:59,631 - INFO -   数据形状: (76127, 4)
2025-12-01 20:50:59,631 - INFO -   索引类型: <class 'pandas.core.indexes.base.Index'>
2025-12-01 20:50:59,631 - INFO -   关键字段样本: BatchNumber=K25J5020, Operation=0190
2025-12-01 20:50:59,632 - INFO - 开始执行合并操作（使用标准化字段）...
2025-12-01 20:50:59,700 - INFO - 合并操作成功完成
2025-12-01 20:50:59,742 - INFO - 已更新工序编号为4位标准化格式
2025-12-01 20:50:59,743 - INFO - 数据增强完成: 44464/51207 条记录匹配到加工时间 (86.8%)
2025-12-01 20:50:59,743 - INFO - 开始补充聚合数据的指标字段...
2025-12-01 20:50:59,773 - INFO - 聚合数据指标补充完成
2025-12-01 20:50:59,774 - INFO - 最终数据统计:
2025-12-01 20:50:59,774 - INFO -   总记录数: 51207
2025-12-01 20:50:59,777 - INFO -   班组数: 8
2025-12-01 20:50:59,781 - INFO -   批次数: 7825
2025-12-01 20:51:00,209 - INFO - 已保存Parquet文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet, 行数: 51207
2025-12-01 20:51:00,223 - INFO - 数据量较大(51207行)，Excel文件只保存前10000行
2025-12-01 20:51:04,128 - INFO - 已保存Excel验证文件: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx, 行数: 10000
2025-12-01 20:51:04,128 - INFO - 班组合格率数据已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\SFC_Team_PassRate_latest.parquet
2025-12-01 20:51:04,568 - INFO - 班组合格率Excel验证文件已保存: C:/Users/huangk14/OneDrive - Medtronic PLC/CZ Production - 文档/General/POWER BI 数据源 V2/30-MES导出数据/publish\excel\SFC_Team_PassRate_latest.xlsx
2025-12-01 20:51:04,568 - INFO - SFC班组合格率数据处理完成
