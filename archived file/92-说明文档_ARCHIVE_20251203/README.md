

# CZ Ops 数字化数据平台 - 电子说明书

## 📖 项目简介

这是 CZ Ops 数字化数据平台的电子说明书，提供：
- 数据字段定义
- 计算方法说明
- 数据来源介绍
- ETL 流程文档
- Power Query 代码说明
- 使用指南和常见问题
- **多工厂支持**：CZM工厂(1303) + CKH工厂(9997)数据整合
- **工序管理区域分类**：标准化的管理区域划分体系

## 🚀 快速开始

### 方法1：本地浏览（推荐）

1. **首次使用** - 安装依赖：
   ```bash
   # 双击运行
   安装依赖.bat
   ```

2. **启动本地服务器**：
   ```bash
   # 双击运行
   启动文档服务.bat
   ```

3. 浏览器自动打开 `http://127.0.0.1:8000/`

### 方法2：生成静态HTML（离线使用）

1. **生成 HTML 文件**：
   ```bash
   # 双击运行
   生成静态网站.bat
   ```

2. 打开 `site/index.html` 即可离线浏览

### 方法3：部署到服务器

```bash
# 生成静态网站
mkdocs build
页面地址：https://khuang1987.github.io/250418_MDDAP_project/
# 将 site 文件夹复制到 Web 服务器
```

## 📂 项目结构

```
92-说明文档/
├── mkdocs.yml              # MkDocs 配置文件
├── requirements.txt        # Python 依赖
├── README.md              # 本文件
├── docs/                  # 文档源文件
│   ├── index.md          # 首页
│   ├── sa/               # SA 指标文档
│   ├── kpi/              # KPI 指标文档
│   ├── etl/              # 数据处理文档
│   ├── pq/               # Power Query 文档
│   ├── guide/            # 使用指南
│   ├── project/          # 项目管理文档
│   ├── reference/        # 参考信息
│   └── stylesheets/      # 自定义样式
├── site/                  # 生成的静态网站（自动生成）
├── 安装依赖.bat           # 安装脚本
├── 启动文档服务.bat       # 本地预览脚本
└── 生成静态网站.bat       # 构建脚本
```

## 🎨 功能特性

- ✅ **搜索功能**：支持中英文搜索
- ✅ **响应式设计**：支持手机、平板、电脑浏览
- ✅ **代码高亮**：支持多种编程语言
- ✅ **亮/暗主题**：自由切换
- ✅ **导航目录**：自动生成页面目录
- ✅ **离线使用**：生成 HTML 后可完全离线
- ✅ **版本控制**：自动显示文档更新时间
- ✅ **多工厂数据整合**：CZM + CKH 工厂统一数据处理
- ✅ **Power BI 帮助文档**：可点击的 SA & LT 指标计算说明

## 📝 文档编写

文档使用 Markdown 格式编写，保存在 `docs/` 目录下。

### 编写步骤

1. 在 `docs/` 对应目录下创建或编辑 `.md` 文件
2. 启动本地服务器预览：`启动文档服务.bat`
3. 保存文件后自动刷新浏览器
4. 满意后生成最终版本：`生成静态网站.bat`

### Markdown 增强功能

支持以下增强语法：

#### 提示框
```markdown
!!! note "注意"
    这是一个提示框

!!! warning "警告"
    这是一个警告框

!!! tip "技巧"
    这是一个技巧提示
```

#### 代码块
```markdown
```python
def hello():
    print("Hello World")
\```
```

#### 数学公式
```markdown
行内公式：\( E = mc^2 \)

块级公式：
\[ 
SA = \frac{\text{按期批次数}}{\text{总批次数}} \times 100\%
\]
```

#### 表格
```markdown
| 字段名 | 说明 | 示例 |
|--------|------|------|
| BatchNumber | 批次号 | K24A2066 |
```

## 🔧 系统要求

- Python 3.8+
- Windows 操作系统（脚本为 .bat 格式）
- 现代浏览器（Chrome、Firefox、Edge 等）

## 📞 技术支持

如有问题，请联系：
- CZ Ops 数字化团队
- 项目负责人 黄凯

## 📄 许可证

内部使用文档 - Medtronic PLC

---

## 📋 最新更新 (2025-11-25)

### 🔧 系统优化
- **多工厂数据整合**：完成CZM工厂(1303) + CKH工厂(9997)数据统一处理
- **工序管理区域分类**：建立标准化的9个管理区域分类体系
- **代码结构优化**：核心ETL程序与测试验证脚本分离管理
- **数据完整性修复**：解决CKH工厂数据过滤问题，确保数据完整性

### 📊 新增功能
- **Power BI帮助文档**：创建可点击的SA & LT指标计算说明页面
- **SharePoint集成**：帮助文档部署到SharePoint，支持发布后访问
- **数据验证工具**：增强的CKH数据完整性检查脚本

### 🏭 管理区域标准化
```
加工中心 MCT: 18个工序
后处理 EOL: 70个工序
外协 OS: 21个工序
无区域 NA: 4个工序
无菌 STR: 3个工序
纵切 ST: 6个工序
线切割 WED: 1个工序
终检 FI: 2个工序
车削&磨削 TG: 41个工序
```

最后更新：2025-11-25

